// Copyright 2023 Ant Group Co., Ltd.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package translator

var translateWithCCLTestCases = []sPair{
	{`select if(ta.plain_float_0, -1.0, -ta.plain_float_0) as res from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_float_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="replicate:{in:[Left:{t_0,t_1,},Right:{t_2,},],out:[LeftOut:{t_3,t_4,},RightOut:{t_5,},],attr:[input_party_codes:[alice bob],],party:[alice,bob,]}"]
3 [label="make_share:{in:[In:{t_3,},],out:[Out:{t_6,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="make_share:{in:[In:{t_5,},],out:[Out:{t_7,},],attr:[],party:[alice,bob,carol,]}"]
5 [label="Equal:{in:[Left:{t_6,},Right:{t_7,},],out:[Out:{t_8,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_public:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="filter_cross_join:{in:[Filter:{t_9,},In:{t_3,t_4,},],out:[Out:{t_10,t_11,},],attr:[],party:[alice,]}"]
8 [label="filter_cross_join:{in:[Filter:{t_9,},In:{t_5,},],out:[Out:{t_12,},],attr:[],party:[bob,]}"]
9 [label="make_constant:{in:[],out:[Out:{t_13,},],attr:[scalar:-1,to_status:1,],party:[alice,bob,carol,]}"]
10 [label="make_constant:{in:[],out:[Out:{t_14,},],attr:[scalar:0,to_status:1,],party:[alice,bob,carol,]}"]
11 [label="broadcast:{in:[In:{t_14,},ShapeRefTensor:{t_11,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
12 [label="Minus:{in:[Left:{t_15,},Right:{t_11,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
13 [label="broadcast:{in:[In:{t_13,},ShapeRefTensor:{t_16,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
14 [label="If:{in:[Condition:{t_11,},ValueIfFalse:{t_16,},ValueIfTrue:{t_17,},],out:[Out:{t_18,},],attr:[],party:[alice,]}"]
15 [label="publish:{in:[In:{t_18,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 2 [label = "t_1:{plain_float_0:PRIVATE:FLOAT32}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_14:{constant_data:PUBLIC:INT64}"]
11 -> 12 [label = "t_15:{constant_data:PRIVATE:INT64}"]
12 -> 13 [label = "t_16:{Minus_out:PRIVATE:FLOAT64}"]
12 -> 14 [label = "t_16:{Minus_out:PRIVATE:FLOAT64}"]
13 -> 14 [label = "t_17:{constant_data:PRIVATE:FLOAT64}"]
14 -> 15 [label = "t_18:{constant_data:PRIVATE:FLOAT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
2 -> 7 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
2 -> 7 [label = "t_4:{plain_float_0:PRIVATE:FLOAT32}"]
2 -> 8 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{join_int_0:SECRET:INT64}"]
4 -> 5 [label = "t_7:{join_int_0:SECRET:INT64}"]
5 -> 6 [label = "t_8:{Equal_out:SECRET:BOOL}"]
6 -> 7 [label = "t_9:{Equal_out:PUBLIC:BOOL}"]
6 -> 8 [label = "t_9:{Equal_out:PUBLIC:BOOL}"]
7 -> 11 [label = "t_11:{plain_float_0:PRIVATE:FLOAT32}"]
7 -> 12 [label = "t_11:{plain_float_0:PRIVATE:FLOAT32}"]
7 -> 14 [label = "t_11:{plain_float_0:PRIVATE:FLOAT32}"]
9 -> 13 [label = "t_13:{constant_data:PUBLIC:FLOAT64}"]
}`, testConf{groupThreshold: 0, joinType: 1}},
	{`select alice.groupby_int_0, bob.groupby_int_0, max(bob.aggregate_int_1) as max FROM alice.tbl_0 as alice join bob.tbl_0 as bob on alice.join_int_0=bob.join_int_0 group by alice.groupby_int_0, bob.groupby_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.groupby_int_0,alice.join_int_0 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,t_4,},],attr:[sql:select bob.aggregate_int_1,bob.groupby_int_0,bob.join_int_0 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_4,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{t_6,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,t_8,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,t_4,},RowsIndexFilter:{t_6,},],out:[Out:{t_9,t_10,t_11,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_10,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_9,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_15,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_share:{in:[In:{t_11,},],out:[Out:{t_16,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="sort:{in:[In:{t_12,t_13,t_14,t_12,t_15,t_14,t_13,t_16,},Key:{t_12,t_13,t_14,},],out:[Out:{t_17,t_18,t_19,t_20,t_21,t_22,t_23,t_24,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
11 [label="group_mark:{in:[Key:{t_17,t_18,},],out:[Group:{t_25,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_public:{in:[In:{t_25,},],out:[Out:{t_26,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="max:{in:[Group:{t_26,},In:{t_22,},],out:[Out:{t_27,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="filter:{in:[Filter:{t_26,},In:{t_20,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="filter:{in:[Filter:{t_26,},In:{t_23,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_private:{in:[In:{t_28,},],out:[Out:{t_30,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
17 [label="make_private:{in:[In:{t_29,},],out:[Out:{t_32,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
18 [label="make_private:{in:[In:{t_27,},],out:[Out:{t_34,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
19 [label="publish:{in:[In:{t_30,t_32,t_34,},],out:[Out:{t_31,t_33,t_35,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{groupby_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{aggregate_int_1:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{groupby_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_17:{groupby_int_0:SECRET:INT64}"]
10 -> 11 [label = "t_18:{groupby_int_0:SECRET:INT64}"]
10 -> 13 [label = "t_22:{aggregate_int_1:SECRET:INT64}"]
10 -> 14 [label = "t_20:{groupby_int_0:SECRET:INT64}"]
10 -> 15 [label = "t_23:{groupby_int_0:SECRET:INT64}"]
11 -> 12 [label = "t_25:{group_mark:SECRET:BOOL}"]
12 -> 13 [label = "t_26:{group_mark:PUBLIC:BOOL}"]
12 -> 14 [label = "t_26:{group_mark:PUBLIC:BOOL}"]
12 -> 15 [label = "t_26:{group_mark:PUBLIC:BOOL}"]
13 -> 18 [label = "t_27:{aggregate_int_1:SECRET:INT64}"]
14 -> 16 [label = "t_28:{groupby_int_0:SECRET:INT64}"]
15 -> 17 [label = "t_29:{groupby_int_0:SECRET:INT64}"]
16 -> 19 [label = "t_30:{groupby_int_0:PRIVATE:INT64}"]
17 -> 19 [label = "t_32:{groupby_int_0:PRIVATE:INT64}"]
18 -> 19 [label = "t_34:{aggregate_int_1:PRIVATE:INT64}"]
2 -> 3 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_7:{groupby_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_8:{join_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_10:{groupby_int_0:PRIVATE:INT64}"]
4 -> 7 [label = "t_9:{aggregate_int_1:PRIVATE:INT64}"]
4 -> 9 [label = "t_11:{join_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_12:{groupby_int_0:SECRET:INT64}"]
5 -> 10 [label = "t_12:{groupby_int_0:SECRET:INT64}"]
5 -> 10 [label = "t_12:{groupby_int_0:SECRET:INT64}"]
6 -> 10 [label = "t_13:{groupby_int_0:SECRET:INT64}"]
6 -> 10 [label = "t_13:{groupby_int_0:SECRET:INT64}"]
6 -> 10 [label = "t_13:{groupby_int_0:SECRET:INT64}"]
7 -> 10 [label = "t_14:{aggregate_int_1:SECRET:INT64}"]
7 -> 10 [label = "t_14:{aggregate_int_1:SECRET:INT64}"]
7 -> 10 [label = "t_14:{aggregate_int_1:SECRET:INT64}"]
8 -> 10 [label = "t_15:{join_int_0:SECRET:INT64}"]
9 -> 10 [label = "t_16:{join_int_0:SECRET:INT64}"]
}`, testConf{groupThreshold: 1, aggType: 1}},
	{`(SELECT count(alice.groupby_int_1) as test1 FROM alice.tbl_0 as alice WHERE alice.groupby_int_0 >= 0 GROUP BY alice.groupby_int_1 HAVING test1 > 0  limit 3) union all (select count(bob.groupby_int_0) as test1 FROM bob.tbl_0 as bob WHERE bob.groupby_int_0 >= 0  limit 3);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select t_0.expr_183 from (select count(alice.groupby_int_1) as expr_183 from alice.tbl_0 as alice where alice.groupby_int_0>=0 group by alice.groupby_int_1 having (count(alice.groupby_int_1)>0) and (count(alice.groupby_int_1)>=4) limit 3) as t_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select t_0.expr_92 from (select count(bob.groupby_int_0) as expr_92 from bob.tbl_0 as bob where bob.groupby_int_0>=0 limit 3) as t_0,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_private:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
6 [label="publish:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#184:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#184:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{Column#184:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#184:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#184:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#184:PRIVATE:INT64}"]
}`, testConf{}},
	{`(SELECT count(*) as cnt FROM alice.tbl_0 as alice join bob.tbl_0 as bob on alice.plain_int_0=bob.plain_int_0);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.plain_int_0 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select bob.plain_int_0 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="copy:{in:[In:{t_1,},],out:[Out:{t_2,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
3 [label="plainjoin:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
5 [label="copy:{in:[In:{t_4,},],out:[Out:{t_6,},],attr:[input_party_codes:alice,output_party_codes:bob,],party:[alice,bob,]}"]
6 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_6,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
7 [label="shape:{in:[In:{t_5,},],out:[Out:{t_8,},],attr:[axis:0,],party:[alice,]}"]
8 [label="publish:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 4 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 6 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
4 -> 7 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
}`, testConf{joinType: 2}},
	{`(SELECT alice.groupby_int_1 is not null as c1, coalesce(alice.compare_float_0, alice.plain_float_1) as c2, ifnull(alice.join_string_0, "null") as c3 FROM alice.tbl_0 as alice join bob.tbl_0 as bob on alice.join_string_0=bob.join_string_0);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,t_3,},],attr:[sql:select alice.compare_float_0,alice.groupby_int_1,alice.join_string_0,alice.plain_float_1 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_4,},],attr:[sql:select bob.join_string_0 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_2,},Right:{t_4,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{t_6,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,t_8,t_9,t_10,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_4,},RowsIndexFilter:{t_6,},],out:[Out:{t_11,},],attr:[],party:[bob,]}"]
5 [label="is_null:{in:[In:{t_8,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
6 [label="not:{in:[In:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
7 [label="coalesce:{in:[Exprs:{t_7,t_10,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_15,},],attr:[scalar:null,to_status:1,],party:[alice,bob,carol,]}"]
9 [label="broadcast:{in:[In:{t_15,},ShapeRefTensor:{t_9,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
10 [label="ifnull:{in:[AltValue:{t_16,},Expr:{t_9,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
11 [label="publish:{in:[In:{t_13,t_14,t_17,},],out:[Out:{t_18,t_19,t_20,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_2:{join_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_0:{compare_float_0:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_1:{groupby_int_1:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{join_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_3:{plain_float_1:PRIVATE:FLOAT32}"]
1 -> 2 [label = "t_4:{join_string_0:PRIVATE:STRING}"]
1 -> 4 [label = "t_4:{join_string_0:PRIVATE:STRING}"]
10 -> 11 [label = "t_17:{ifnull_out:PRIVATE:STRING}"]
2 -> 3 [label = "t_5:{join_string_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{join_string_0:PRIVATE:INT64}"]
3 -> 10 [label = "t_9:{join_string_0:PRIVATE:STRING}"]
3 -> 5 [label = "t_8:{groupby_int_1:PRIVATE:INT64}"]
3 -> 7 [label = "t_10:{plain_float_1:PRIVATE:FLOAT32}"]
3 -> 7 [label = "t_7:{compare_float_0:PRIVATE:FLOAT32}"]
3 -> 9 [label = "t_9:{join_string_0:PRIVATE:STRING}"]
5 -> 6 [label = "t_12:{isnull_out:PRIVATE:BOOL}"]
6 -> 11 [label = "t_13:{isnull_out:PRIVATE:BOOL}"]
7 -> 11 [label = "t_14:{coalesce_out:PRIVATE:FLOAT64}"]
8 -> 9 [label = "t_15:{constant_data:PUBLIC:STRING}"]
9 -> 10 [label = "t_16:{constant_data:PRIVATE:STRING}"]
}`, testConf{}},
	{`(SELECT count(alice.groupby_int_1) as test1 FROM alice.tbl_0 as alice WHERE alice.groupby_int_0 >= 0 GROUP BY alice.groupby_int_1 HAVING test1 > 0  limit 3) union (select count(bob.groupby_int_0) as test1 FROM bob.tbl_0 as bob WHERE bob.groupby_int_0 >= 0  limit 3);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(t_0.expr_183) as expr_185 from (select count(alice.groupby_int_1) as expr_183 from alice.tbl_0 as alice where alice.groupby_int_0>=0 group by alice.groupby_int_1 having (count(alice.groupby_int_1)>0) and (count(alice.groupby_int_1)>=4) limit 3) as t_0 group by t_0.expr_183,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select any_value(t_0.expr_92) as expr_185 from (select count(bob.groupby_int_0) as expr_92 from bob.tbl_0 as bob where bob.groupby_int_0>=0 limit 3) as t_0 group by t_0.expr_92,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_private:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
6 [label="group:{in:[Key:{t_5,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
7 [label="firstrow:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_5,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#185:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#185:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{Column#185:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#185:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#185:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#185:PRIVATE:INT64}"]
5 -> 7 [label = "t_5:{Column#185:PRIVATE:INT64}"]
6 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{group_num:PRIVATE:INT64}"]
7 -> 8 [label = "t_8:{Column#185_firstrow:PRIVATE:INT64}"]
}`, testConf{}},
	{`select if(ta.plain_int_0, -1, -ta.plain_int_0) as res from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="make_constant:{in:[],out:[Out:{t_8,},],attr:[scalar:-1,to_status:1,],party:[alice,bob,carol,]}"]
6 [label="make_constant:{in:[],out:[Out:{t_9,},],attr:[scalar:0,to_status:1,],party:[alice,bob,carol,]}"]
7 [label="broadcast:{in:[In:{t_9,},ShapeRefTensor:{t_6,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
8 [label="Minus:{in:[Left:{t_10,},Right:{t_6,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
9 [label="broadcast:{in:[In:{t_8,},ShapeRefTensor:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
10 [label="If:{in:[Condition:{t_6,},ValueIfFalse:{t_11,},ValueIfTrue:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
11 [label="publish:{in:[In:{t_13,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_13:{constant_data:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
3 -> 10 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
5 -> 9 [label = "t_8:{constant_data:PUBLIC:INT64}"]
6 -> 7 [label = "t_9:{constant_data:PUBLIC:INT64}"]
7 -> 8 [label = "t_10:{constant_data:PRIVATE:INT64}"]
8 -> 10 [label = "t_11:{Minus_out:PRIVATE:INT64}"]
8 -> 9 [label = "t_11:{Minus_out:PRIVATE:INT64}"]
9 -> 10 [label = "t_12:{constant_data:PRIVATE:INT64}"]
}`, testConf{}},
	{`select count(tb.join_string_0) from  alice.tbl_0 as ta inner join bob.tbl_0 as tb on ta.join_string_0=tb.join_string_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.join_string_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.join_string_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[bob,]}"]
5 [label="reduce_count:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[],party:[bob,]}"]
6 [label="copy:{in:[In:{t_6,},],out:[Out:{t_7,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
7 [label="publish:{in:[In:{t_7,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_0:{join_string_0:PRIVATE:STRING}"]
1 -> 2 [label = "t_1:{join_string_0:PRIVATE:STRING}"]
1 -> 4 [label = "t_1:{join_string_0:PRIVATE:STRING}"]
2 -> 3 [label = "t_2:{join_string_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{join_string_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_5:{join_string_0:PRIVATE:STRING}"]
5 -> 6 [label = "t_6:{join_string_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{join_string_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select tt.compare_int_0 > 0 from (select compare_int_0 from alice.tbl_0 UNION select compare_int_0 from bob.tbl_0) as tt;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(tbl_0.compare_int_0) as expr_184 from alice.tbl_0 group by tbl_0.compare_int_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select any_value(tbl_0.compare_int_0) as expr_184 from bob.tbl_0 group by tbl_0.compare_int_0,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="sort:{in:[In:{t_4,t_4,},Key:{t_4,},],out:[Out:{t_5,t_6,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
6 [label="group_mark:{in:[Key:{t_5,},],out:[Group:{t_7,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="shuffle:{in:[In:{t_6,t_7,},],out:[Out:{t_8,t_9,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_public:{in:[In:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="filter:{in:[Filter:{t_10,},In:{t_8,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="make_constant:{in:[],out:[Out:{t_12,},],attr:[scalar:0,to_status:1,],party:[alice,bob,carol,]}"]
11 [label="broadcast:{in:[In:{t_12,},ShapeRefTensor:{t_11,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="Greater:{in:[Left:{t_11,},Right:{t_13,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_private:{in:[In:{t_14,},],out:[Out:{t_15,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
14 [label="publish:{in:[In:{t_15,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#184:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#184:PRIVATE:INT64}"]
10 -> 11 [label = "t_12:{constant_data:PUBLIC:INT64}"]
11 -> 12 [label = "t_13:{constant_data:PUBLIC:INT64}"]
12 -> 13 [label = "t_14:{Greater_out:SECRET:BOOL}"]
13 -> 14 [label = "t_15:{Greater_out:PRIVATE:BOOL}"]
2 -> 4 [label = "t_2:{Column#184:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#184:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#184:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#184:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#184:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#184:SECRET:INT64}"]
5 -> 7 [label = "t_6:{Column#184:SECRET:INT64}"]
6 -> 7 [label = "t_7:{group_mark:SECRET:BOOL}"]
7 -> 8 [label = "t_9:{group_mark:SECRET:BOOL}"]
7 -> 9 [label = "t_8:{Column#184:SECRET:INT64}"]
8 -> 9 [label = "t_10:{group_mark:PUBLIC:BOOL}"]
9 -> 11 [label = "t_11:{Column#184:SECRET:INT64}"]
9 -> 12 [label = "t_11:{Column#184:SECRET:INT64}"]
}`, testConf{}},
	{`select ta.join_int_0, tb.join_int_0 from (select distinct tbl_0.join_int_0, tbl_0.join_int_1 from alice.tbl_0) as ta join (select distinct tbl_0.join_int_0, tbl_0.join_int_1 from bob.tbl_0) as tb on ta.join_int_0 = tb.join_int_0 and ta.join_int_1 = tb.join_int_1;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select any_value(tbl_0.join_int_0) as expr_67,any_value(tbl_0.join_int_1) as expr_68 from alice.tbl_0 group by tbl_0.join_int_0,tbl_0.join_int_1,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select any_value(tbl_0.join_int_0) as expr_157,any_value(tbl_0.join_int_1) as expr_158 from bob.tbl_0 group by tbl_0.join_int_0,tbl_0.join_int_1,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,t_1,},Right:{t_2,t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_8,},],out:[Out:{t_11,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="publish:{in:[In:{t_6,t_11,},],out:[Out:{t_10,t_12,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 2 [label = "t_1:{join_int_1:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{join_int_1:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{join_int_1:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{join_int_1:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_8:{join_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_11:{join_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.groupby_int_0 from alice.tbl_0 as ta WHERE groupby_int_0>0 UNION (select tb.groupby_int_0 from bob.tbl_0 as tb GROUP BY tb.groupby_int_0);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(ta.groupby_int_0) as expr_183 from alice.tbl_0 as ta where ta.groupby_int_0>0 group by ta.groupby_int_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select any_value(t_0.expr_52) as expr_183 from (select any_value(tb.groupby_int_0) as expr_52 from bob.tbl_0 as tb group by tb.groupby_int_0) as t_0 group by t_0.expr_52,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_private:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
6 [label="group:{in:[Key:{t_5,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
7 [label="firstrow:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_5,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#183:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#183:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{Column#183:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#183:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#183:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#183:PRIVATE:INT64}"]
5 -> 7 [label = "t_5:{Column#183:PRIVATE:INT64}"]
6 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{group_num:PRIVATE:INT64}"]
7 -> 8 [label = "t_8:{Column#183_firstrow:PRIVATE:INT64}"]
}`, testConf{}},
	{`select count(distinct (if(ta.encrypt_int_0>1, tb.join_string_0, "aa"))) from  alice.tbl_0 as ta inner join bob.tbl_0 as tb on ta.join_string_0=tb.join_string_0 group by tb.groupby_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.encrypt_int_0,ta.join_string_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.groupby_int_0,tb.join_string_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_9,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="sort:{in:[In:{t_10,t_11,t_12,t_10,t_13,},Key:{t_10,},],out:[Out:{t_14,t_15,t_16,t_17,t_18,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
10 [label="group_mark:{in:[Key:{t_14,},],out:[Group:{t_19,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_constant:{in:[],out:[Out:{t_20,},],attr:[scalar:1,to_status:1,],party:[alice,bob,carol,]}"]
12 [label="broadcast:{in:[In:{t_20,},ShapeRefTensor:{t_15,},],out:[Out:{t_21,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_private:{in:[In:{t_15,},],out:[Out:{t_22,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
14 [label="make_private:{in:[In:{t_21,},],out:[Out:{t_23,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
15 [label="Greater:{in:[Left:{t_22,},Right:{t_23,},],out:[Out:{t_24,},],attr:[],party:[alice,]}"]
16 [label="make_constant:{in:[],out:[Out:{t_25,},],attr:[scalar:aa,to_status:1,],party:[alice,bob,carol,]}"]
17 [label="broadcast:{in:[In:{t_25,},ShapeRefTensor:{t_18,},],out:[Out:{t_26,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="make_private:{in:[In:{t_26,},],out:[Out:{t_28,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
19 [label="make_private:{in:[In:{t_18,},],out:[Out:{t_29,},],attr:[reveal_to:bob,],party:[alice,bob,carol,]}"]
20 [label="copy:{in:[In:{t_29,},],out:[Out:{t_30,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
21 [label="If:{in:[Condition:{t_24,},ValueIfFalse:{t_28,},ValueIfTrue:{t_30,},],out:[Out:{t_27,},],attr:[],party:[alice,]}"]
22 [label="make_share:{in:[In:{t_27,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
23 [label="sort:{in:[In:{t_31,},Key:{t_14,t_31,},],out:[Out:{t_32,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
24 [label="group_mark:{in:[Key:{t_32,},],out:[Group:{t_33,},],attr:[],party:[alice,bob,carol,]}"]
25 [label="LogicalOr:{in:[Left:{t_19,},Right:{t_33,},],out:[Out:{t_34,},],attr:[],party:[alice,bob,carol,]}"]
26 [label="sum:{in:[Group:{t_19,},In:{t_34,},],out:[Out:{t_35,},],attr:[],party:[alice,bob,carol,]}"]
27 [label="shuffle:{in:[In:{t_35,t_19,},],out:[Out:{t_36,t_37,},],attr:[],party:[alice,bob,carol,]}"]
28 [label="make_public:{in:[In:{t_37,},],out:[Out:{t_38,},],attr:[],party:[alice,bob,carol,]}"]
29 [label="filter:{in:[Filter:{t_38,},In:{t_36,},],out:[Out:{t_39,},],attr:[],party:[alice,bob,carol,]}"]
30 [label="make_private:{in:[In:{t_39,},],out:[Out:{t_40,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
31 [label="publish:{in:[In:{t_40,},],out:[Out:{t_41,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_0:{encrypt_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{join_string_0:PRIVATE:STRING}"]
1 -> 2 [label = "t_3:{join_string_0:PRIVATE:STRING}"]
1 -> 4 [label = "t_2:{groupby_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{join_string_0:PRIVATE:STRING}"]
10 -> 25 [label = "t_19:{group_mark:SECRET:BOOL}"]
10 -> 26 [label = "t_19:{group_mark:SECRET:BOOL}"]
10 -> 27 [label = "t_19:{group_mark:SECRET:BOOL}"]
11 -> 12 [label = "t_20:{constant_data:PUBLIC:INT64}"]
12 -> 14 [label = "t_21:{constant_data:PUBLIC:INT64}"]
13 -> 15 [label = "t_22:{encrypt_int_0:PRIVATE:INT64}"]
14 -> 15 [label = "t_23:{constant_data:PRIVATE:INT64}"]
15 -> 21 [label = "t_24:{Greater_out:PRIVATE:BOOL}"]
16 -> 17 [label = "t_25:{constant_data:PUBLIC:STRING}"]
17 -> 18 [label = "t_26:{constant_data:PUBLIC:STRING}"]
18 -> 21 [label = "t_28:{constant_data:PRIVATE:STRING}"]
19 -> 20 [label = "t_29:{join_string_0:PRIVATE:STRING}"]
2 -> 3 [label = "t_4:{join_string_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_string_0:PRIVATE:INT64}"]
20 -> 21 [label = "t_30:{join_string_0:PRIVATE:STRING}"]
21 -> 22 [label = "t_27:{join_string_0:PRIVATE:STRING}"]
22 -> 23 [label = "t_31:{join_string_0:SECRET:STRING}"]
22 -> 23 [label = "t_31:{join_string_0:SECRET:STRING}"]
23 -> 24 [label = "t_32:{join_string_0:SECRET:STRING}"]
24 -> 25 [label = "t_33:{group_mark:SECRET:BOOL}"]
25 -> 26 [label = "t_34:{LogicalOr_out:SECRET:BOOL}"]
26 -> 27 [label = "t_35:{LogicalOr_out:SECRET:INT64}"]
27 -> 28 [label = "t_37:{group_mark:SECRET:BOOL}"]
27 -> 29 [label = "t_36:{LogicalOr_out:SECRET:INT64}"]
28 -> 29 [label = "t_38:{group_mark:PUBLIC:BOOL}"]
29 -> 30 [label = "t_39:{LogicalOr_out:SECRET:INT64}"]
3 -> 6 [label = "t_6:{encrypt_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_7:{join_string_0:PRIVATE:STRING}"]
30 -> 31 [label = "t_40:{LogicalOr_out:PRIVATE:INT64}"]
4 -> 5 [label = "t_8:{groupby_int_0:PRIVATE:INT64}"]
4 -> 8 [label = "t_9:{join_string_0:PRIVATE:STRING}"]
5 -> 9 [label = "t_10:{groupby_int_0:SECRET:INT64}"]
5 -> 9 [label = "t_10:{groupby_int_0:SECRET:INT64}"]
5 -> 9 [label = "t_10:{groupby_int_0:SECRET:INT64}"]
6 -> 9 [label = "t_11:{encrypt_int_0:SECRET:INT64}"]
7 -> 9 [label = "t_12:{join_string_0:SECRET:STRING}"]
8 -> 9 [label = "t_13:{join_string_0:SECRET:STRING}"]
9 -> 10 [label = "t_14:{groupby_int_0:SECRET:INT64}"]
9 -> 12 [label = "t_15:{encrypt_int_0:SECRET:INT64}"]
9 -> 13 [label = "t_15:{encrypt_int_0:SECRET:INT64}"]
9 -> 17 [label = "t_18:{join_string_0:SECRET:STRING}"]
9 -> 19 [label = "t_18:{join_string_0:SECRET:STRING}"]
9 -> 23 [label = "t_14:{groupby_int_0:SECRET:INT64}"]
}`, testConf{}},
	{`select count(1) from (select aggregate_int_0 from alice.tbl_0 as ta union select aggregate_int_0 from bob.tbl_0) ua;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select any_value(1) as expr_185,any_value(ta.aggregate_int_0) as expr_182 from alice.tbl_0 as ta group by ta.aggregate_int_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select any_value(1) as expr_185,any_value(tbl_0.aggregate_int_0) as expr_182 from bob.tbl_0 group by tbl_0.aggregate_int_0,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_4,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_2,},],out:[Out:{t_5,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_4,t_5,},],out:[Out:{t_6,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_7,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_3,},],out:[Out:{t_8,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="concat:{in:[In:{t_7,t_8,},],out:[Out:{t_9,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
8 [label="sort:{in:[In:{t_9,t_6,t_9,},Key:{t_9,},],out:[Out:{t_10,t_11,t_12,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
9 [label="group_mark:{in:[Key:{t_10,},],out:[Group:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="shuffle:{in:[In:{t_11,t_13,},],out:[Out:{t_14,t_15,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_public:{in:[In:{t_15,},],out:[Out:{t_16,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="filter:{in:[Filter:{t_16,},In:{t_14,},],out:[Out:{t_17,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="shape:{in:[In:{t_17,},],out:[Out:{t_18,},],attr:[axis:0,],party:[alice,]}"]
14 [label="publish:{in:[In:{t_18,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#185:PRIVATE:BOOL}"]
0 -> 5 [label = "t_1:{Column#182:PRIVATE:INT64}"]
1 -> 3 [label = "t_2:{Column#185:PRIVATE:BOOL}"]
1 -> 6 [label = "t_3:{Column#182:PRIVATE:INT64}"]
10 -> 11 [label = "t_15:{group_mark:SECRET:BOOL}"]
10 -> 12 [label = "t_14:{Column#185:SECRET:BOOL}"]
11 -> 12 [label = "t_16:{group_mark:PUBLIC:BOOL}"]
12 -> 13 [label = "t_17:{Column#185:SECRET:BOOL}"]
13 -> 14 [label = "t_18:{Column#185:PRIVATE:INT64}"]
2 -> 4 [label = "t_4:{Column#185:SECRET:BOOL}"]
3 -> 4 [label = "t_5:{Column#185:SECRET:BOOL}"]
4 -> 8 [label = "t_6:{Column#185:SECRET:BOOL}"]
5 -> 7 [label = "t_7:{Column#182:SECRET:INT64}"]
6 -> 7 [label = "t_8:{Column#182:SECRET:INT64}"]
7 -> 8 [label = "t_9:{Column#182:SECRET:INT64}"]
7 -> 8 [label = "t_9:{Column#182:SECRET:INT64}"]
7 -> 8 [label = "t_9:{Column#182:SECRET:INT64}"]
8 -> 10 [label = "t_11:{Column#185:SECRET:BOOL}"]
8 -> 9 [label = "t_10:{Column#182:SECRET:INT64}"]
9 -> 10 [label = "t_13:{group_mark:SECRET:BOOL}"]
}`, testConf{}},
	{`select ta.plain_int_0, ta.compare_int_0 < tb.compare_int_0 from alice.tbl_1 as ta inner join bob.tbl_1 as tb on ta.join_int_0=tb.join_int_0 limit 1,11;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select ta.compare_int_0,ta.join_int_0,ta.plain_int_0 from alice.tbl_1 as ta,table_refs:[alice.tbl_1],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,t_4,},],attr:[sql:select tb.compare_int_0,tb.join_int_0 from bob.tbl_1 as tb,table_refs:[bob.tbl_1],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_4,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{t_6,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,t_8,t_9,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,t_4,},RowsIndexFilter:{t_6,},],out:[Out:{t_10,t_11,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_10,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="Less:{in:[Left:{t_12,},Right:{t_13,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="limit:{in:[In:{t_14,},],out:[Out:{t_15,},],attr:[count:11,offset:1,],party:[alice,bob,carol,]}"]
9 [label="limit:{in:[In:{t_9,},],out:[Out:{t_16,},],attr:[count:11,offset:1,],party:[alice,]}"]
10 [label="make_private:{in:[In:{t_15,},],out:[Out:{t_18,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
11 [label="publish:{in:[In:{t_16,t_18,},],out:[Out:{t_17,t_19,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_18:{Less_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_7:{compare_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_9:{plain_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_10:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_12:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_13:{compare_int_0:SECRET:INT64}"]
7 -> 8 [label = "t_14:{Less_out:SECRET:BOOL}"]
8 -> 10 [label = "t_15:{Less_out:SECRET:BOOL}"]
9 -> 11 [label = "t_16:{plain_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.plain_int_0,tb.plain_int_0, sum(tb.aggregate_int_0), count(tb.encrypt_string_1) from alice.tbl_1 as ta inner join bob.tbl_1 as tb on ta.join_int_0 = tb.join_int_0 group by ta.plain_int_0, tb.plain_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_1 as ta,table_refs:[alice.tbl_1],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,t_4,t_5,},],attr:[sql:select tb.aggregate_int_0,tb.encrypt_string_1,tb.join_int_0,tb.plain_int_0 from bob.tbl_1 as tb,table_refs:[bob.tbl_1],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_4,},],out:[LeftJoinIndex:{t_6,},RightJoinIndex:{t_7,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,t_9,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,t_4,t_5,},RowsIndexFilter:{t_7,},],out:[Out:{t_10,t_11,t_12,t_13,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_9,},],out:[Out:{t_14,},],attr:[input_party_codes:alice,output_party_codes:bob,],party:[alice,bob,]}"]
6 [label="group:{in:[Key:{t_14,t_13,},],out:[GroupId:{t_15,},GroupNum:{t_16,},],attr:[],party:[bob,]}"]
7 [label="sum:{in:[GroupId:{t_15,},GroupNum:{t_16,},In:{t_10,},],out:[Out:{t_17,},],attr:[],party:[bob,]}"]
8 [label="count:{in:[GroupId:{t_15,},GroupNum:{t_16,},In:{t_15,},],out:[Out:{t_18,},],attr:[],party:[bob,]}"]
9 [label="firstrow:{in:[GroupId:{t_15,},GroupNum:{t_16,},In:{t_14,},],out:[Out:{t_19,},],attr:[],party:[bob,]}"]
10 [label="firstrow:{in:[GroupId:{t_15,},GroupNum:{t_16,},In:{t_13,},],out:[Out:{t_20,},],attr:[],party:[bob,]}"]
11 [label="copy:{in:[In:{t_19,},],out:[Out:{t_21,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
12 [label="copy:{in:[In:{t_20,},],out:[Out:{t_23,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
13 [label="copy:{in:[In:{t_17,},],out:[Out:{t_25,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
14 [label="copy:{in:[In:{t_18,},],out:[Out:{t_27,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
15 [label="publish:{in:[In:{t_21,t_23,t_25,t_27,},],out:[Out:{t_22,t_24,t_26,t_28,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{aggregate_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{encrypt_string_1:PRIVATE:STRING}"]
1 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
10 -> 12 [label = "t_20:{plain_int_0_firstrow:PRIVATE:INT64}"]
11 -> 15 [label = "t_21:{plain_int_0_firstrow:PRIVATE:INT64}"]
12 -> 15 [label = "t_23:{plain_int_0_firstrow:PRIVATE:INT64}"]
13 -> 15 [label = "t_25:{aggregate_int_0_sum:PRIVATE:INT64}"]
14 -> 15 [label = "t_27:{group_id_count:PRIVATE:INT64}"]
2 -> 3 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_9:{plain_int_0:PRIVATE:INT64}"]
4 -> 10 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
4 -> 7 [label = "t_10:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_14:{plain_int_0:PRIVATE:INT64}"]
5 -> 9 [label = "t_14:{plain_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_15:{group_id:PRIVATE:INT64}"]
6 -> 10 [label = "t_16:{group_num:PRIVATE:INT64}"]
6 -> 7 [label = "t_15:{group_id:PRIVATE:INT64}"]
6 -> 7 [label = "t_16:{group_num:PRIVATE:INT64}"]
6 -> 8 [label = "t_15:{group_id:PRIVATE:INT64}"]
6 -> 8 [label = "t_15:{group_id:PRIVATE:INT64}"]
6 -> 8 [label = "t_16:{group_num:PRIVATE:INT64}"]
6 -> 9 [label = "t_15:{group_id:PRIVATE:INT64}"]
6 -> 9 [label = "t_16:{group_num:PRIVATE:INT64}"]
7 -> 13 [label = "t_17:{aggregate_int_0_sum:PRIVATE:INT64}"]
8 -> 14 [label = "t_18:{group_id_count:PRIVATE:INT64}"]
9 -> 11 [label = "t_19:{plain_int_0_firstrow:PRIVATE:INT64}"]
}`, testConf{groupThreshold: 1}},
	{`select plain_int_0 from alice.tbl_1 where plain_int_0 in (2, 5, 15) and plain_int_1 not in (2, 5, 15);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_1.plain_int_0 from alice.tbl_1 where (tbl_1.plain_int_0=2 or tbl_1.plain_int_0=5 or tbl_1.plain_int_0=15) and (not(tbl_1.plain_int_1=2 or tbl_1.plain_int_1=5 or tbl_1.plain_int_1=15)),table_refs:[alice.tbl_1],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select count(*), bob.gb_pl_en_int_0, carol.gb_en_pl_int_0, min(bob.ag_pl_en_int_0), max(carol.agg_en_pl_int_0) from alice.tbl_3 as alice join bob.tbl_3 as bob on alice.pl_jn_cp_int_0 = bob.jn_pl_cp_int_0 join carol.tbl_3 as carol on bob.cp_pl_jn_int_0 = carol.cp_jn_pl_int_0 group by bob.gb_pl_en_int_0, carol.gb_en_pl_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.pl_jn_cp_int_0 from alice.tbl_3 as alice,table_refs:[alice.tbl_3],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,t_2,t_3,t_4,},],attr:[sql:select bob.ag_pl_en_int_0,bob.cp_pl_jn_int_0,bob.gb_pl_en_int_0,bob.jn_pl_cp_int_0 from bob.tbl_3 as bob,table_refs:[bob.tbl_3],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_4,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{t_6,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,t_2,t_3,t_4,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,t_9,t_10,t_11,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_12,t_13,t_14,},],attr:[sql:select carol.agg_en_pl_int_0,carol.cp_jn_pl_int_0,carol.gb_en_pl_int_0 from carol.tbl_3 as carol,table_refs:[carol.tbl_3],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_9,},Right:{t_13,},],out:[LeftJoinIndex:{t_15,},RightJoinIndex:{t_16,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_15,},],out:[Out:{t_17,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_7,},RowsIndexFilter:{t_17,},],out:[Out:{t_18,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_8,t_9,t_10,t_11,},RowsIndexFilter:{t_15,},],out:[Out:{t_19,t_20,t_21,t_22,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_12,t_13,t_14,},RowsIndexFilter:{t_16,},],out:[Out:{t_23,t_24,t_25,},],attr:[],party:[carol,]}"]
11 [label="make_share:{in:[In:{t_21,},],out:[Out:{t_26,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_25,},],out:[Out:{t_27,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_share:{in:[In:{t_18,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_19,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="make_share:{in:[In:{t_20,},],out:[Out:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_share:{in:[In:{t_22,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="make_share:{in:[In:{t_23,},],out:[Out:{t_32,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="make_share:{in:[In:{t_24,},],out:[Out:{t_33,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="sort:{in:[In:{t_26,t_27,t_28,t_29,t_30,t_26,t_31,t_32,t_33,t_27,},Key:{t_26,t_27,},],out:[Out:{t_34,t_35,t_36,t_37,t_38,t_39,t_40,t_41,t_42,t_43,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
20 [label="group_mark:{in:[Key:{t_34,t_35,},],out:[Group:{t_44,},],attr:[],party:[alice,bob,carol,]}"]
21 [label="count:{in:[Group:{t_44,},In:{t_44,},],out:[Out:{t_45,},],attr:[],party:[alice,bob,carol,]}"]
22 [label="min:{in:[Group:{t_44,},In:{t_37,},],out:[Out:{t_46,},],attr:[],party:[alice,bob,carol,]}"]
23 [label="max:{in:[Group:{t_44,},In:{t_41,},],out:[Out:{t_47,},],attr:[],party:[alice,bob,carol,]}"]
24 [label="shuffle:{in:[In:{t_45,t_46,t_47,t_39,t_43,t_44,},],out:[Out:{t_48,t_49,t_50,t_51,t_52,t_53,},],attr:[],party:[alice,bob,carol,]}"]
25 [label="make_public:{in:[In:{t_53,},],out:[Out:{t_54,},],attr:[],party:[alice,bob,carol,]}"]
26 [label="filter:{in:[Filter:{t_54,},In:{t_48,t_49,t_50,t_51,t_52,},],out:[Out:{t_55,t_56,t_57,t_58,t_59,},],attr:[],party:[alice,bob,carol,]}"]
27 [label="make_constant:{in:[],out:[Out:{t_60,},],attr:[scalar:4,to_status:1,],party:[alice,bob,carol,]}"]
28 [label="broadcast:{in:[In:{t_60,},ShapeRefTensor:{t_55,},],out:[Out:{t_61,},],attr:[],party:[alice,bob,carol,]}"]
29 [label="make_private:{in:[In:{t_55,},],out:[Out:{t_62,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
30 [label="make_private:{in:[In:{t_61,},],out:[Out:{t_63,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
31 [label="GreaterEqual:{in:[Left:{t_62,},Right:{t_63,},],out:[Out:{t_64,},],attr:[],party:[alice,]}"]
32 [label="make_private:{in:[In:{t_58,},],out:[Out:{t_65,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
33 [label="make_private:{in:[In:{t_59,},],out:[Out:{t_66,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
34 [label="make_private:{in:[In:{t_56,},],out:[Out:{t_67,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
35 [label="make_private:{in:[In:{t_57,},],out:[Out:{t_68,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
36 [label="apply_filter:{in:[Filter:{t_64,},In:{t_65,t_66,t_62,t_67,t_68,},],out:[Out:{t_69,t_70,t_71,t_72,t_73,},],attr:[],party:[alice,]}"]
37 [label="publish:{in:[In:{t_71,t_69,t_70,t_72,t_73,},],out:[Out:{t_74,t_75,t_76,t_77,t_78,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{pl_jn_cp_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{pl_jn_cp_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{jn_pl_cp_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{ag_pl_en_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{cp_pl_jn_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{gb_pl_en_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{jn_pl_cp_int_0:PRIVATE:INT64}"]
10 -> 12 [label = "t_25:{gb_en_pl_int_0:PRIVATE:INT64}"]
10 -> 17 [label = "t_23:{agg_en_pl_int_0:PRIVATE:INT64}"]
10 -> 18 [label = "t_24:{cp_jn_pl_int_0:PRIVATE:INT64}"]
11 -> 19 [label = "t_26:{gb_pl_en_int_0:SECRET:INT64}"]
11 -> 19 [label = "t_26:{gb_pl_en_int_0:SECRET:INT64}"]
11 -> 19 [label = "t_26:{gb_pl_en_int_0:SECRET:INT64}"]
12 -> 19 [label = "t_27:{gb_en_pl_int_0:SECRET:INT64}"]
12 -> 19 [label = "t_27:{gb_en_pl_int_0:SECRET:INT64}"]
12 -> 19 [label = "t_27:{gb_en_pl_int_0:SECRET:INT64}"]
13 -> 19 [label = "t_28:{pl_jn_cp_int_0:SECRET:INT64}"]
14 -> 19 [label = "t_29:{ag_pl_en_int_0:SECRET:INT64}"]
15 -> 19 [label = "t_30:{cp_pl_jn_int_0:SECRET:INT64}"]
16 -> 19 [label = "t_31:{jn_pl_cp_int_0:SECRET:INT64}"]
17 -> 19 [label = "t_32:{agg_en_pl_int_0:SECRET:INT64}"]
18 -> 19 [label = "t_33:{cp_jn_pl_int_0:SECRET:INT64}"]
19 -> 20 [label = "t_34:{gb_pl_en_int_0:SECRET:INT64}"]
19 -> 20 [label = "t_35:{gb_en_pl_int_0:SECRET:INT64}"]
19 -> 22 [label = "t_37:{ag_pl_en_int_0:SECRET:INT64}"]
19 -> 23 [label = "t_41:{agg_en_pl_int_0:SECRET:INT64}"]
19 -> 24 [label = "t_39:{gb_pl_en_int_0:SECRET:INT64}"]
19 -> 24 [label = "t_43:{gb_en_pl_int_0:SECRET:INT64}"]
2 -> 3 [label = "t_5:{pl_jn_cp_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{jn_pl_cp_int_0:PRIVATE:INT64}"]
20 -> 21 [label = "t_44:{group_mark:SECRET:BOOL}"]
20 -> 21 [label = "t_44:{group_mark:SECRET:BOOL}"]
20 -> 22 [label = "t_44:{group_mark:SECRET:BOOL}"]
20 -> 23 [label = "t_44:{group_mark:SECRET:BOOL}"]
20 -> 24 [label = "t_44:{group_mark:SECRET:BOOL}"]
21 -> 24 [label = "t_45:{group_mark:SECRET:INT64}"]
22 -> 24 [label = "t_46:{ag_pl_en_int_0:SECRET:INT64}"]
23 -> 24 [label = "t_47:{agg_en_pl_int_0:SECRET:INT64}"]
24 -> 25 [label = "t_53:{group_mark:SECRET:BOOL}"]
24 -> 26 [label = "t_48:{group_mark:SECRET:INT64}"]
24 -> 26 [label = "t_49:{ag_pl_en_int_0:SECRET:INT64}"]
24 -> 26 [label = "t_50:{agg_en_pl_int_0:SECRET:INT64}"]
24 -> 26 [label = "t_51:{gb_pl_en_int_0:SECRET:INT64}"]
24 -> 26 [label = "t_52:{gb_en_pl_int_0:SECRET:INT64}"]
25 -> 26 [label = "t_54:{group_mark:PUBLIC:BOOL}"]
26 -> 28 [label = "t_55:{group_mark:SECRET:INT64}"]
26 -> 29 [label = "t_55:{group_mark:SECRET:INT64}"]
26 -> 32 [label = "t_58:{gb_pl_en_int_0:SECRET:INT64}"]
26 -> 33 [label = "t_59:{gb_en_pl_int_0:SECRET:INT64}"]
26 -> 34 [label = "t_56:{ag_pl_en_int_0:SECRET:INT64}"]
26 -> 35 [label = "t_57:{agg_en_pl_int_0:SECRET:INT64}"]
27 -> 28 [label = "t_60:{constant_data:PUBLIC:INT64}"]
28 -> 30 [label = "t_61:{constant_data:PUBLIC:INT64}"]
29 -> 31 [label = "t_62:{group_mark:PRIVATE:INT64}"]
29 -> 36 [label = "t_62:{group_mark:PRIVATE:INT64}"]
3 -> 8 [label = "t_7:{pl_jn_cp_int_0:PRIVATE:INT64}"]
30 -> 31 [label = "t_63:{constant_data:PRIVATE:INT64}"]
31 -> 36 [label = "t_64:{GreaterEqual_out:PRIVATE:BOOL}"]
32 -> 36 [label = "t_65:{gb_pl_en_int_0:PRIVATE:INT64}"]
33 -> 36 [label = "t_66:{gb_en_pl_int_0:PRIVATE:INT64}"]
34 -> 36 [label = "t_67:{ag_pl_en_int_0:PRIVATE:INT64}"]
35 -> 36 [label = "t_68:{agg_en_pl_int_0:PRIVATE:INT64}"]
36 -> 37 [label = "t_69:{gb_pl_en_int_0:PRIVATE:INT64}"]
36 -> 37 [label = "t_70:{gb_en_pl_int_0:PRIVATE:INT64}"]
36 -> 37 [label = "t_71:{group_mark:PRIVATE:INT64}"]
36 -> 37 [label = "t_72:{ag_pl_en_int_0:PRIVATE:INT64}"]
36 -> 37 [label = "t_73:{agg_en_pl_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_9:{cp_pl_jn_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_10:{gb_pl_en_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_11:{jn_pl_cp_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_8:{ag_pl_en_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_9:{cp_pl_jn_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_12:{agg_en_pl_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_13:{cp_jn_pl_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_14:{gb_en_pl_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_13:{cp_jn_pl_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_16:{cp_jn_pl_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_15:{cp_pl_jn_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_15:{cp_pl_jn_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_17:{cp_pl_jn_int_0:PRIVATE:INT64}"]
8 -> 13 [label = "t_18:{pl_jn_cp_int_0:PRIVATE:INT64}"]
9 -> 11 [label = "t_21:{gb_pl_en_int_0:PRIVATE:INT64}"]
9 -> 14 [label = "t_19:{ag_pl_en_int_0:PRIVATE:INT64}"]
9 -> 15 [label = "t_20:{cp_pl_jn_int_0:PRIVATE:INT64}"]
9 -> 16 [label = "t_22:{jn_pl_cp_int_0:PRIVATE:INT64}"]
}`, testConf{groupThreshold: 4}},
	{`select bob.cp_pl_jn_int_0 > carol.cp_jn_pl_int_0, bob.cp_pl_jn_int_1 > carol.cp_jn_pl_int_1 from alice.tbl_3 as alice join bob.tbl_3 as bob on alice.pl_jn_cp_int_0 = bob.jn_pl_cp_int_0 join carol.tbl_3 as carol on bob.cp_pl_jn_int_0 = carol.cp_jn_pl_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.pl_jn_cp_int_0 from alice.tbl_3 as alice,table_refs:[alice.tbl_3],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,t_2,t_3,},],attr:[sql:select bob.cp_pl_jn_int_0,bob.cp_pl_jn_int_1,bob.jn_pl_cp_int_0 from bob.tbl_3 as bob,table_refs:[bob.tbl_3],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_10,t_11,},],attr:[sql:select carol.cp_jn_pl_int_0,carol.cp_jn_pl_int_1 from carol.tbl_3 as carol,table_refs:[carol.tbl_3],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_7,},Right:{t_10,},],out:[LeftJoinIndex:{t_12,},RightJoinIndex:{t_13,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_12,},],out:[Out:{t_14,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_6,},RowsIndexFilter:{t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_7,t_8,t_9,},RowsIndexFilter:{t_12,},],out:[Out:{t_16,t_17,t_18,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_10,t_11,},RowsIndexFilter:{t_13,},],out:[Out:{t_19,t_20,},],attr:[],party:[carol,]}"]
11 [label="copy:{in:[In:{t_19,},],out:[Out:{t_21,},],attr:[input_party_codes:carol,output_party_codes:bob,],party:[carol,bob,]}"]
12 [label="Greater:{in:[Left:{t_16,},Right:{t_21,},],out:[Out:{t_22,},],attr:[],party:[bob,]}"]
13 [label="make_share:{in:[In:{t_17,},],out:[Out:{t_23,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_20,},],out:[Out:{t_24,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="Greater:{in:[Left:{t_23,},Right:{t_24,},],out:[Out:{t_25,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="copy:{in:[In:{t_22,},],out:[Out:{t_26,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
17 [label="make_private:{in:[In:{t_25,},],out:[Out:{t_28,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
18 [label="publish:{in:[In:{t_26,t_28,},],out:[Out:{t_27,t_29,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{pl_jn_cp_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{pl_jn_cp_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{jn_pl_cp_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{cp_pl_jn_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{cp_pl_jn_int_1:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{jn_pl_cp_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_19:{cp_jn_pl_int_0:PRIVATE:INT64}"]
10 -> 14 [label = "t_20:{cp_jn_pl_int_1:PRIVATE:INT64}"]
11 -> 12 [label = "t_21:{cp_jn_pl_int_0:PRIVATE:INT64}"]
12 -> 16 [label = "t_22:{Greater_out:PRIVATE:BOOL}"]
13 -> 15 [label = "t_23:{cp_pl_jn_int_1:SECRET:INT64}"]
14 -> 15 [label = "t_24:{cp_jn_pl_int_1:SECRET:INT64}"]
15 -> 17 [label = "t_25:{Greater_out:SECRET:BOOL}"]
16 -> 18 [label = "t_26:{Greater_out:PRIVATE:BOOL}"]
17 -> 18 [label = "t_28:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_4:{pl_jn_cp_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{jn_pl_cp_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_6:{pl_jn_cp_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{cp_pl_jn_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_7:{cp_pl_jn_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_8:{cp_pl_jn_int_1:PRIVATE:INT64}"]
4 -> 9 [label = "t_9:{jn_pl_cp_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_10:{cp_jn_pl_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_11:{cp_jn_pl_int_1:PRIVATE:INT64}"]
5 -> 6 [label = "t_10:{cp_jn_pl_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_13:{cp_jn_pl_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_12:{cp_pl_jn_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_12:{cp_pl_jn_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_14:{cp_pl_jn_int_0:PRIVATE:INT64}"]
9 -> 12 [label = "t_16:{cp_pl_jn_int_0:PRIVATE:INT64}"]
9 -> 13 [label = "t_17:{cp_pl_jn_int_1:PRIVATE:INT64}"]
}`, testConf{}},
	{`select bob.cp_pl_jn_int_0 > carol.cp_jn_pl_int_0 from alice.tbl_3 as alice join bob.tbl_3 as bob on alice.pl_jn_cp_int_0 = bob.jn_pl_cp_int_0 join carol.tbl_3 as carol on bob.cp_pl_jn_int_0 = carol.cp_jn_pl_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.pl_jn_cp_int_0 from alice.tbl_3 as alice,table_refs:[alice.tbl_3],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,t_2,},],attr:[sql:select bob.cp_pl_jn_int_0,bob.jn_pl_cp_int_0 from bob.tbl_3 as bob,table_refs:[bob.tbl_3],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_8,},],attr:[sql:select carol.cp_jn_pl_int_0 from carol.tbl_3 as carol,table_refs:[carol.tbl_3],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_6,},Right:{t_8,},],out:[LeftJoinIndex:{t_9,},RightJoinIndex:{t_10,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_9,},],out:[Out:{t_11,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_5,},RowsIndexFilter:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_6,t_7,},RowsIndexFilter:{t_9,},],out:[Out:{t_13,t_14,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_8,},RowsIndexFilter:{t_10,},],out:[Out:{t_15,},],attr:[],party:[carol,]}"]
11 [label="copy:{in:[In:{t_15,},],out:[Out:{t_16,},],attr:[input_party_codes:carol,output_party_codes:bob,],party:[carol,bob,]}"]
12 [label="Greater:{in:[Left:{t_13,},Right:{t_16,},],out:[Out:{t_17,},],attr:[],party:[bob,]}"]
13 [label="copy:{in:[In:{t_17,},],out:[Out:{t_18,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
14 [label="publish:{in:[In:{t_18,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{pl_jn_cp_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{pl_jn_cp_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{jn_pl_cp_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{cp_pl_jn_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{jn_pl_cp_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_15:{cp_jn_pl_int_0:PRIVATE:INT64}"]
11 -> 12 [label = "t_16:{cp_jn_pl_int_0:PRIVATE:INT64}"]
12 -> 13 [label = "t_17:{Greater_out:PRIVATE:BOOL}"]
13 -> 14 [label = "t_18:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_3:{pl_jn_cp_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_4:{jn_pl_cp_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_5:{pl_jn_cp_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_6:{cp_pl_jn_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_6:{cp_pl_jn_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_7:{jn_pl_cp_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_8:{cp_jn_pl_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_8:{cp_jn_pl_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_10:{cp_jn_pl_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_9:{cp_pl_jn_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_9:{cp_pl_jn_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_11:{cp_pl_jn_int_0:PRIVATE:INT64}"]
9 -> 12 [label = "t_13:{cp_pl_jn_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select if(ta.plain_int_0, tb.plain_int_0, ta.plain_int_0) as res,if(ta.compare_int_0 > tb.compare_int_0, ta.compare_int_0, tb.compare_int_0) > ta.compare_int_1 as res1, if(ta.plain_int_0, ta.compare_int_0, tb.compare_int_0) > ta.compare_int_1 as res1, if(ta.compare_int_0 > tb.compare_int_1, ta.plain_string_0, tb.plain_string_0) as res2 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,t_3,t_4,},],attr:[sql:select ta.compare_int_0,ta.compare_int_1,ta.join_int_0,ta.plain_int_0,ta.plain_string_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_5,t_6,t_7,t_8,t_9,},],attr:[sql:select tb.compare_int_0,tb.compare_int_1,tb.join_int_0,tb.plain_int_0,tb.plain_string_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_2,},Right:{t_7,},],out:[LeftJoinIndex:{t_10,},RightJoinIndex:{t_11,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,t_3,t_4,},RowsIndexFilter:{t_10,},],out:[Out:{t_12,t_13,t_14,t_15,t_16,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_5,t_6,t_7,t_8,t_9,},RowsIndexFilter:{t_11,},],out:[Out:{t_17,t_18,t_19,t_20,t_21,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_20,},],out:[Out:{t_23,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="If:{in:[Condition:{t_15,},ValueIfFalse:{t_15,},ValueIfTrue:{t_23,},],out:[Out:{t_22,},],attr:[],party:[alice,]}"]
7 [label="make_share:{in:[In:{t_12,},],out:[Out:{t_24,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_17,},],out:[Out:{t_25,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="Greater:{in:[Left:{t_24,},Right:{t_25,},],out:[Out:{t_26,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="If:{in:[Condition:{t_26,},ValueIfFalse:{t_25,},ValueIfTrue:{t_24,},],out:[Out:{t_27,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_share:{in:[In:{t_13,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="Greater:{in:[Left:{t_27,},Right:{t_28,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_share:{in:[In:{t_15,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="If:{in:[Condition:{t_31,},ValueIfFalse:{t_25,},ValueIfTrue:{t_24,},],out:[Out:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="Greater:{in:[Left:{t_30,},Right:{t_28,},],out:[Out:{t_32,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_share:{in:[In:{t_18,},],out:[Out:{t_33,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="Greater:{in:[Left:{t_24,},Right:{t_33,},],out:[Out:{t_34,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="make_private:{in:[In:{t_34,},],out:[Out:{t_36,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
19 [label="copy:{in:[In:{t_21,},],out:[Out:{t_37,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
20 [label="If:{in:[Condition:{t_36,},ValueIfFalse:{t_37,},ValueIfTrue:{t_16,},],out:[Out:{t_35,},],attr:[],party:[alice,]}"]
21 [label="make_private:{in:[In:{t_29,},],out:[Out:{t_39,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
22 [label="make_private:{in:[In:{t_32,},],out:[Out:{t_41,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
23 [label="publish:{in:[In:{t_22,t_39,t_41,t_35,},],out:[Out:{t_38,t_40,t_42,t_43,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{compare_int_1:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_4:{plain_string_0:PRIVATE:STRING}"]
1 -> 2 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_5:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_6:{compare_int_1:PRIVATE:INT64}"]
1 -> 4 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_9:{plain_string_0:PRIVATE:STRING}"]
10 -> 12 [label = "t_27:{compare_int_0:SECRET:INT64}"]
11 -> 12 [label = "t_28:{compare_int_1:SECRET:INT64}"]
11 -> 15 [label = "t_28:{compare_int_1:SECRET:INT64}"]
12 -> 21 [label = "t_29:{Greater_out:SECRET:BOOL}"]
13 -> 14 [label = "t_31:{plain_int_0:SECRET:INT64}"]
14 -> 15 [label = "t_30:{compare_int_0:SECRET:INT64}"]
15 -> 22 [label = "t_32:{Greater_out:SECRET:BOOL}"]
16 -> 17 [label = "t_33:{compare_int_1:SECRET:INT64}"]
17 -> 18 [label = "t_34:{Greater_out:SECRET:BOOL}"]
18 -> 20 [label = "t_36:{Greater_out:PRIVATE:BOOL}"]
19 -> 20 [label = "t_37:{plain_string_0:PRIVATE:STRING}"]
2 -> 3 [label = "t_10:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_11:{join_int_0:PRIVATE:INT64}"]
20 -> 23 [label = "t_35:{plain_string_0:PRIVATE:STRING}"]
21 -> 23 [label = "t_39:{Greater_out:PRIVATE:BOOL}"]
22 -> 23 [label = "t_41:{Greater_out:PRIVATE:BOOL}"]
3 -> 11 [label = "t_13:{compare_int_1:PRIVATE:INT64}"]
3 -> 13 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
3 -> 20 [label = "t_16:{plain_string_0:PRIVATE:STRING}"]
3 -> 6 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_12:{compare_int_0:PRIVATE:INT64}"]
4 -> 16 [label = "t_18:{compare_int_1:PRIVATE:INT64}"]
4 -> 19 [label = "t_21:{plain_string_0:PRIVATE:STRING}"]
4 -> 5 [label = "t_20:{plain_int_0:PRIVATE:INT64}"]
4 -> 8 [label = "t_17:{compare_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_23:{plain_int_0:PRIVATE:INT64}"]
6 -> 23 [label = "t_22:{plain_int_0:PRIVATE:INT64}"]
7 -> 10 [label = "t_24:{compare_int_0:SECRET:INT64}"]
7 -> 14 [label = "t_24:{compare_int_0:SECRET:INT64}"]
7 -> 17 [label = "t_24:{compare_int_0:SECRET:INT64}"]
7 -> 9 [label = "t_24:{compare_int_0:SECRET:INT64}"]
8 -> 10 [label = "t_25:{compare_int_0:SECRET:INT64}"]
8 -> 14 [label = "t_25:{compare_int_0:SECRET:INT64}"]
8 -> 9 [label = "t_25:{compare_int_0:SECRET:INT64}"]
9 -> 10 [label = "t_26:{Greater_out:SECRET:BOOL}"]
}`, testConf{}},
	{`select key1, key2, count(*) as c, count(distinct bob_encrypt) as cd, sum(bob_aggregate) as sb, max(carol_aggregate) as sc, min(carol_aggregate) as min_ca, avg(carol_aggregate) as avg_ca from (select bob.plain_int_0 as bob_encrypt, bob.plain_int_0 as bob_aggregate, carol.plain_int_0 as carol_aggregate, alice.plain_int_0 as alice_join, bob.plain_int_0 as bob_join, carol.plain_int_0 as carol_join, alice.plain_int_0 + bob.plain_int_0 as key1, carol.plain_int_0 + bob.plain_int_0 as key2 from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol) as tt where alice_join = bob_join and bob_join = carol_join group by key1, key2;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.plain_int_0 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select bob.plain_int_0 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_6,},],attr:[sql:select carol.plain_int_0 from carol.tbl_0 as carol,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_5,},Right:{t_6,},],out:[LeftJoinIndex:{t_7,},RightJoinIndex:{t_8,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_7,},],out:[Out:{t_9,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_4,},RowsIndexFilter:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_5,},RowsIndexFilter:{t_7,},],out:[Out:{t_11,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_6,},RowsIndexFilter:{t_8,},],out:[Out:{t_12,},],attr:[],party:[carol,]}"]
11 [label="copy:{in:[In:{t_11,},],out:[Out:{t_13,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
12 [label="Add:{in:[Left:{t_10,},Right:{t_13,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
13 [label="copy:{in:[In:{t_12,},],out:[Out:{t_15,},],attr:[input_party_codes:carol,output_party_codes:alice,],party:[carol,alice,]}"]
14 [label="Add:{in:[Left:{t_15,},Right:{t_13,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
15 [label="group:{in:[Key:{t_14,t_16,},],out:[GroupId:{t_17,},GroupNum:{t_18,},],attr:[],party:[alice,]}"]
16 [label="count:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_17,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
17 [label="count_distinct:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_13,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
18 [label="sum:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_13,},],out:[Out:{t_21,},],attr:[],party:[alice,]}"]
19 [label="max:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_15,},],out:[Out:{t_22,},],attr:[],party:[alice,]}"]
20 [label="min:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_15,},],out:[Out:{t_23,},],attr:[],party:[alice,]}"]
21 [label="avg:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_15,},],out:[Out:{t_24,},],attr:[],party:[alice,]}"]
22 [label="Add:{in:[Left:{t_10,},Right:{t_13,},],out:[Out:{t_25,},],attr:[],party:[alice,]}"]
23 [label="firstrow:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_25,},],out:[Out:{t_26,},],attr:[],party:[alice,]}"]
24 [label="Add:{in:[Left:{t_15,},Right:{t_13,},],out:[Out:{t_27,},],attr:[],party:[alice,]}"]
25 [label="firstrow:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_27,},],out:[Out:{t_28,},],attr:[],party:[alice,]}"]
26 [label="make_constant:{in:[],out:[Out:{t_29,},],attr:[scalar:4,to_status:1,],party:[alice,bob,carol,]}"]
27 [label="broadcast:{in:[In:{t_29,},ShapeRefTensor:{t_19,},],out:[Out:{t_30,},],attr:[],party:[alice,]}"]
28 [label="GreaterEqual:{in:[Left:{t_19,},Right:{t_30,},],out:[Out:{t_31,},],attr:[],party:[alice,]}"]
29 [label="apply_filter:{in:[Filter:{t_31,},In:{t_26,t_28,t_19,t_20,t_21,t_22,t_23,t_24,},],out:[Out:{t_32,t_33,t_34,t_35,t_36,t_37,t_38,t_39,},],attr:[],party:[alice,]}"]
30 [label="publish:{in:[In:{t_32,t_33,t_34,t_35,t_36,t_37,t_38,t_39,},],out:[Out:{t_40,t_41,t_42,t_43,t_44,t_45,t_46,t_47,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
10 -> 13 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
11 -> 12 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
11 -> 14 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
11 -> 17 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
11 -> 18 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
11 -> 22 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
11 -> 24 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
12 -> 15 [label = "t_14:{Add_out:PRIVATE:INT64}"]
13 -> 14 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
13 -> 19 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
13 -> 20 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
13 -> 21 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
13 -> 24 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
14 -> 15 [label = "t_16:{Add_out:PRIVATE:INT64}"]
15 -> 16 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 16 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 16 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 17 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 17 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 18 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 18 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 19 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 19 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 20 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 20 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 21 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 21 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 23 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 23 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 25 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 25 [label = "t_18:{group_num:PRIVATE:INT64}"]
16 -> 27 [label = "t_19:{group_id_count:PRIVATE:INT64}"]
16 -> 28 [label = "t_19:{group_id_count:PRIVATE:INT64}"]
16 -> 29 [label = "t_19:{group_id_count:PRIVATE:INT64}"]
17 -> 29 [label = "t_20:{plain_int_0_count_distinct:PRIVATE:INT64}"]
18 -> 29 [label = "t_21:{plain_int_0_sum:PRIVATE:INT64}"]
19 -> 29 [label = "t_22:{plain_int_0_max:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
20 -> 29 [label = "t_23:{plain_int_0_min:PRIVATE:INT64}"]
21 -> 29 [label = "t_24:{plain_int_0_avg:PRIVATE:FLOAT64}"]
22 -> 23 [label = "t_25:{Add_out:PRIVATE:INT64}"]
23 -> 29 [label = "t_26:{Add_out_firstrow:PRIVATE:INT64}"]
24 -> 25 [label = "t_27:{Add_out:PRIVATE:INT64}"]
25 -> 29 [label = "t_28:{Add_out_firstrow:PRIVATE:INT64}"]
26 -> 27 [label = "t_29:{constant_data:PUBLIC:INT64}"]
27 -> 28 [label = "t_30:{constant_data:PRIVATE:INT64}"]
28 -> 29 [label = "t_31:{GreaterEqual_out:PRIVATE:BOOL}"]
29 -> 30 [label = "t_32:{Add_out_firstrow:PRIVATE:INT64}"]
29 -> 30 [label = "t_33:{Add_out_firstrow:PRIVATE:INT64}"]
29 -> 30 [label = "t_34:{group_id_count:PRIVATE:INT64}"]
29 -> 30 [label = "t_35:{plain_int_0_count_distinct:PRIVATE:INT64}"]
29 -> 30 [label = "t_36:{plain_int_0_sum:PRIVATE:INT64}"]
29 -> 30 [label = "t_37:{plain_int_0_max:PRIVATE:INT64}"]
29 -> 30 [label = "t_38:{plain_int_0_min:PRIVATE:INT64}"]
29 -> 30 [label = "t_39:{plain_int_0_avg:PRIVATE:FLOAT64}"]
3 -> 8 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_9:{plain_int_0:PRIVATE:INT64}"]
8 -> 12 [label = "t_10:{plain_int_0:PRIVATE:INT64}"]
8 -> 22 [label = "t_10:{plain_int_0:PRIVATE:INT64}"]
9 -> 11 [label = "t_11:{plain_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select count(*) from (select ta.groupby_string_0 from alice.tbl_0 as ta union select tb.groupby_string_0 from bob.tbl_0 as tb union select tc.groupby_string_0 from carol.tbl_0 as tc) as uu`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select any_value(1) as expr_275,any_value(ta.groupby_string_0) as expr_272 from alice.tbl_0 as ta group by ta.groupby_string_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select any_value(1) as expr_275,any_value(tb.groupby_string_0) as expr_272 from bob.tbl_0 as tb group by tb.groupby_string_0,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="runsql:{in:[],out:[Out:{t_4,t_5,},],attr:[sql:select any_value(1) as expr_275,any_value(tc.groupby_string_0) as expr_272 from carol.tbl_0 as tc group by tc.groupby_string_0,table_refs:[carol.tbl_0],],party:[carol,]}"]
3 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_6,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="make_share:{in:[In:{t_2,},],out:[Out:{t_7,},],attr:[],party:[alice,bob,carol,]}"]
5 [label="make_share:{in:[In:{t_4,},],out:[Out:{t_8,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="concat:{in:[In:{t_6,t_7,t_8,},],out:[Out:{t_9,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_3,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_share:{in:[In:{t_5,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="concat:{in:[In:{t_10,t_11,t_12,},],out:[Out:{t_13,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
11 [label="make_public:{in:[In:{t_13,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_private:{in:[In:{t_14,},],out:[Out:{t_15,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
13 [label="group:{in:[Key:{t_15,},],out:[GroupId:{t_16,},GroupNum:{t_17,},],attr:[],party:[alice,]}"]
14 [label="make_private:{in:[In:{t_9,},],out:[Out:{t_18,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
15 [label="firstrow:{in:[GroupId:{t_16,},GroupNum:{t_17,},In:{t_18,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
16 [label="shape:{in:[In:{t_19,},],out:[Out:{t_20,},],attr:[axis:0,],party:[alice,]}"]
17 [label="publish:{in:[In:{t_20,},],out:[Out:{t_21,},],attr:[],party:[alice,]}"]
0 -> 3 [label = "t_0:{Column#275:PRIVATE:BOOL}"]
0 -> 7 [label = "t_1:{Column#272:PRIVATE:STRING}"]
1 -> 4 [label = "t_2:{Column#275:PRIVATE:BOOL}"]
1 -> 8 [label = "t_3:{Column#272:PRIVATE:STRING}"]
10 -> 11 [label = "t_13:{Column#272:SECRET:STRING}"]
11 -> 12 [label = "t_14:{Column#272:PUBLIC:STRING}"]
12 -> 13 [label = "t_15:{Column#272:PRIVATE:STRING}"]
13 -> 15 [label = "t_16:{group_id:PRIVATE:INT64}"]
13 -> 15 [label = "t_17:{group_num:PRIVATE:INT64}"]
14 -> 15 [label = "t_18:{Column#275:PRIVATE:BOOL}"]
15 -> 16 [label = "t_19:{Column#275_firstrow:PRIVATE:BOOL}"]
16 -> 17 [label = "t_20:{Column#275_firstrow:PRIVATE:INT64}"]
2 -> 5 [label = "t_4:{Column#275:PRIVATE:BOOL}"]
2 -> 9 [label = "t_5:{Column#272:PRIVATE:STRING}"]
3 -> 6 [label = "t_6:{Column#275:SECRET:BOOL}"]
4 -> 6 [label = "t_7:{Column#275:SECRET:BOOL}"]
5 -> 6 [label = "t_8:{Column#275:SECRET:BOOL}"]
6 -> 14 [label = "t_9:{Column#275:SECRET:BOOL}"]
7 -> 10 [label = "t_10:{Column#272:SECRET:STRING}"]
8 -> 10 [label = "t_11:{Column#272:SECRET:STRING}"]
9 -> 10 [label = "t_12:{Column#272:SECRET:STRING}"]
}`, testConf{}},
	{`select alice.encrypt_float_1 from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.plain_int_0 = bob.join_int_0 and bob.join_int_1 = carol.join_int_1;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.encrypt_float_1,alice.plain_int_0 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select bob.join_int_0,bob.join_int_1 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_10,},],attr:[sql:select carol.join_int_1 from carol.tbl_0 as carol,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_9,},Right:{t_10,},],out:[LeftJoinIndex:{t_11,},RightJoinIndex:{t_12,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_11,},],out:[Out:{t_13,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_6,t_7,},RowsIndexFilter:{t_13,},],out:[Out:{t_14,t_15,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_8,t_9,},RowsIndexFilter:{t_11,},],out:[Out:{t_16,t_17,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_10,},RowsIndexFilter:{t_12,},],out:[Out:{t_18,},],attr:[],party:[carol,]}"]
11 [label="publish:{in:[In:{t_14,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{encrypt_float_1:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{join_int_1:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_6:{encrypt_float_1:PRIVATE:FLOAT32}"]
3 -> 8 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_9:{join_int_1:PRIVATE:INT64}"]
4 -> 9 [label = "t_8:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_9:{join_int_1:PRIVATE:INT64}"]
5 -> 10 [label = "t_10:{join_int_1:PRIVATE:INT64}"]
5 -> 6 [label = "t_10:{join_int_1:PRIVATE:INT64}"]
6 -> 10 [label = "t_12:{join_int_1:PRIVATE:INT64}"]
6 -> 7 [label = "t_11:{join_int_1:PRIVATE:INT64}"]
6 -> 9 [label = "t_11:{join_int_1:PRIVATE:INT64}"]
7 -> 8 [label = "t_13:{join_int_1:PRIVATE:INT64}"]
8 -> 11 [label = "t_14:{encrypt_float_1:PRIVATE:FLOAT32}"]
}`, testConf{}},
	{`select count(*) as c, count(distinct bob.encrypt_int_0) as cd, sum(bob.aggregate_int_0) as sb, sum(carol.aggregate_int_0) as sc from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.join_int_0 = bob.join_int_0 and bob.join_int_0 = carol.join_int_0 group by alice.groupby_int_0 + bob.groupby_int_0, carol.groupby_int_0 + bob.groupby_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.groupby_int_0,alice.join_int_0 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,t_4,t_5,},],attr:[sql:select bob.aggregate_int_0,bob.encrypt_int_0,bob.groupby_int_0,bob.join_int_0 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_5,},],out:[LeftJoinIndex:{t_6,},RightJoinIndex:{t_7,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,t_9,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,t_4,t_5,},RowsIndexFilter:{t_7,},],out:[Out:{t_10,t_11,t_12,t_13,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_14,t_15,t_16,},],attr:[sql:select carol.aggregate_int_0,carol.groupby_int_0,carol.join_int_0 from carol.tbl_0 as carol,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_13,},Right:{t_16,},],out:[LeftJoinIndex:{t_17,},RightJoinIndex:{t_18,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_17,},],out:[Out:{t_19,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_8,t_9,},RowsIndexFilter:{t_19,},],out:[Out:{t_20,t_21,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_10,t_11,t_12,t_13,},RowsIndexFilter:{t_17,},],out:[Out:{t_22,t_23,t_24,t_25,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_14,t_15,t_16,},RowsIndexFilter:{t_18,},],out:[Out:{t_26,t_27,t_28,},],attr:[],party:[carol,]}"]
11 [label="make_share:{in:[In:{t_20,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_24,},],out:[Out:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="Add:{in:[Left:{t_29,},Right:{t_30,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_27,},],out:[Out:{t_32,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="Add:{in:[Left:{t_32,},Right:{t_30,},],out:[Out:{t_33,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_share:{in:[In:{t_21,},],out:[Out:{t_34,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="make_share:{in:[In:{t_22,},],out:[Out:{t_35,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="make_share:{in:[In:{t_23,},],out:[Out:{t_36,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="make_share:{in:[In:{t_25,},],out:[Out:{t_37,},],attr:[],party:[alice,bob,carol,]}"]
20 [label="make_share:{in:[In:{t_26,},],out:[Out:{t_38,},],attr:[],party:[alice,bob,carol,]}"]
21 [label="make_share:{in:[In:{t_28,},],out:[Out:{t_39,},],attr:[],party:[alice,bob,carol,]}"]
22 [label="sort:{in:[In:{t_31,t_33,t_29,t_34,t_35,t_36,t_30,t_37,t_38,t_32,t_39,},Key:{t_31,t_33,},],out:[Out:{t_40,t_41,t_42,t_43,t_44,t_45,t_46,t_47,t_48,t_49,t_50,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
23 [label="group_mark:{in:[Key:{t_40,t_41,},],out:[Group:{t_51,},],attr:[],party:[alice,bob,carol,]}"]
24 [label="count:{in:[Group:{t_51,},In:{t_51,},],out:[Out:{t_52,},],attr:[],party:[alice,bob,carol,]}"]
25 [label="sort:{in:[In:{t_45,},Key:{t_40,t_41,t_45,},],out:[Out:{t_53,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
26 [label="group_mark:{in:[Key:{t_53,},],out:[Group:{t_54,},],attr:[],party:[alice,bob,carol,]}"]
27 [label="LogicalOr:{in:[Left:{t_51,},Right:{t_54,},],out:[Out:{t_55,},],attr:[],party:[alice,bob,carol,]}"]
28 [label="sum:{in:[Group:{t_51,},In:{t_55,},],out:[Out:{t_56,},],attr:[],party:[alice,bob,carol,]}"]
29 [label="sum:{in:[Group:{t_51,},In:{t_44,},],out:[Out:{t_57,},],attr:[],party:[alice,bob,carol,]}"]
30 [label="sum:{in:[Group:{t_51,},In:{t_48,},],out:[Out:{t_58,},],attr:[],party:[alice,bob,carol,]}"]
31 [label="shuffle:{in:[In:{t_52,t_56,t_57,t_58,t_51,},],out:[Out:{t_59,t_60,t_61,t_62,t_63,},],attr:[],party:[alice,bob,carol,]}"]
32 [label="make_public:{in:[In:{t_63,},],out:[Out:{t_64,},],attr:[],party:[alice,bob,carol,]}"]
33 [label="filter:{in:[Filter:{t_64,},In:{t_59,t_60,t_61,t_62,},],out:[Out:{t_65,t_66,t_67,t_68,},],attr:[],party:[alice,bob,carol,]}"]
34 [label="make_constant:{in:[],out:[Out:{t_69,},],attr:[scalar:4,to_status:1,],party:[alice,bob,carol,]}"]
35 [label="broadcast:{in:[In:{t_69,},ShapeRefTensor:{t_65,},],out:[Out:{t_70,},],attr:[],party:[alice,bob,carol,]}"]
36 [label="make_private:{in:[In:{t_65,},],out:[Out:{t_71,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
37 [label="make_private:{in:[In:{t_70,},],out:[Out:{t_72,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
38 [label="GreaterEqual:{in:[Left:{t_71,},Right:{t_72,},],out:[Out:{t_73,},],attr:[],party:[alice,]}"]
39 [label="make_public:{in:[In:{t_73,},],out:[Out:{t_74,},],attr:[],party:[alice,bob,carol,]}"]
40 [label="apply_filter:{in:[Filter:{t_74,},In:{t_65,t_66,t_67,t_68,},],out:[Out:{t_75,t_76,t_77,t_78,},],attr:[],party:[alice,bob,carol,]}"]
41 [label="make_private:{in:[In:{t_75,},],out:[Out:{t_79,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
42 [label="make_private:{in:[In:{t_76,},],out:[Out:{t_81,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
43 [label="make_private:{in:[In:{t_77,},],out:[Out:{t_83,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
44 [label="make_private:{in:[In:{t_78,},],out:[Out:{t_85,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
45 [label="publish:{in:[In:{t_79,t_81,t_83,t_85,},],out:[Out:{t_80,t_82,t_84,t_86,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{groupby_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{aggregate_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{encrypt_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{groupby_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
10 -> 14 [label = "t_27:{groupby_int_0:PRIVATE:INT64}"]
10 -> 20 [label = "t_26:{aggregate_int_0:PRIVATE:INT64}"]
10 -> 21 [label = "t_28:{join_int_0:PRIVATE:INT64}"]
11 -> 13 [label = "t_29:{groupby_int_0:SECRET:INT64}"]
11 -> 22 [label = "t_29:{groupby_int_0:SECRET:INT64}"]
12 -> 13 [label = "t_30:{groupby_int_0:SECRET:INT64}"]
12 -> 15 [label = "t_30:{groupby_int_0:SECRET:INT64}"]
12 -> 22 [label = "t_30:{groupby_int_0:SECRET:INT64}"]
13 -> 22 [label = "t_31:{Add_out:SECRET:INT64}"]
13 -> 22 [label = "t_31:{Add_out:SECRET:INT64}"]
14 -> 15 [label = "t_32:{groupby_int_0:SECRET:INT64}"]
14 -> 22 [label = "t_32:{groupby_int_0:SECRET:INT64}"]
15 -> 22 [label = "t_33:{Add_out:SECRET:INT64}"]
15 -> 22 [label = "t_33:{Add_out:SECRET:INT64}"]
16 -> 22 [label = "t_34:{join_int_0:SECRET:INT64}"]
17 -> 22 [label = "t_35:{aggregate_int_0:SECRET:INT64}"]
18 -> 22 [label = "t_36:{encrypt_int_0:SECRET:INT64}"]
19 -> 22 [label = "t_37:{join_int_0:SECRET:INT64}"]
2 -> 3 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
20 -> 22 [label = "t_38:{aggregate_int_0:SECRET:INT64}"]
21 -> 22 [label = "t_39:{join_int_0:SECRET:INT64}"]
22 -> 23 [label = "t_40:{Add_out:SECRET:INT64}"]
22 -> 23 [label = "t_41:{Add_out:SECRET:INT64}"]
22 -> 25 [label = "t_40:{Add_out:SECRET:INT64}"]
22 -> 25 [label = "t_41:{Add_out:SECRET:INT64}"]
22 -> 25 [label = "t_45:{encrypt_int_0:SECRET:INT64}"]
22 -> 25 [label = "t_45:{encrypt_int_0:SECRET:INT64}"]
22 -> 29 [label = "t_44:{aggregate_int_0:SECRET:INT64}"]
22 -> 30 [label = "t_48:{aggregate_int_0:SECRET:INT64}"]
23 -> 24 [label = "t_51:{group_mark:SECRET:BOOL}"]
23 -> 24 [label = "t_51:{group_mark:SECRET:BOOL}"]
23 -> 27 [label = "t_51:{group_mark:SECRET:BOOL}"]
23 -> 28 [label = "t_51:{group_mark:SECRET:BOOL}"]
23 -> 29 [label = "t_51:{group_mark:SECRET:BOOL}"]
23 -> 30 [label = "t_51:{group_mark:SECRET:BOOL}"]
23 -> 31 [label = "t_51:{group_mark:SECRET:BOOL}"]
24 -> 31 [label = "t_52:{group_mark:SECRET:INT64}"]
25 -> 26 [label = "t_53:{encrypt_int_0:SECRET:INT64}"]
26 -> 27 [label = "t_54:{group_mark:SECRET:BOOL}"]
27 -> 28 [label = "t_55:{LogicalOr_out:SECRET:BOOL}"]
28 -> 31 [label = "t_56:{LogicalOr_out:SECRET:INT64}"]
29 -> 31 [label = "t_57:{aggregate_int_0:SECRET:INT64}"]
3 -> 8 [label = "t_8:{groupby_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_9:{join_int_0:PRIVATE:INT64}"]
30 -> 31 [label = "t_58:{aggregate_int_0:SECRET:INT64}"]
31 -> 32 [label = "t_63:{group_mark:SECRET:BOOL}"]
31 -> 33 [label = "t_59:{group_mark:SECRET:INT64}"]
31 -> 33 [label = "t_60:{LogicalOr_out:SECRET:INT64}"]
31 -> 33 [label = "t_61:{aggregate_int_0:SECRET:INT64}"]
31 -> 33 [label = "t_62:{aggregate_int_0:SECRET:INT64}"]
32 -> 33 [label = "t_64:{group_mark:PUBLIC:BOOL}"]
33 -> 35 [label = "t_65:{group_mark:SECRET:INT64}"]
33 -> 36 [label = "t_65:{group_mark:SECRET:INT64}"]
33 -> 40 [label = "t_65:{group_mark:SECRET:INT64}"]
33 -> 40 [label = "t_66:{LogicalOr_out:SECRET:INT64}"]
33 -> 40 [label = "t_67:{aggregate_int_0:SECRET:INT64}"]
33 -> 40 [label = "t_68:{aggregate_int_0:SECRET:INT64}"]
34 -> 35 [label = "t_69:{constant_data:PUBLIC:INT64}"]
35 -> 37 [label = "t_70:{constant_data:PUBLIC:INT64}"]
36 -> 38 [label = "t_71:{group_mark:PRIVATE:INT64}"]
37 -> 38 [label = "t_72:{constant_data:PRIVATE:INT64}"]
38 -> 39 [label = "t_73:{GreaterEqual_out:PRIVATE:BOOL}"]
39 -> 40 [label = "t_74:{GreaterEqual_out:PUBLIC:BOOL}"]
4 -> 6 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_10:{aggregate_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_11:{encrypt_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_12:{groupby_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
40 -> 41 [label = "t_75:{group_mark:SECRET:INT64}"]
40 -> 42 [label = "t_76:{LogicalOr_out:SECRET:INT64}"]
40 -> 43 [label = "t_77:{aggregate_int_0:SECRET:INT64}"]
40 -> 44 [label = "t_78:{aggregate_int_0:SECRET:INT64}"]
41 -> 45 [label = "t_79:{group_mark:PRIVATE:INT64}"]
42 -> 45 [label = "t_81:{LogicalOr_out:PRIVATE:INT64}"]
43 -> 45 [label = "t_83:{aggregate_int_0:PRIVATE:INT64}"]
44 -> 45 [label = "t_85:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_14:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_15:{groupby_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_18:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_17:{join_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_17:{join_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_19:{join_int_0:PRIVATE:INT64}"]
8 -> 11 [label = "t_20:{groupby_int_0:PRIVATE:INT64}"]
8 -> 16 [label = "t_21:{join_int_0:PRIVATE:INT64}"]
9 -> 12 [label = "t_24:{groupby_int_0:PRIVATE:INT64}"]
9 -> 17 [label = "t_22:{aggregate_int_0:PRIVATE:INT64}"]
9 -> 18 [label = "t_23:{encrypt_int_0:PRIVATE:INT64}"]
9 -> 19 [label = "t_25:{join_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select plain_string_0 in (select plain_int_0 from alice.tbl_1) as da from alice.tbl_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_string_0 in (select tbl_1.plain_int_0 from alice.tbl_1) as da from alice.tbl_0,table_refs:[alice.tbl_0 alice.tbl_1],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{Column#181:PRIVATE:BOOL}"]
}`, testConf{}},
	{`select plain_string_0 from alice.tbl_0 where plain_string_0 in (select plain_int_0 from alice.tbl_1)`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_string_0 from alice.tbl_0 where tbl_0.plain_string_0 in (select tbl_1.plain_int_0 from alice.tbl_1),table_refs:[alice.tbl_0 alice.tbl_1],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{plain_string_0:PRIVATE:STRING}"]
}`, testConf{}},
	{`select count(*) as c, count(distinct bob.encrypt_int_0) as cd, sum(bob.aggregate_int_0) as sb, sum(carol.aggregate_int_0) as sc from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.join_int_0 = bob.join_int_0 and bob.join_int_0 = carol.join_int_0 group by alice.groupby_int_0, bob.groupby_int_0, carol.groupby_int_0, carol.groupby_string_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.groupby_int_0,alice.join_int_0 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,t_4,t_5,},],attr:[sql:select bob.aggregate_int_0,bob.encrypt_int_0,bob.groupby_int_0,bob.join_int_0 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_5,},],out:[LeftJoinIndex:{t_6,},RightJoinIndex:{t_7,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,t_9,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,t_4,t_5,},RowsIndexFilter:{t_7,},],out:[Out:{t_10,t_11,t_12,t_13,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_14,t_15,t_16,t_17,},],attr:[sql:select carol.aggregate_int_0,carol.groupby_int_0,carol.groupby_string_0,carol.join_int_0 from carol.tbl_0 as carol,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_13,},Right:{t_17,},],out:[LeftJoinIndex:{t_18,},RightJoinIndex:{t_19,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_18,},],out:[Out:{t_20,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_8,t_9,},RowsIndexFilter:{t_20,},],out:[Out:{t_21,t_22,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_10,t_11,t_12,t_13,},RowsIndexFilter:{t_18,},],out:[Out:{t_23,t_24,t_25,t_26,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_14,t_15,t_16,t_17,},RowsIndexFilter:{t_19,},],out:[Out:{t_27,t_28,t_29,t_30,},],attr:[],party:[carol,]}"]
11 [label="make_share:{in:[In:{t_21,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_25,},],out:[Out:{t_32,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_share:{in:[In:{t_28,},],out:[Out:{t_33,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_29,},],out:[Out:{t_34,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="make_share:{in:[In:{t_22,},],out:[Out:{t_35,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_share:{in:[In:{t_23,},],out:[Out:{t_36,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="make_share:{in:[In:{t_24,},],out:[Out:{t_37,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="make_share:{in:[In:{t_26,},],out:[Out:{t_38,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="make_share:{in:[In:{t_27,},],out:[Out:{t_39,},],attr:[],party:[alice,bob,carol,]}"]
20 [label="make_share:{in:[In:{t_30,},],out:[Out:{t_40,},],attr:[],party:[alice,bob,carol,]}"]
21 [label="sort:{in:[In:{t_31,t_32,t_33,t_34,t_31,t_35,t_36,t_37,t_32,t_38,t_39,t_33,t_34,t_40,},Key:{t_31,t_32,t_33,t_34,},],out:[Out:{t_41,t_42,t_43,t_44,t_45,t_46,t_47,t_48,t_49,t_50,t_51,t_52,t_53,t_54,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
22 [label="group_mark:{in:[Key:{t_41,t_42,t_43,t_44,},],out:[Group:{t_55,},],attr:[],party:[alice,bob,carol,]}"]
23 [label="count:{in:[Group:{t_55,},In:{t_55,},],out:[Out:{t_56,},],attr:[],party:[alice,bob,carol,]}"]
24 [label="sort:{in:[In:{t_48,},Key:{t_41,t_42,t_43,t_44,t_48,},],out:[Out:{t_57,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
25 [label="group_mark:{in:[Key:{t_57,},],out:[Group:{t_58,},],attr:[],party:[alice,bob,carol,]}"]
26 [label="LogicalOr:{in:[Left:{t_55,},Right:{t_58,},],out:[Out:{t_59,},],attr:[],party:[alice,bob,carol,]}"]
27 [label="sum:{in:[Group:{t_55,},In:{t_59,},],out:[Out:{t_60,},],attr:[],party:[alice,bob,carol,]}"]
28 [label="sum:{in:[Group:{t_55,},In:{t_47,},],out:[Out:{t_61,},],attr:[],party:[alice,bob,carol,]}"]
29 [label="sum:{in:[Group:{t_55,},In:{t_51,},],out:[Out:{t_62,},],attr:[],party:[alice,bob,carol,]}"]
30 [label="shuffle:{in:[In:{t_56,t_60,t_61,t_62,t_55,},],out:[Out:{t_63,t_64,t_65,t_66,t_67,},],attr:[],party:[alice,bob,carol,]}"]
31 [label="make_public:{in:[In:{t_67,},],out:[Out:{t_68,},],attr:[],party:[alice,bob,carol,]}"]
32 [label="filter:{in:[Filter:{t_68,},In:{t_63,t_64,t_65,t_66,},],out:[Out:{t_69,t_70,t_71,t_72,},],attr:[],party:[alice,bob,carol,]}"]
33 [label="make_constant:{in:[],out:[Out:{t_73,},],attr:[scalar:4,to_status:1,],party:[alice,bob,carol,]}"]
34 [label="broadcast:{in:[In:{t_73,},ShapeRefTensor:{t_69,},],out:[Out:{t_74,},],attr:[],party:[alice,bob,carol,]}"]
35 [label="make_private:{in:[In:{t_69,},],out:[Out:{t_75,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
36 [label="make_private:{in:[In:{t_74,},],out:[Out:{t_76,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
37 [label="GreaterEqual:{in:[Left:{t_75,},Right:{t_76,},],out:[Out:{t_77,},],attr:[],party:[alice,]}"]
38 [label="make_public:{in:[In:{t_77,},],out:[Out:{t_78,},],attr:[],party:[alice,bob,carol,]}"]
39 [label="apply_filter:{in:[Filter:{t_78,},In:{t_69,t_70,t_71,t_72,},],out:[Out:{t_79,t_80,t_81,t_82,},],attr:[],party:[alice,bob,carol,]}"]
40 [label="make_private:{in:[In:{t_79,},],out:[Out:{t_83,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
41 [label="make_private:{in:[In:{t_80,},],out:[Out:{t_85,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
42 [label="make_private:{in:[In:{t_81,},],out:[Out:{t_87,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
43 [label="make_private:{in:[In:{t_82,},],out:[Out:{t_89,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
44 [label="publish:{in:[In:{t_83,t_85,t_87,t_89,},],out:[Out:{t_84,t_86,t_88,t_90,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{groupby_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{aggregate_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{encrypt_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{groupby_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
10 -> 13 [label = "t_28:{groupby_int_0:PRIVATE:INT64}"]
10 -> 14 [label = "t_29:{groupby_string_0:PRIVATE:STRING}"]
10 -> 19 [label = "t_27:{aggregate_int_0:PRIVATE:INT64}"]
10 -> 20 [label = "t_30:{join_int_0:PRIVATE:INT64}"]
11 -> 21 [label = "t_31:{groupby_int_0:SECRET:INT64}"]
11 -> 21 [label = "t_31:{groupby_int_0:SECRET:INT64}"]
11 -> 21 [label = "t_31:{groupby_int_0:SECRET:INT64}"]
12 -> 21 [label = "t_32:{groupby_int_0:SECRET:INT64}"]
12 -> 21 [label = "t_32:{groupby_int_0:SECRET:INT64}"]
12 -> 21 [label = "t_32:{groupby_int_0:SECRET:INT64}"]
13 -> 21 [label = "t_33:{groupby_int_0:SECRET:INT64}"]
13 -> 21 [label = "t_33:{groupby_int_0:SECRET:INT64}"]
13 -> 21 [label = "t_33:{groupby_int_0:SECRET:INT64}"]
14 -> 21 [label = "t_34:{groupby_string_0:SECRET:STRING}"]
14 -> 21 [label = "t_34:{groupby_string_0:SECRET:STRING}"]
14 -> 21 [label = "t_34:{groupby_string_0:SECRET:STRING}"]
15 -> 21 [label = "t_35:{join_int_0:SECRET:INT64}"]
16 -> 21 [label = "t_36:{aggregate_int_0:SECRET:INT64}"]
17 -> 21 [label = "t_37:{encrypt_int_0:SECRET:INT64}"]
18 -> 21 [label = "t_38:{join_int_0:SECRET:INT64}"]
19 -> 21 [label = "t_39:{aggregate_int_0:SECRET:INT64}"]
2 -> 3 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
20 -> 21 [label = "t_40:{join_int_0:SECRET:INT64}"]
21 -> 22 [label = "t_41:{groupby_int_0:SECRET:INT64}"]
21 -> 22 [label = "t_42:{groupby_int_0:SECRET:INT64}"]
21 -> 22 [label = "t_43:{groupby_int_0:SECRET:INT64}"]
21 -> 22 [label = "t_44:{groupby_string_0:SECRET:STRING}"]
21 -> 24 [label = "t_41:{groupby_int_0:SECRET:INT64}"]
21 -> 24 [label = "t_42:{groupby_int_0:SECRET:INT64}"]
21 -> 24 [label = "t_43:{groupby_int_0:SECRET:INT64}"]
21 -> 24 [label = "t_44:{groupby_string_0:SECRET:STRING}"]
21 -> 24 [label = "t_48:{encrypt_int_0:SECRET:INT64}"]
21 -> 24 [label = "t_48:{encrypt_int_0:SECRET:INT64}"]
21 -> 28 [label = "t_47:{aggregate_int_0:SECRET:INT64}"]
21 -> 29 [label = "t_51:{aggregate_int_0:SECRET:INT64}"]
22 -> 23 [label = "t_55:{group_mark:SECRET:BOOL}"]
22 -> 23 [label = "t_55:{group_mark:SECRET:BOOL}"]
22 -> 26 [label = "t_55:{group_mark:SECRET:BOOL}"]
22 -> 27 [label = "t_55:{group_mark:SECRET:BOOL}"]
22 -> 28 [label = "t_55:{group_mark:SECRET:BOOL}"]
22 -> 29 [label = "t_55:{group_mark:SECRET:BOOL}"]
22 -> 30 [label = "t_55:{group_mark:SECRET:BOOL}"]
23 -> 30 [label = "t_56:{group_mark:SECRET:INT64}"]
24 -> 25 [label = "t_57:{encrypt_int_0:SECRET:INT64}"]
25 -> 26 [label = "t_58:{group_mark:SECRET:BOOL}"]
26 -> 27 [label = "t_59:{LogicalOr_out:SECRET:BOOL}"]
27 -> 30 [label = "t_60:{LogicalOr_out:SECRET:INT64}"]
28 -> 30 [label = "t_61:{aggregate_int_0:SECRET:INT64}"]
29 -> 30 [label = "t_62:{aggregate_int_0:SECRET:INT64}"]
3 -> 8 [label = "t_8:{groupby_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_9:{join_int_0:PRIVATE:INT64}"]
30 -> 31 [label = "t_67:{group_mark:SECRET:BOOL}"]
30 -> 32 [label = "t_63:{group_mark:SECRET:INT64}"]
30 -> 32 [label = "t_64:{LogicalOr_out:SECRET:INT64}"]
30 -> 32 [label = "t_65:{aggregate_int_0:SECRET:INT64}"]
30 -> 32 [label = "t_66:{aggregate_int_0:SECRET:INT64}"]
31 -> 32 [label = "t_68:{group_mark:PUBLIC:BOOL}"]
32 -> 34 [label = "t_69:{group_mark:SECRET:INT64}"]
32 -> 35 [label = "t_69:{group_mark:SECRET:INT64}"]
32 -> 39 [label = "t_69:{group_mark:SECRET:INT64}"]
32 -> 39 [label = "t_70:{LogicalOr_out:SECRET:INT64}"]
32 -> 39 [label = "t_71:{aggregate_int_0:SECRET:INT64}"]
32 -> 39 [label = "t_72:{aggregate_int_0:SECRET:INT64}"]
33 -> 34 [label = "t_73:{constant_data:PUBLIC:INT64}"]
34 -> 36 [label = "t_74:{constant_data:PUBLIC:INT64}"]
35 -> 37 [label = "t_75:{group_mark:PRIVATE:INT64}"]
36 -> 37 [label = "t_76:{constant_data:PRIVATE:INT64}"]
37 -> 38 [label = "t_77:{GreaterEqual_out:PRIVATE:BOOL}"]
38 -> 39 [label = "t_78:{GreaterEqual_out:PUBLIC:BOOL}"]
39 -> 40 [label = "t_79:{group_mark:SECRET:INT64}"]
39 -> 41 [label = "t_80:{LogicalOr_out:SECRET:INT64}"]
39 -> 42 [label = "t_81:{aggregate_int_0:SECRET:INT64}"]
39 -> 43 [label = "t_82:{aggregate_int_0:SECRET:INT64}"]
4 -> 6 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_10:{aggregate_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_11:{encrypt_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_12:{groupby_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
40 -> 44 [label = "t_83:{group_mark:PRIVATE:INT64}"]
41 -> 44 [label = "t_85:{LogicalOr_out:PRIVATE:INT64}"]
42 -> 44 [label = "t_87:{aggregate_int_0:PRIVATE:INT64}"]
43 -> 44 [label = "t_89:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_14:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_15:{groupby_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_16:{groupby_string_0:PRIVATE:STRING}"]
5 -> 10 [label = "t_17:{join_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_17:{join_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_19:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_18:{join_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_18:{join_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_20:{join_int_0:PRIVATE:INT64}"]
8 -> 11 [label = "t_21:{groupby_int_0:PRIVATE:INT64}"]
8 -> 15 [label = "t_22:{join_int_0:PRIVATE:INT64}"]
9 -> 12 [label = "t_25:{groupby_int_0:PRIVATE:INT64}"]
9 -> 16 [label = "t_23:{aggregate_int_0:PRIVATE:INT64}"]
9 -> 17 [label = "t_24:{encrypt_int_0:PRIVATE:INT64}"]
9 -> 18 [label = "t_26:{join_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select count(*) as c, count(distinct bob.encrypt_int_0) as cd, sum(bob.aggregate_int_0) as sb, sum(carol.aggregate_int_0) as sc from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.join_int_0 = bob.join_int_0 and bob.join_int_0 = carol.join_int_0 group by alice.groupby_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.groupby_int_0,alice.join_int_0 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,t_4,},],attr:[sql:select bob.aggregate_int_0,bob.encrypt_int_0,bob.join_int_0 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_4,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{t_6,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,t_8,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,t_4,},RowsIndexFilter:{t_6,},],out:[Out:{t_9,t_10,t_11,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_12,t_13,},],attr:[sql:select carol.aggregate_int_0,carol.join_int_0 from carol.tbl_0 as carol,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_11,},Right:{t_13,},],out:[LeftJoinIndex:{t_14,},RightJoinIndex:{t_15,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_14,},],out:[Out:{t_16,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_7,t_8,},RowsIndexFilter:{t_16,},],out:[Out:{t_17,t_18,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_9,t_10,t_11,},RowsIndexFilter:{t_14,},],out:[Out:{t_19,t_20,t_21,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_12,t_13,},RowsIndexFilter:{t_15,},],out:[Out:{t_22,t_23,},],attr:[],party:[carol,]}"]
11 [label="make_share:{in:[In:{t_17,},],out:[Out:{t_24,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_18,},],out:[Out:{t_25,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_share:{in:[In:{t_19,},],out:[Out:{t_26,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_20,},],out:[Out:{t_27,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="make_share:{in:[In:{t_21,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_share:{in:[In:{t_22,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="make_share:{in:[In:{t_23,},],out:[Out:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="sort:{in:[In:{t_24,t_24,t_25,t_26,t_27,t_28,t_29,t_30,},Key:{t_24,},],out:[Out:{t_31,t_32,t_33,t_34,t_35,t_36,t_37,t_38,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
19 [label="group_mark:{in:[Key:{t_31,},],out:[Group:{t_39,},],attr:[],party:[alice,bob,carol,]}"]
20 [label="count:{in:[Group:{t_39,},In:{t_39,},],out:[Out:{t_40,},],attr:[],party:[alice,bob,carol,]}"]
21 [label="sort:{in:[In:{t_35,},Key:{t_31,t_35,},],out:[Out:{t_41,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
22 [label="group_mark:{in:[Key:{t_41,},],out:[Group:{t_42,},],attr:[],party:[alice,bob,carol,]}"]
23 [label="LogicalOr:{in:[Left:{t_39,},Right:{t_42,},],out:[Out:{t_43,},],attr:[],party:[alice,bob,carol,]}"]
24 [label="sum:{in:[Group:{t_39,},In:{t_43,},],out:[Out:{t_44,},],attr:[],party:[alice,bob,carol,]}"]
25 [label="sum:{in:[Group:{t_39,},In:{t_34,},],out:[Out:{t_45,},],attr:[],party:[alice,bob,carol,]}"]
26 [label="sum:{in:[Group:{t_39,},In:{t_37,},],out:[Out:{t_46,},],attr:[],party:[alice,bob,carol,]}"]
27 [label="shuffle:{in:[In:{t_40,t_44,t_45,t_46,t_39,},],out:[Out:{t_47,t_48,t_49,t_50,t_51,},],attr:[],party:[alice,bob,carol,]}"]
28 [label="make_public:{in:[In:{t_51,},],out:[Out:{t_52,},],attr:[],party:[alice,bob,carol,]}"]
29 [label="filter:{in:[Filter:{t_52,},In:{t_47,t_48,t_49,t_50,},],out:[Out:{t_53,t_54,t_55,t_56,},],attr:[],party:[alice,bob,carol,]}"]
30 [label="make_constant:{in:[],out:[Out:{t_57,},],attr:[scalar:4,to_status:1,],party:[alice,bob,carol,]}"]
31 [label="broadcast:{in:[In:{t_57,},ShapeRefTensor:{t_53,},],out:[Out:{t_58,},],attr:[],party:[alice,bob,carol,]}"]
32 [label="make_private:{in:[In:{t_53,},],out:[Out:{t_59,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
33 [label="make_private:{in:[In:{t_58,},],out:[Out:{t_60,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
34 [label="GreaterEqual:{in:[Left:{t_59,},Right:{t_60,},],out:[Out:{t_61,},],attr:[],party:[alice,]}"]
35 [label="make_public:{in:[In:{t_61,},],out:[Out:{t_62,},],attr:[],party:[alice,bob,carol,]}"]
36 [label="apply_filter:{in:[Filter:{t_62,},In:{t_53,t_54,t_55,t_56,},],out:[Out:{t_63,t_64,t_65,t_66,},],attr:[],party:[alice,bob,carol,]}"]
37 [label="make_private:{in:[In:{t_63,},],out:[Out:{t_67,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
38 [label="make_private:{in:[In:{t_64,},],out:[Out:{t_69,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
39 [label="make_private:{in:[In:{t_65,},],out:[Out:{t_71,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
40 [label="make_private:{in:[In:{t_66,},],out:[Out:{t_73,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
41 [label="publish:{in:[In:{t_67,t_69,t_71,t_73,},],out:[Out:{t_68,t_70,t_72,t_74,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{groupby_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{aggregate_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{encrypt_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
10 -> 16 [label = "t_22:{aggregate_int_0:PRIVATE:INT64}"]
10 -> 17 [label = "t_23:{join_int_0:PRIVATE:INT64}"]
11 -> 18 [label = "t_24:{groupby_int_0:SECRET:INT64}"]
11 -> 18 [label = "t_24:{groupby_int_0:SECRET:INT64}"]
11 -> 18 [label = "t_24:{groupby_int_0:SECRET:INT64}"]
12 -> 18 [label = "t_25:{join_int_0:SECRET:INT64}"]
13 -> 18 [label = "t_26:{aggregate_int_0:SECRET:INT64}"]
14 -> 18 [label = "t_27:{encrypt_int_0:SECRET:INT64}"]
15 -> 18 [label = "t_28:{join_int_0:SECRET:INT64}"]
16 -> 18 [label = "t_29:{aggregate_int_0:SECRET:INT64}"]
17 -> 18 [label = "t_30:{join_int_0:SECRET:INT64}"]
18 -> 19 [label = "t_31:{groupby_int_0:SECRET:INT64}"]
18 -> 21 [label = "t_31:{groupby_int_0:SECRET:INT64}"]
18 -> 21 [label = "t_35:{encrypt_int_0:SECRET:INT64}"]
18 -> 21 [label = "t_35:{encrypt_int_0:SECRET:INT64}"]
18 -> 25 [label = "t_34:{aggregate_int_0:SECRET:INT64}"]
18 -> 26 [label = "t_37:{aggregate_int_0:SECRET:INT64}"]
19 -> 20 [label = "t_39:{group_mark:SECRET:BOOL}"]
19 -> 20 [label = "t_39:{group_mark:SECRET:BOOL}"]
19 -> 23 [label = "t_39:{group_mark:SECRET:BOOL}"]
19 -> 24 [label = "t_39:{group_mark:SECRET:BOOL}"]
19 -> 25 [label = "t_39:{group_mark:SECRET:BOOL}"]
19 -> 26 [label = "t_39:{group_mark:SECRET:BOOL}"]
19 -> 27 [label = "t_39:{group_mark:SECRET:BOOL}"]
2 -> 3 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
20 -> 27 [label = "t_40:{group_mark:SECRET:INT64}"]
21 -> 22 [label = "t_41:{encrypt_int_0:SECRET:INT64}"]
22 -> 23 [label = "t_42:{group_mark:SECRET:BOOL}"]
23 -> 24 [label = "t_43:{LogicalOr_out:SECRET:BOOL}"]
24 -> 27 [label = "t_44:{LogicalOr_out:SECRET:INT64}"]
25 -> 27 [label = "t_45:{aggregate_int_0:SECRET:INT64}"]
26 -> 27 [label = "t_46:{aggregate_int_0:SECRET:INT64}"]
27 -> 28 [label = "t_51:{group_mark:SECRET:BOOL}"]
27 -> 29 [label = "t_47:{group_mark:SECRET:INT64}"]
27 -> 29 [label = "t_48:{LogicalOr_out:SECRET:INT64}"]
27 -> 29 [label = "t_49:{aggregate_int_0:SECRET:INT64}"]
27 -> 29 [label = "t_50:{aggregate_int_0:SECRET:INT64}"]
28 -> 29 [label = "t_52:{group_mark:PUBLIC:BOOL}"]
29 -> 31 [label = "t_53:{group_mark:SECRET:INT64}"]
29 -> 32 [label = "t_53:{group_mark:SECRET:INT64}"]
29 -> 36 [label = "t_53:{group_mark:SECRET:INT64}"]
29 -> 36 [label = "t_54:{LogicalOr_out:SECRET:INT64}"]
29 -> 36 [label = "t_55:{aggregate_int_0:SECRET:INT64}"]
29 -> 36 [label = "t_56:{aggregate_int_0:SECRET:INT64}"]
3 -> 8 [label = "t_7:{groupby_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_8:{join_int_0:PRIVATE:INT64}"]
30 -> 31 [label = "t_57:{constant_data:PUBLIC:INT64}"]
31 -> 33 [label = "t_58:{constant_data:PUBLIC:INT64}"]
32 -> 34 [label = "t_59:{group_mark:PRIVATE:INT64}"]
33 -> 34 [label = "t_60:{constant_data:PRIVATE:INT64}"]
34 -> 35 [label = "t_61:{GreaterEqual_out:PRIVATE:BOOL}"]
35 -> 36 [label = "t_62:{GreaterEqual_out:PUBLIC:BOOL}"]
36 -> 37 [label = "t_63:{group_mark:SECRET:INT64}"]
36 -> 38 [label = "t_64:{LogicalOr_out:SECRET:INT64}"]
36 -> 39 [label = "t_65:{aggregate_int_0:SECRET:INT64}"]
36 -> 40 [label = "t_66:{aggregate_int_0:SECRET:INT64}"]
37 -> 41 [label = "t_67:{group_mark:PRIVATE:INT64}"]
38 -> 41 [label = "t_69:{LogicalOr_out:PRIVATE:INT64}"]
39 -> 41 [label = "t_71:{aggregate_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_11:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_10:{encrypt_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_11:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_9:{aggregate_int_0:PRIVATE:INT64}"]
40 -> 41 [label = "t_73:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_12:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_15:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_14:{join_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_14:{join_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
8 -> 11 [label = "t_17:{groupby_int_0:PRIVATE:INT64}"]
8 -> 12 [label = "t_18:{join_int_0:PRIVATE:INT64}"]
9 -> 13 [label = "t_19:{aggregate_int_0:PRIVATE:INT64}"]
9 -> 14 [label = "t_20:{encrypt_int_0:PRIVATE:INT64}"]
9 -> 15 [label = "t_21:{join_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select (alice.join_int_0 + bob.compare_int_0 + carol.compare_int_0) <> 0 as reduce_res from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.join_int_0 = bob.join_int_0 and bob.join_int_0 = carol.join_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.join_int_0 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,t_2,},],attr:[sql:select bob.compare_int_0,bob.join_int_0 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_8,t_9,},],attr:[sql:select carol.compare_int_0,carol.join_int_0 from carol.tbl_0 as carol,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_7,},Right:{t_9,},],out:[LeftJoinIndex:{t_10,},RightJoinIndex:{t_11,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_10,},],out:[Out:{t_12,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_5,},RowsIndexFilter:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_6,t_7,},RowsIndexFilter:{t_10,},],out:[Out:{t_14,t_15,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_8,t_9,},RowsIndexFilter:{t_11,},],out:[Out:{t_16,t_17,},],attr:[],party:[carol,]}"]
11 [label="copy:{in:[In:{t_13,},],out:[Out:{t_18,},],attr:[input_party_codes:alice,output_party_codes:bob,],party:[alice,bob,]}"]
12 [label="Add:{in:[Left:{t_18,},Right:{t_14,},],out:[Out:{t_19,},],attr:[],party:[bob,]}"]
13 [label="make_share:{in:[In:{t_19,},],out:[Out:{t_20,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_16,},],out:[Out:{t_21,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="Add:{in:[Left:{t_20,},Right:{t_21,},],out:[Out:{t_22,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_constant:{in:[],out:[Out:{t_23,},],attr:[scalar:0,to_status:1,],party:[alice,bob,carol,]}"]
17 [label="broadcast:{in:[In:{t_23,},ShapeRefTensor:{t_22,},],out:[Out:{t_24,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="NotEqual:{in:[Left:{t_22,},Right:{t_24,},],out:[Out:{t_25,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="make_private:{in:[In:{t_25,},],out:[Out:{t_26,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
20 [label="publish:{in:[In:{t_26,},],out:[Out:{t_27,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
10 -> 14 [label = "t_16:{compare_int_0:PRIVATE:INT64}"]
11 -> 12 [label = "t_18:{join_int_0:PRIVATE:INT64}"]
12 -> 13 [label = "t_19:{Add_out:PRIVATE:INT64}"]
13 -> 15 [label = "t_20:{Add_out:SECRET:INT64}"]
14 -> 15 [label = "t_21:{compare_int_0:SECRET:INT64}"]
15 -> 17 [label = "t_22:{Add_out:SECRET:INT64}"]
15 -> 18 [label = "t_22:{Add_out:SECRET:INT64}"]
16 -> 17 [label = "t_23:{constant_data:PUBLIC:INT64}"]
17 -> 18 [label = "t_24:{constant_data:PUBLIC:INT64}"]
18 -> 19 [label = "t_25:{NotEqual_out:SECRET:BOOL}"]
19 -> 20 [label = "t_26:{NotEqual_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_8:{compare_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_9:{join_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_9:{join_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_11:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_10:{join_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_10:{join_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_12:{join_int_0:PRIVATE:INT64}"]
8 -> 11 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
9 -> 12 [label = "t_14:{compare_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select alice.plain_int_0 + bob.join_int_0 + carol.join_int_0 as add_res, alice.plain_int_0 - bob.join_int_0 - carol.join_int_0 as minus_res, alice.plain_int_0 * bob.join_int_0 * carol.join_int_0 as multi_res, alice.plain_int_0 / bob.join_int_0 / carol.join_int_0 as div_res from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.join_int_0 = bob.join_int_0 and bob.join_int_0 = carol.join_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.join_int_0,alice.plain_int_0 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select bob.join_int_0 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_8,},],attr:[sql:select carol.join_int_0 from carol.tbl_0 as carol,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_7,},Right:{t_8,},],out:[LeftJoinIndex:{t_9,},RightJoinIndex:{t_10,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_9,},],out:[Out:{t_11,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_5,t_6,},RowsIndexFilter:{t_11,},],out:[Out:{t_12,t_13,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_7,},RowsIndexFilter:{t_9,},],out:[Out:{t_14,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_8,},RowsIndexFilter:{t_10,},],out:[Out:{t_15,},],attr:[],party:[carol,]}"]
11 [label="copy:{in:[In:{t_14,},],out:[Out:{t_16,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
12 [label="Add:{in:[Left:{t_13,},Right:{t_16,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
13 [label="copy:{in:[In:{t_15,},],out:[Out:{t_18,},],attr:[input_party_codes:carol,output_party_codes:alice,],party:[carol,alice,]}"]
14 [label="Add:{in:[Left:{t_17,},Right:{t_18,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
15 [label="Minus:{in:[Left:{t_13,},Right:{t_16,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
16 [label="Minus:{in:[Left:{t_20,},Right:{t_18,},],out:[Out:{t_21,},],attr:[],party:[alice,]}"]
17 [label="Mul:{in:[Left:{t_13,},Right:{t_16,},],out:[Out:{t_22,},],attr:[],party:[alice,]}"]
18 [label="Mul:{in:[Left:{t_22,},Right:{t_18,},],out:[Out:{t_23,},],attr:[],party:[alice,]}"]
19 [label="cast:{in:[In:{t_13,},],out:[Out:{t_24,},],attr:[],party:[alice,]}"]
20 [label="Div:{in:[Left:{t_24,},Right:{t_16,},],out:[Out:{t_25,},],attr:[],party:[alice,]}"]
21 [label="Div:{in:[Left:{t_25,},Right:{t_18,},],out:[Out:{t_26,},],attr:[],party:[alice,]}"]
22 [label="publish:{in:[In:{t_19,t_21,t_23,t_26,},],out:[Out:{t_27,t_28,t_29,t_30,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
10 -> 13 [label = "t_15:{join_int_0:PRIVATE:INT64}"]
11 -> 12 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
11 -> 15 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
11 -> 17 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
11 -> 20 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
12 -> 14 [label = "t_17:{Add_out:PRIVATE:INT64}"]
13 -> 14 [label = "t_18:{join_int_0:PRIVATE:INT64}"]
13 -> 16 [label = "t_18:{join_int_0:PRIVATE:INT64}"]
13 -> 18 [label = "t_18:{join_int_0:PRIVATE:INT64}"]
13 -> 21 [label = "t_18:{join_int_0:PRIVATE:INT64}"]
14 -> 22 [label = "t_19:{Add_out:PRIVATE:INT64}"]
15 -> 16 [label = "t_20:{Minus_out:PRIVATE:INT64}"]
16 -> 22 [label = "t_21:{Minus_out:PRIVATE:INT64}"]
17 -> 18 [label = "t_22:{Mul_out:PRIVATE:INT64}"]
18 -> 22 [label = "t_23:{Mul_out:PRIVATE:INT64}"]
19 -> 20 [label = "t_24:{plain_int_0:PRIVATE:FLOAT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
20 -> 21 [label = "t_25:{Div_out:PRIVATE:FLOAT64}"]
21 -> 22 [label = "t_26:{Div_out:PRIVATE:FLOAT64}"]
3 -> 8 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_8:{join_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_8:{join_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_10:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_9:{join_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_9:{join_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_11:{join_int_0:PRIVATE:INT64}"]
8 -> 12 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
8 -> 15 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
8 -> 17 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
8 -> 19 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
9 -> 11 [label = "t_14:{join_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select concat(plain_string_0, plain_string_1) as tt from alice.tbl_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select concat(tbl_0.plain_string_0, tbl_0.plain_string_1) as tt from alice.tbl_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{Column#91:PRIVATE:STRING}"]
}`, testConf{}},
	{`select count(*) as c from alice.tbl_1 join alice.tbl_2 on tbl_1.plain_int_0 = tbl_2.plain_int_0 group by tbl_1.plain_float_0 having count(*) > 3`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select count(1) as c from alice.tbl_1 join alice.tbl_2 on tbl_1.plain_int_0=tbl_2.plain_int_0 group by tbl_1.plain_float_0 having (count(1)>3) and (count(1)>=4),table_refs:[alice.tbl_1 alice.tbl_2],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{Column#182:PRIVATE:INT64}"]
}`, testConf{}},
	{`select tbl_1.plain_float_0 from alice.tbl_1 join alice.tbl_2 on tbl_1.plain_int_0 = tbl_2.plain_int_0 group by tbl_1.plain_float_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(tbl_1.plain_float_0) as expr_79 from alice.tbl_1 join alice.tbl_2 on tbl_1.plain_int_0=tbl_2.plain_int_0 group by tbl_1.plain_float_0,table_refs:[alice.tbl_1 alice.tbl_2],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{plain_float_0:PRIVATE:FLOAT32}"]
}`, testConf{}},
	{`select plain_int_0 from alice.tbl_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_int_0 from alice.tbl_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select count(*) as c, sum(plain_int_0) as b, max(plain_int_0) as a, min(plain_int_0) as d from alice.tbl_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,t_3,},],attr:[sql:select count(1) as c,sum(tbl_0.plain_int_0) as b,max(tbl_0.plain_int_0) as a,min(tbl_0.plain_int_0) as d from alice.tbl_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,t_1,t_2,t_3,},],out:[Out:{t_4,t_5,t_6,t_7,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{Column#91:PRIVATE:INT64}"]
0 -> 1 [label = "t_1:{Column#92:PRIVATE:INT64}"]
0 -> 1 [label = "t_2:{Column#93:PRIVATE:INT64}"]
0 -> 1 [label = "t_3:{Column#94:PRIVATE:INT64}"]
}`, testConf{}},
	{`select plain_int_0 from alice.tbl_0 into outfile party_code 'alice' '/tmp/output.txt' fields terminated BY ','`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_int_0 from alice.tbl_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="dump_file:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[field_deliminator:,,file_path:/tmp/output.txt,line_terminator:
,quoting_style:0,],party:[alice,]}"]
0 -> 1 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select plain_int_0 from alice.tbl_0 into outfile party_code 'alice' '/tmp/output.txt' columns terminated BY '|' optionally enclosed BY '"' lines terminated BY 'end of line';`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_int_0 from alice.tbl_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="dump_file:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[field_deliminator:|,file_path:/tmp/output.txt,line_terminator:end of line,quoting_style:1,],party:[alice,]}"]
0 -> 1 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select (ta.compare_int_0 + tb.compare_int_0) > 0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0 into outfile party_code 'alice' '/tmp/output.txt' fields terminated BY ','`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.compare_int_0,ta.join_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.compare_int_0,tb.join_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="Add:{in:[Left:{t_10,},Right:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_13,},],attr:[scalar:0,to_status:1,],party:[alice,bob,carol,]}"]
9 [label="broadcast:{in:[In:{t_13,},ShapeRefTensor:{t_12,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="Greater:{in:[Left:{t_12,},Right:{t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_private:{in:[In:{t_15,},],out:[Out:{t_16,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
12 [label="dump_file:{in:[In:{t_16,},],out:[Out:{t_17,},],attr:[field_deliminator:,,file_path:/tmp/output.txt,line_terminator:
,quoting_style:0,],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_15:{Greater_out:SECRET:BOOL}"]
11 -> 12 [label = "t_16:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_8:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_10:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_11:{compare_int_0:SECRET:INT64}"]
7 -> 10 [label = "t_12:{Add_out:SECRET:INT64}"]
7 -> 9 [label = "t_12:{Add_out:SECRET:INT64}"]
8 -> 9 [label = "t_13:{constant_data:PUBLIC:INT64}"]
9 -> 10 [label = "t_14:{constant_data:PUBLIC:INT64}"]
}`, testConf{}},
	{`select ta.plain_int_0, count(*) as c, sum(ta.plain_int_0) as b, max(ta.plain_int_0) as a, min(ta.plain_int_0) as d from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0 group by ta.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[bob,]}"]
5 [label="group:{in:[Key:{t_4,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
6 [label="count:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
7 [label="sum:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_4,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
8 [label="max:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_4,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
9 [label="min:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_4,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
10 [label="firstrow:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_4,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
11 [label="make_constant:{in:[],out:[Out:{t_13,},],attr:[scalar:4,to_status:1,],party:[alice,bob,carol,]}"]
12 [label="broadcast:{in:[In:{t_13,},ShapeRefTensor:{t_8,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
13 [label="GreaterEqual:{in:[Left:{t_8,},Right:{t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
14 [label="apply_filter:{in:[Filter:{t_15,},In:{t_12,t_8,t_9,t_10,t_11,},],out:[Out:{t_16,t_17,t_18,t_19,t_20,},],attr:[],party:[alice,]}"]
15 [label="publish:{in:[In:{t_16,t_17,t_18,t_19,t_20,},],out:[Out:{t_21,t_22,t_23,t_24,t_25,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
10 -> 14 [label = "t_12:{plain_int_0_firstrow:PRIVATE:INT64}"]
11 -> 12 [label = "t_13:{constant_data:PUBLIC:INT64}"]
12 -> 13 [label = "t_14:{constant_data:PRIVATE:INT64}"]
13 -> 14 [label = "t_15:{GreaterEqual_out:PRIVATE:BOOL}"]
14 -> 15 [label = "t_16:{plain_int_0_firstrow:PRIVATE:INT64}"]
14 -> 15 [label = "t_17:{group_id_count:PRIVATE:INT64}"]
14 -> 15 [label = "t_18:{plain_int_0_sum:PRIVATE:INT64}"]
14 -> 15 [label = "t_19:{plain_int_0_max:PRIVATE:INT64}"]
14 -> 15 [label = "t_20:{plain_int_0_min:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 10 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_6:{group_id:PRIVATE:INT64}"]
5 -> 10 [label = "t_7:{group_num:PRIVATE:INT64}"]
5 -> 6 [label = "t_6:{group_id:PRIVATE:INT64}"]
5 -> 6 [label = "t_6:{group_id:PRIVATE:INT64}"]
5 -> 6 [label = "t_7:{group_num:PRIVATE:INT64}"]
5 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
5 -> 7 [label = "t_7:{group_num:PRIVATE:INT64}"]
5 -> 8 [label = "t_6:{group_id:PRIVATE:INT64}"]
5 -> 8 [label = "t_7:{group_num:PRIVATE:INT64}"]
5 -> 9 [label = "t_6:{group_id:PRIVATE:INT64}"]
5 -> 9 [label = "t_7:{group_num:PRIVATE:INT64}"]
6 -> 12 [label = "t_8:{group_id_count:PRIVATE:INT64}"]
6 -> 13 [label = "t_8:{group_id_count:PRIVATE:INT64}"]
6 -> 14 [label = "t_8:{group_id_count:PRIVATE:INT64}"]
7 -> 14 [label = "t_9:{plain_int_0_sum:PRIVATE:INT64}"]
8 -> 14 [label = "t_10:{plain_int_0_max:PRIVATE:INT64}"]
9 -> 14 [label = "t_11:{plain_int_0_min:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.groupby_int_0, count(distinct(ta.compare_int_0)), sum(ta.compare_int_0) as b, max(ta.compare_int_0) as a, min(ta.compare_int_0) as d from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0 group by ta.groupby_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select ta.compare_int_0,ta.groupby_int_0,ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_2,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,t_8,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_9,},],attr:[],party:[bob,]}"]
5 [label="group:{in:[Key:{t_7,},],out:[GroupId:{t_10,},GroupNum:{t_11,},],attr:[],party:[alice,]}"]
6 [label="count_distinct:{in:[GroupId:{t_10,},GroupNum:{t_11,},In:{t_6,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
7 [label="sum:{in:[GroupId:{t_10,},GroupNum:{t_11,},In:{t_6,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
8 [label="max:{in:[GroupId:{t_10,},GroupNum:{t_11,},In:{t_6,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
9 [label="min:{in:[GroupId:{t_10,},GroupNum:{t_11,},In:{t_6,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
10 [label="firstrow:{in:[GroupId:{t_10,},GroupNum:{t_11,},In:{t_7,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
11 [label="publish:{in:[In:{t_16,t_12,t_13,t_14,t_15,},],out:[Out:{t_17,t_18,t_19,t_20,t_21,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{groupby_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_16:{groupby_int_0_firstrow:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 10 [label = "t_7:{groupby_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_7:{groupby_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_10:{group_id:PRIVATE:INT64}"]
5 -> 10 [label = "t_11:{group_num:PRIVATE:INT64}"]
5 -> 6 [label = "t_10:{group_id:PRIVATE:INT64}"]
5 -> 6 [label = "t_11:{group_num:PRIVATE:INT64}"]
5 -> 7 [label = "t_10:{group_id:PRIVATE:INT64}"]
5 -> 7 [label = "t_11:{group_num:PRIVATE:INT64}"]
5 -> 8 [label = "t_10:{group_id:PRIVATE:INT64}"]
5 -> 8 [label = "t_11:{group_num:PRIVATE:INT64}"]
5 -> 9 [label = "t_10:{group_id:PRIVATE:INT64}"]
5 -> 9 [label = "t_11:{group_num:PRIVATE:INT64}"]
6 -> 11 [label = "t_12:{compare_int_0_count_distinct:PRIVATE:INT64}"]
7 -> 11 [label = "t_13:{compare_int_0_sum:PRIVATE:INT64}"]
8 -> 11 [label = "t_14:{compare_int_0_max:PRIVATE:INT64}"]
9 -> 11 [label = "t_15:{compare_int_0_min:PRIVATE:INT64}"]
}`, testConf{}},
	{`select count(distinct(ta.compare_int_0)), sum(ta.compare_int_0) as b, max(ta.compare_int_0) as a, min(ta.compare_int_0) as d from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.compare_int_0,ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="unique:{in:[Key:{t_5,},],out:[UniqueKey:{t_8,},],attr:[],party:[alice,]}"]
6 [label="reduce_count:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
7 [label="reduce_sum:{in:[In:{t_5,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
8 [label="reduce_max:{in:[In:{t_5,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
9 [label="reduce_min:{in:[In:{t_5,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
10 [label="publish:{in:[In:{t_9,t_10,t_11,t_12,},],out:[Out:{t_13,t_14,t_15,t_16,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_5:{compare_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_5:{compare_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_5:{compare_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_5:{compare_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_8:{compare_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_9:{compare_int_0:PRIVATE:INT64}"]
7 -> 10 [label = "t_10:{compare_int_0:PRIVATE:INT64}"]
8 -> 10 [label = "t_11:{compare_int_0:PRIVATE:INT64}"]
9 -> 10 [label = "t_12:{compare_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.plain_int_0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[bob,]}"]
5 [label="publish:{in:[In:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.plain_int_0 from alice.tbl_0 as ta left join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:1,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="publish:{in:[In:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.plain_int_0 from alice.tbl_0 as ta left join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0 left join carol.tbl_0 as tc on tb.join_int_1 = tc.join_int_1`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.join_int_0,tb.join_int_1 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:1,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_10,},],attr:[sql:select tc.join_int_1 from carol.tbl_0 as tc,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_9,},Right:{t_10,},],out:[LeftJoinIndex:{t_11,},RightJoinIndex:{t_12,},],attr:[input_party_codes:[bob carol],join_type:1,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_11,},],out:[Out:{t_13,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_6,t_7,},RowsIndexFilter:{t_13,},],out:[Out:{t_14,t_15,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_8,t_9,},RowsIndexFilter:{t_11,},],out:[Out:{t_16,t_17,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_10,},RowsIndexFilter:{t_12,},],out:[Out:{t_18,},],attr:[],party:[carol,]}"]
11 [label="publish:{in:[In:{t_15,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{join_int_1:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_9:{join_int_1:PRIVATE:INT64}"]
4 -> 9 [label = "t_8:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_9:{join_int_1:PRIVATE:INT64}"]
5 -> 10 [label = "t_10:{join_int_1:PRIVATE:INT64}"]
5 -> 6 [label = "t_10:{join_int_1:PRIVATE:INT64}"]
6 -> 10 [label = "t_12:{join_int_1:PRIVATE:INT64}"]
6 -> 7 [label = "t_11:{join_int_1:PRIVATE:INT64}"]
6 -> 9 [label = "t_11:{join_int_1:PRIVATE:INT64}"]
7 -> 8 [label = "t_13:{join_int_1:PRIVATE:INT64}"]
8 -> 11 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select max(ta.aggregate_float_0 + ta.aggregate_float_0) from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.aggregate_float_0,ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="Add:{in:[Left:{t_5,},Right:{t_5,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
6 [label="reduce_max:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
7 [label="publish:{in:[In:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{aggregate_float_0:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_5:{aggregate_float_0:PRIVATE:FLOAT32}"]
3 -> 5 [label = "t_5:{aggregate_float_0:PRIVATE:FLOAT32}"]
5 -> 6 [label = "t_8:{Add_out:PRIVATE:FLOAT64}"]
6 -> 7 [label = "t_9:{Add_out:PRIVATE:FLOAT64}"]
}`, testConf{}},
	{`select count(*) as c, sum(ta.plain_int_0) as b, max(ta.plain_int_0) as a, min(ta.plain_int_0) as d, avg(ta.plain_int_0) as f from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[bob,]}"]
5 [label="shape:{in:[In:{t_4,},],out:[Out:{t_6,},],attr:[axis:0,],party:[alice,]}"]
6 [label="reduce_sum:{in:[In:{t_4,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
7 [label="reduce_max:{in:[In:{t_4,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="reduce_min:{in:[In:{t_4,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
9 [label="reduce_avg:{in:[In:{t_4,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
10 [label="publish:{in:[In:{t_6,t_7,t_8,t_9,t_10,},],out:[Out:{t_11,t_12,t_13,t_14,t_15,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
7 -> 10 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
8 -> 10 [label = "t_9:{plain_int_0:PRIVATE:INT64}"]
9 -> 10 [label = "t_10:{plain_int_0:PRIVATE:FLOAT64}"]
}`, testConf{}},
	{`select ta.plain_int_0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0 where ta.plain_int_1 > tb.plain_int_1`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.plain_int_0,ta.plain_int_1 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.plain_int_0,tb.plain_int_1 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_9,},],out:[Out:{t_10,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="Greater:{in:[Left:{t_7,},Right:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
7 [label="apply_filter:{in:[Filter:{t_11,},In:{t_6,t_7,},],out:[Out:{t_12,t_13,},],attr:[],party:[alice,]}"]
8 [label="copy:{in:[In:{t_11,},],out:[Out:{t_14,},],attr:[input_party_codes:alice,output_party_codes:bob,],party:[alice,bob,]}"]
9 [label="apply_filter:{in:[Filter:{t_14,},In:{t_8,t_9,},],out:[Out:{t_15,t_16,},],attr:[],party:[bob,]}"]
10 [label="publish:{in:[In:{t_12,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_1:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{plain_int_1:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_7:{plain_int_1:PRIVATE:INT64}"]
3 -> 7 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_7:{plain_int_1:PRIVATE:INT64}"]
4 -> 5 [label = "t_9:{plain_int_1:PRIVATE:INT64}"]
4 -> 9 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_9:{plain_int_1:PRIVATE:INT64}"]
5 -> 6 [label = "t_10:{plain_int_1:PRIVATE:INT64}"]
6 -> 7 [label = "t_11:{Greater_out:PRIVATE:BOOL}"]
6 -> 8 [label = "t_11:{Greater_out:PRIVATE:BOOL}"]
7 -> 10 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
8 -> 9 [label = "t_14:{Greater_out:PRIVATE:BOOL}"]
}`, testConf{}},
	{`select ta.plain_int_0 * tb.plain_int_0 as t1, ta.plain_int_0 + tb.plain_int_0 as t2, ta.plain_int_0 - tb.plain_int_0 as t3, ta.plain_int_0 / tb.plain_int_0 as t1 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0 where ta.plain_int_1 > tb.plain_int_1`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.plain_int_0,ta.plain_int_1 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.plain_int_0,tb.plain_int_1 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_9,},],out:[Out:{t_10,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="Greater:{in:[Left:{t_7,},Right:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
7 [label="apply_filter:{in:[Filter:{t_11,},In:{t_6,t_7,},],out:[Out:{t_12,t_13,},],attr:[],party:[alice,]}"]
8 [label="copy:{in:[In:{t_11,},],out:[Out:{t_14,},],attr:[input_party_codes:alice,output_party_codes:bob,],party:[alice,bob,]}"]
9 [label="apply_filter:{in:[Filter:{t_14,},In:{t_8,t_9,},],out:[Out:{t_15,t_16,},],attr:[],party:[bob,]}"]
10 [label="copy:{in:[In:{t_15,},],out:[Out:{t_17,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
11 [label="Mul:{in:[Left:{t_12,},Right:{t_17,},],out:[Out:{t_18,},],attr:[],party:[alice,]}"]
12 [label="Add:{in:[Left:{t_12,},Right:{t_17,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
13 [label="Minus:{in:[Left:{t_12,},Right:{t_17,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
14 [label="cast:{in:[In:{t_12,},],out:[Out:{t_21,},],attr:[],party:[alice,]}"]
15 [label="Div:{in:[Left:{t_21,},Right:{t_17,},],out:[Out:{t_22,},],attr:[],party:[alice,]}"]
16 [label="publish:{in:[In:{t_18,t_19,t_20,t_22,},],out:[Out:{t_23,t_24,t_25,t_26,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_1:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{plain_int_1:PRIVATE:INT64}"]
10 -> 11 [label = "t_17:{plain_int_0:PRIVATE:INT64}"]
10 -> 12 [label = "t_17:{plain_int_0:PRIVATE:INT64}"]
10 -> 13 [label = "t_17:{plain_int_0:PRIVATE:INT64}"]
10 -> 15 [label = "t_17:{plain_int_0:PRIVATE:INT64}"]
11 -> 16 [label = "t_18:{Mul_out:PRIVATE:INT64}"]
12 -> 16 [label = "t_19:{Add_out:PRIVATE:INT64}"]
13 -> 16 [label = "t_20:{Minus_out:PRIVATE:INT64}"]
14 -> 15 [label = "t_21:{plain_int_0:PRIVATE:FLOAT64}"]
15 -> 16 [label = "t_22:{Div_out:PRIVATE:FLOAT64}"]
2 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_7:{plain_int_1:PRIVATE:INT64}"]
3 -> 7 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_7:{plain_int_1:PRIVATE:INT64}"]
4 -> 5 [label = "t_9:{plain_int_1:PRIVATE:INT64}"]
4 -> 9 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_9:{plain_int_1:PRIVATE:INT64}"]
5 -> 6 [label = "t_10:{plain_int_1:PRIVATE:INT64}"]
6 -> 7 [label = "t_11:{Greater_out:PRIVATE:BOOL}"]
6 -> 8 [label = "t_11:{Greater_out:PRIVATE:BOOL}"]
7 -> 11 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
7 -> 12 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
7 -> 13 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
7 -> 14 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
8 -> 9 [label = "t_14:{Greater_out:PRIVATE:BOOL}"]
9 -> 10 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.plain_int_0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0 where ta.plain_int_1 > tb.plain_int_1 and ta.compare_int_0 < tb.compare_int_0 and ta.compare_int_1 <> tb.compare_int_1 and ta.compare_int_2 >= tb.compare_int_2 and ta.compare_float_0 <= tb.compare_float_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,t_3,t_4,t_5,},],attr:[sql:select ta.compare_float_0,ta.compare_int_0,ta.compare_int_1,ta.compare_int_2,ta.plain_int_0,ta.plain_int_1 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_6,t_7,t_8,t_9,t_10,t_11,},],attr:[sql:select tb.compare_float_0,tb.compare_int_0,tb.compare_int_1,tb.compare_int_2,tb.plain_int_0,tb.plain_int_1 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_4,},Right:{t_10,},],out:[LeftJoinIndex:{t_12,},RightJoinIndex:{t_13,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,t_3,t_4,t_5,},RowsIndexFilter:{t_12,},],out:[Out:{t_14,t_15,t_16,t_17,t_18,t_19,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_6,t_7,t_8,t_9,t_10,t_11,},RowsIndexFilter:{t_13,},],out:[Out:{t_20,t_21,t_22,t_23,t_24,t_25,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_25,},],out:[Out:{t_26,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="Greater:{in:[Left:{t_19,},Right:{t_26,},],out:[Out:{t_27,},],attr:[],party:[alice,]}"]
7 [label="make_share:{in:[In:{t_15,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_21,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="Less:{in:[Left:{t_28,},Right:{t_29,},],out:[Out:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="make_share:{in:[In:{t_16,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_share:{in:[In:{t_22,},],out:[Out:{t_32,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="NotEqual:{in:[Left:{t_31,},Right:{t_32,},],out:[Out:{t_33,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_share:{in:[In:{t_17,},],out:[Out:{t_34,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_23,},],out:[Out:{t_35,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="GreaterEqual:{in:[Left:{t_34,},Right:{t_35,},],out:[Out:{t_36,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_share:{in:[In:{t_14,},],out:[Out:{t_37,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="make_share:{in:[In:{t_20,},],out:[Out:{t_38,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="LessEqual:{in:[Left:{t_37,},Right:{t_38,},],out:[Out:{t_39,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="make_private:{in:[In:{t_30,},],out:[Out:{t_40,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
20 [label="logical_and:{in:[Left:{t_27,},Right:{t_40,},],out:[Out:{t_41,},],attr:[],party:[alice,]}"]
21 [label="make_private:{in:[In:{t_33,},],out:[Out:{t_42,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
22 [label="logical_and:{in:[Left:{t_41,},Right:{t_42,},],out:[Out:{t_43,},],attr:[],party:[alice,]}"]
23 [label="make_private:{in:[In:{t_36,},],out:[Out:{t_44,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
24 [label="logical_and:{in:[Left:{t_43,},Right:{t_44,},],out:[Out:{t_45,},],attr:[],party:[alice,]}"]
25 [label="make_private:{in:[In:{t_39,},],out:[Out:{t_46,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
26 [label="logical_and:{in:[Left:{t_45,},Right:{t_46,},],out:[Out:{t_47,},],attr:[],party:[alice,]}"]
27 [label="apply_filter:{in:[Filter:{t_47,},In:{t_14,t_15,t_16,t_17,t_18,t_19,},],out:[Out:{t_48,t_49,t_50,t_51,t_52,t_53,},],attr:[],party:[alice,]}"]
28 [label="copy:{in:[In:{t_47,},],out:[Out:{t_54,},],attr:[input_party_codes:alice,output_party_codes:bob,],party:[alice,bob,]}"]
29 [label="apply_filter:{in:[Filter:{t_54,},In:{t_20,t_21,t_22,t_23,t_24,t_25,},],out:[Out:{t_55,t_56,t_57,t_58,t_59,t_60,},],attr:[],party:[bob,]}"]
30 [label="publish:{in:[In:{t_52,},],out:[Out:{t_61,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_float_0:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_1:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{compare_int_1:PRIVATE:INT64}"]
0 -> 3 [label = "t_3:{compare_int_2:PRIVATE:INT64}"]
0 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_5:{plain_int_1:PRIVATE:INT64}"]
1 -> 2 [label = "t_10:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_10:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_11:{plain_int_1:PRIVATE:INT64}"]
1 -> 4 [label = "t_6:{compare_float_0:PRIVATE:FLOAT32}"]
1 -> 4 [label = "t_7:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_8:{compare_int_1:PRIVATE:INT64}"]
1 -> 4 [label = "t_9:{compare_int_2:PRIVATE:INT64}"]
10 -> 12 [label = "t_31:{compare_int_1:SECRET:INT64}"]
11 -> 12 [label = "t_32:{compare_int_1:SECRET:INT64}"]
12 -> 21 [label = "t_33:{NotEqual_out:SECRET:BOOL}"]
13 -> 15 [label = "t_34:{compare_int_2:SECRET:INT64}"]
14 -> 15 [label = "t_35:{compare_int_2:SECRET:INT64}"]
15 -> 23 [label = "t_36:{GreaterEqual_out:SECRET:BOOL}"]
16 -> 18 [label = "t_37:{compare_float_0:SECRET:FLOAT32}"]
17 -> 18 [label = "t_38:{compare_float_0:SECRET:FLOAT32}"]
18 -> 25 [label = "t_39:{LessEqual_out:SECRET:BOOL}"]
19 -> 20 [label = "t_40:{Less_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
20 -> 22 [label = "t_41:{logical_and_out:PRIVATE:BOOL}"]
21 -> 22 [label = "t_42:{NotEqual_out:PRIVATE:BOOL}"]
22 -> 24 [label = "t_43:{logical_and_out:PRIVATE:BOOL}"]
23 -> 24 [label = "t_44:{GreaterEqual_out:PRIVATE:BOOL}"]
24 -> 26 [label = "t_45:{logical_and_out:PRIVATE:BOOL}"]
25 -> 26 [label = "t_46:{LessEqual_out:PRIVATE:BOOL}"]
26 -> 27 [label = "t_47:{logical_and_out:PRIVATE:BOOL}"]
26 -> 28 [label = "t_47:{logical_and_out:PRIVATE:BOOL}"]
27 -> 30 [label = "t_52:{plain_int_0:PRIVATE:INT64}"]
28 -> 29 [label = "t_54:{logical_and_out:PRIVATE:BOOL}"]
3 -> 10 [label = "t_16:{compare_int_1:PRIVATE:INT64}"]
3 -> 13 [label = "t_17:{compare_int_2:PRIVATE:INT64}"]
3 -> 16 [label = "t_14:{compare_float_0:PRIVATE:FLOAT32}"]
3 -> 27 [label = "t_14:{compare_float_0:PRIVATE:FLOAT32}"]
3 -> 27 [label = "t_15:{compare_int_0:PRIVATE:INT64}"]
3 -> 27 [label = "t_16:{compare_int_1:PRIVATE:INT64}"]
3 -> 27 [label = "t_17:{compare_int_2:PRIVATE:INT64}"]
3 -> 27 [label = "t_18:{plain_int_0:PRIVATE:INT64}"]
3 -> 27 [label = "t_19:{plain_int_1:PRIVATE:INT64}"]
3 -> 6 [label = "t_19:{plain_int_1:PRIVATE:INT64}"]
3 -> 7 [label = "t_15:{compare_int_0:PRIVATE:INT64}"]
4 -> 11 [label = "t_22:{compare_int_1:PRIVATE:INT64}"]
4 -> 14 [label = "t_23:{compare_int_2:PRIVATE:INT64}"]
4 -> 17 [label = "t_20:{compare_float_0:PRIVATE:FLOAT32}"]
4 -> 29 [label = "t_20:{compare_float_0:PRIVATE:FLOAT32}"]
4 -> 29 [label = "t_21:{compare_int_0:PRIVATE:INT64}"]
4 -> 29 [label = "t_22:{compare_int_1:PRIVATE:INT64}"]
4 -> 29 [label = "t_23:{compare_int_2:PRIVATE:INT64}"]
4 -> 29 [label = "t_24:{plain_int_0:PRIVATE:INT64}"]
4 -> 29 [label = "t_25:{plain_int_1:PRIVATE:INT64}"]
4 -> 5 [label = "t_25:{plain_int_1:PRIVATE:INT64}"]
4 -> 8 [label = "t_21:{compare_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_26:{plain_int_1:PRIVATE:INT64}"]
6 -> 20 [label = "t_27:{Greater_out:PRIVATE:BOOL}"]
7 -> 9 [label = "t_28:{compare_int_0:SECRET:INT64}"]
8 -> 9 [label = "t_29:{compare_int_0:SECRET:INT64}"]
9 -> 19 [label = "t_30:{Less_out:SECRET:BOOL}"]
}`, testConf{}},
	{`select ta.join_int_0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.join_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[bob,]}"]
5 [label="publish:{in:[In:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.join_int_0 + 1 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.join_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[bob,]}"]
5 [label="make_constant:{in:[],out:[Out:{t_6,},],attr:[scalar:1,to_status:1,],party:[alice,bob,carol,]}"]
6 [label="broadcast:{in:[In:{t_6,},ShapeRefTensor:{t_4,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
7 [label="Add:{in:[Left:{t_4,},Right:{t_7,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_6:{constant_data:PUBLIC:INT64}"]
6 -> 7 [label = "t_7:{constant_data:PRIVATE:INT64}"]
7 -> 8 [label = "t_8:{Add_out:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.join_int_0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0 where ta.compare_int_0 > tb.compare_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.compare_int_0,ta.join_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.compare_int_0,tb.join_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="Greater:{in:[Left:{t_10,},Right:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_private:{in:[In:{t_12,},],out:[Out:{t_13,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
9 [label="apply_filter:{in:[Filter:{t_13,},In:{t_6,t_7,},],out:[Out:{t_14,t_15,},],attr:[],party:[alice,]}"]
10 [label="make_private:{in:[In:{t_12,},],out:[Out:{t_16,},],attr:[reveal_to:bob,],party:[alice,bob,carol,]}"]
11 [label="apply_filter:{in:[Filter:{t_16,},In:{t_8,t_9,},],out:[Out:{t_17,t_18,},],attr:[],party:[bob,]}"]
12 [label="publish:{in:[In:{t_15,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_16:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
4 -> 11 [label = "t_8:{compare_int_0:PRIVATE:INT64}"]
4 -> 11 [label = "t_9:{join_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_8:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_10:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_11:{compare_int_0:SECRET:INT64}"]
7 -> 10 [label = "t_12:{Greater_out:SECRET:BOOL}"]
7 -> 8 [label = "t_12:{Greater_out:SECRET:BOOL}"]
8 -> 9 [label = "t_13:{Greater_out:PRIVATE:BOOL}"]
9 -> 12 [label = "t_15:{join_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.plain_int_0 in (1,2,3) from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[bob,]}"]
5 [label="make_constant:{in:[],out:[Out:{t_6,},],attr:[scalar:1,to_status:1,],party:[alice,bob,carol,]}"]
6 [label="broadcast:{in:[In:{t_6,},ShapeRefTensor:{t_4,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
7 [label="Equal:{in:[Left:{t_4,},Right:{t_7,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_9,},],attr:[scalar:2,to_status:1,],party:[alice,bob,carol,]}"]
9 [label="broadcast:{in:[In:{t_9,},ShapeRefTensor:{t_4,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
10 [label="Equal:{in:[Left:{t_4,},Right:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
11 [label="make_constant:{in:[],out:[Out:{t_12,},],attr:[scalar:3,to_status:1,],party:[alice,bob,carol,]}"]
12 [label="broadcast:{in:[In:{t_12,},ShapeRefTensor:{t_4,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
13 [label="Equal:{in:[Left:{t_4,},Right:{t_13,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
14 [label="LogicalOr:{in:[Left:{t_11,},Right:{t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
15 [label="LogicalOr:{in:[Left:{t_8,},Right:{t_15,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
16 [label="publish:{in:[In:{t_16,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
10 -> 14 [label = "t_11:{Equal_out:PRIVATE:BOOL}"]
11 -> 12 [label = "t_12:{constant_data:PUBLIC:INT64}"]
12 -> 13 [label = "t_13:{constant_data:PRIVATE:INT64}"]
13 -> 14 [label = "t_14:{Equal_out:PRIVATE:BOOL}"]
14 -> 15 [label = "t_15:{LogicalOr_out:PRIVATE:BOOL}"]
15 -> 16 [label = "t_16:{LogicalOr_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 10 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 12 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 13 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_6:{constant_data:PUBLIC:INT64}"]
6 -> 7 [label = "t_7:{constant_data:PRIVATE:INT64}"]
7 -> 15 [label = "t_8:{Equal_out:PRIVATE:BOOL}"]
8 -> 9 [label = "t_9:{constant_data:PUBLIC:INT64}"]
9 -> 10 [label = "t_10:{constant_data:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.plain_int_0 in (select tb.plain_int_0 from bob.tbl_0 as tb) from alice.tbl_0 as ta`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="psi_in:{in:[Left:{t_0,},Right:{t_1,},],out:[Out:{t_2,},],attr:[in_type:0,input_party_codes:[alice bob],psi_algorithm:0,reveal_to:[alice],],party:[alice,bob,]}"]
3 [label="publish:{in:[In:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{psi_in_out:PRIVATE:BOOL}"]
}`, testConf{}},
	{`select ta.compare_int_0 in (select tb.compare_int_0 from bob.tbl_0 as tb) from alice.tbl_0 as ta`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.compare_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.compare_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="psi_in:{in:[Left:{t_0,},Right:{t_1,},],out:[Out:{t_2,},],attr:[in_type:0,input_party_codes:[alice bob],psi_algorithm:0,reveal_to:[alice],],party:[alice,bob,]}"]
3 [label="publish:{in:[In:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{compare_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{psi_in_out:PRIVATE:BOOL}"]
}`, testConf{}},
	{`select ta.compare_int_0 from alice.tbl_0 as ta where ta.compare_int_0 in (select tb.compare_int_0 from bob.tbl_0 as tb)`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.compare_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.compare_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="psi_in:{in:[Left:{t_0,},Right:{t_1,},],out:[Out:{t_2,},],attr:[in_type:0,input_party_codes:[alice bob],psi_algorithm:0,reveal_to:[alice],],party:[alice,bob,]}"]
3 [label="apply_filter:{in:[Filter:{t_2,},In:{t_0,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="publish:{in:[In:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{compare_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{psi_in_out:PRIVATE:BOOL}"]
3 -> 4 [label = "t_3:{compare_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.compare_int_0 from alice.tbl_0 as ta where ta.compare_int_0 not in (select tb.compare_int_0 from bob.tbl_0 as tb)`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.compare_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.compare_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="psi_in:{in:[Left:{t_0,},Right:{t_1,},],out:[Out:{t_2,},],attr:[in_type:0,input_party_codes:[alice bob],psi_algorithm:0,reveal_to:[alice],],party:[alice,bob,]}"]
3 [label="not:{in:[In:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="apply_filter:{in:[Filter:{t_3,},In:{t_0,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
5 [label="publish:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 4 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{compare_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{psi_in_out:PRIVATE:BOOL}"]
3 -> 4 [label = "t_3:{psi_in_out:PRIVATE:BOOL}"]
4 -> 5 [label = "t_4:{compare_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select not(ta.plain_int_0 > tb.plain_int_0) from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="Greater:{in:[Left:{t_4,},Right:{t_6,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
7 [label="not:{in:[In:{t_7,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{Greater_out:PRIVATE:BOOL}"]
7 -> 8 [label = "t_8:{Greater_out:PRIVATE:BOOL}"]
}`, testConf{}},
	{`select not(ta.compare_int_0 > tb.compare_int_0) from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.compare_int_0,ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.compare_int_0,tb.plain_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="Greater:{in:[Left:{t_10,},Right:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="not:{in:[In:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_private:{in:[In:{t_13,},],out:[Out:{t_14,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
10 [label="publish:{in:[In:{t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_8:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_10:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_11:{compare_int_0:SECRET:INT64}"]
7 -> 8 [label = "t_12:{Greater_out:SECRET:BOOL}"]
8 -> 9 [label = "t_13:{Greater_out:SECRET:BOOL}"]
9 -> 10 [label = "t_14:{Greater_out:PRIVATE:BOOL}"]
}`, testConf{}},
	{`select (ta.compare_int_0 + tb.compare_int_0 - 3) > 0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.compare_int_0,ta.plain_int_0 from alice.tbl_0 as ta,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.compare_int_0,tb.plain_int_0 from bob.tbl_0 as tb,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="Add:{in:[Left:{t_10,},Right:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_13,},],attr:[scalar:3,to_status:1,],party:[alice,bob,carol,]}"]
9 [label="broadcast:{in:[In:{t_13,},ShapeRefTensor:{t_12,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="Minus:{in:[Left:{t_12,},Right:{t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_constant:{in:[],out:[Out:{t_16,},],attr:[scalar:0,to_status:1,],party:[alice,bob,carol,]}"]
12 [label="broadcast:{in:[In:{t_16,},ShapeRefTensor:{t_15,},],out:[Out:{t_17,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="Greater:{in:[Left:{t_15,},Right:{t_17,},],out:[Out:{t_18,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_private:{in:[In:{t_18,},],out:[Out:{t_19,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
15 [label="publish:{in:[In:{t_19,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
10 -> 12 [label = "t_15:{Minus_out:SECRET:INT64}"]
10 -> 13 [label = "t_15:{Minus_out:SECRET:INT64}"]
11 -> 12 [label = "t_16:{constant_data:PUBLIC:INT64}"]
12 -> 13 [label = "t_17:{constant_data:PUBLIC:INT64}"]
13 -> 14 [label = "t_18:{Greater_out:SECRET:BOOL}"]
14 -> 15 [label = "t_19:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_8:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_10:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_11:{compare_int_0:SECRET:INT64}"]
7 -> 10 [label = "t_12:{Add_out:SECRET:INT64}"]
7 -> 9 [label = "t_12:{Add_out:SECRET:INT64}"]
8 -> 9 [label = "t_13:{constant_data:PUBLIC:INT64}"]
9 -> 10 [label = "t_14:{constant_data:PUBLIC:INT64}"]
}`, testConf{}},
	{`select distinct groupby_int_0 from (select ta.groupby_int_0 from alice.tbl_0 as ta union all select tb.groupby_int_0 from bob.tbl_0 as tb) as tt`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(ta.groupby_int_0) as expr_183 from alice.tbl_0 as ta group by ta.groupby_int_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select any_value(tb.groupby_int_0) as expr_183 from bob.tbl_0 as tb group by tb.groupby_int_0,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_private:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
6 [label="group:{in:[Key:{t_5,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
7 [label="firstrow:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_5,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#183:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#183:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{Column#183:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#183:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#183:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#183:PRIVATE:INT64}"]
5 -> 7 [label = "t_5:{Column#183:PRIVATE:INT64}"]
6 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{group_num:PRIVATE:INT64}"]
7 -> 8 [label = "t_8:{Column#183_firstrow:PRIVATE:INT64}"]
}`, testConf{}},
	{`select ta.groupby_int_0 from alice.tbl_0 as ta union select tb.groupby_int_0 from bob.tbl_0 as tb`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(ta.groupby_int_0) as expr_183 from alice.tbl_0 as ta group by ta.groupby_int_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select any_value(tb.groupby_int_0) as expr_183 from bob.tbl_0 as tb group by tb.groupby_int_0,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_private:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
6 [label="group:{in:[Key:{t_5,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
7 [label="firstrow:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_5,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#183:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#183:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{Column#183:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#183:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#183:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#183:PRIVATE:INT64}"]
5 -> 7 [label = "t_5:{Column#183:PRIVATE:INT64}"]
6 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{group_num:PRIVATE:INT64}"]
7 -> 8 [label = "t_8:{Column#183_firstrow:PRIVATE:INT64}"]
}`, testConf{}},
	{`select plain_float_0 from (select plain_float_0 from alice.tbl_1 union all select plain_float_0 from alice.tbl_2) as tt group by plain_float_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(tt.expr_182) as plain_float_0 from ((select any_value(tbl_1.plain_float_0) as expr_182 from alice.tbl_1 group by tbl_1.plain_float_0) union all (select any_value(tbl_2.plain_float_0) as expr_182 from alice.tbl_2 group by tbl_2.plain_float_0)) as tt group by tt.expr_182,table_refs:[alice.tbl_1 alice.tbl_2],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{Column#181:PRIVATE:FLOAT32}"]
}`, testConf{}},
	{`select count(*), max(aggregate_int_0) from (select aggregate_int_0, groupby_int_0 from alice.tbl_0 union all select aggregate_int_0, groupby_int_0 from bob.tbl_1 union all select aggregate_int_0, groupby_int_0 from carol.tbl_2) as u`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select count(1) as expr_275,max(tbl_0.aggregate_int_0) as expr_276 from alice.tbl_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select count(1) as expr_275,max(tbl_1.aggregate_int_0) as expr_276 from bob.tbl_1,table_refs:[bob.tbl_1],],party:[bob,]}"]
2 [label="runsql:{in:[],out:[Out:{t_4,t_5,},],attr:[sql:select count(1) as expr_275,max(tbl_2.aggregate_int_0) as expr_276 from carol.tbl_2,table_refs:[carol.tbl_2],],party:[carol,]}"]
3 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_6,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="make_share:{in:[In:{t_2,},],out:[Out:{t_7,},],attr:[],party:[alice,bob,carol,]}"]
5 [label="make_share:{in:[In:{t_4,},],out:[Out:{t_8,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="concat:{in:[In:{t_6,t_7,t_8,},],out:[Out:{t_9,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_3,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_share:{in:[In:{t_5,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="concat:{in:[In:{t_10,t_11,t_12,},],out:[Out:{t_13,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
11 [label="reduce_sum:{in:[In:{t_9,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="reduce_max:{in:[In:{t_13,},],out:[Out:{t_15,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_private:{in:[In:{t_14,},],out:[Out:{t_16,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
14 [label="make_private:{in:[In:{t_15,},],out:[Out:{t_18,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
15 [label="publish:{in:[In:{t_16,t_18,},],out:[Out:{t_17,t_19,},],attr:[],party:[alice,]}"]
0 -> 3 [label = "t_0:{Column#275:PRIVATE:INT64}"]
0 -> 7 [label = "t_1:{Column#276:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{Column#275:PRIVATE:INT64}"]
1 -> 8 [label = "t_3:{Column#276:PRIVATE:INT64}"]
10 -> 12 [label = "t_13:{Column#276:SECRET:INT64}"]
11 -> 13 [label = "t_14:{Column#275:SECRET:INT64}"]
12 -> 14 [label = "t_15:{Column#276:SECRET:INT64}"]
13 -> 15 [label = "t_16:{Column#275:PRIVATE:INT64}"]
14 -> 15 [label = "t_18:{Column#276:PRIVATE:INT64}"]
2 -> 5 [label = "t_4:{Column#275:PRIVATE:INT64}"]
2 -> 9 [label = "t_5:{Column#276:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{Column#275:SECRET:INT64}"]
4 -> 6 [label = "t_7:{Column#275:SECRET:INT64}"]
5 -> 6 [label = "t_8:{Column#275:SECRET:INT64}"]
6 -> 11 [label = "t_9:{Column#275:SECRET:INT64}"]
7 -> 10 [label = "t_10:{Column#276:SECRET:INT64}"]
8 -> 10 [label = "t_11:{Column#276:SECRET:INT64}"]
9 -> 10 [label = "t_12:{Column#276:SECRET:INT64}"]
}`, testConf{}},
	{`select count(*), max(aggregate_int_0) from (select aggregate_int_0, groupby_int_0 from alice.tbl_0 union all select aggregate_int_0, groupby_int_0 from bob.tbl_1 union all select aggregate_int_0, groupby_int_0 from carol.tbl_2) as u group by groupby_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select count(1) as expr_275,max(tbl_0.aggregate_int_0) as expr_276,any_value(tbl_0.groupby_int_0) as expr_272 from alice.tbl_0 group by tbl_0.groupby_int_0,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,t_4,t_5,},],attr:[sql:select count(1) as expr_275,max(tbl_1.aggregate_int_0) as expr_276,any_value(tbl_1.groupby_int_0) as expr_272 from bob.tbl_1 group by tbl_1.groupby_int_0,table_refs:[bob.tbl_1],],party:[bob,]}"]
2 [label="runsql:{in:[],out:[Out:{t_6,t_7,t_8,},],attr:[sql:select count(1) as expr_275,max(tbl_2.aggregate_int_0) as expr_276,any_value(tbl_2.groupby_int_0) as expr_272 from carol.tbl_2 group by tbl_2.groupby_int_0,table_refs:[carol.tbl_2],],party:[carol,]}"]
3 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_9,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="make_share:{in:[In:{t_3,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="concat:{in:[In:{t_9,t_10,t_11,},],out:[Out:{t_12,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_4,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_15,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="concat:{in:[In:{t_13,t_14,t_15,},],out:[Out:{t_16,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
11 [label="make_share:{in:[In:{t_2,},],out:[Out:{t_17,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_5,},],out:[Out:{t_18,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_19,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="concat:{in:[In:{t_17,t_18,t_19,},],out:[Out:{t_20,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
15 [label="make_private:{in:[In:{t_20,},],out:[Out:{t_21,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
16 [label="group:{in:[Key:{t_21,},],out:[GroupId:{t_22,},GroupNum:{t_23,},],attr:[],party:[alice,]}"]
17 [label="make_private:{in:[In:{t_12,},],out:[Out:{t_24,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
18 [label="sum:{in:[GroupId:{t_22,},GroupNum:{t_23,},In:{t_24,},],out:[Out:{t_25,},],attr:[],party:[alice,]}"]
19 [label="make_private:{in:[In:{t_16,},],out:[Out:{t_26,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
20 [label="max:{in:[GroupId:{t_22,},GroupNum:{t_23,},In:{t_26,},],out:[Out:{t_27,},],attr:[],party:[alice,]}"]
21 [label="make_constant:{in:[],out:[Out:{t_28,},],attr:[scalar:4,to_status:1,],party:[alice,bob,carol,]}"]
22 [label="broadcast:{in:[In:{t_28,},ShapeRefTensor:{t_25,},],out:[Out:{t_29,},],attr:[],party:[alice,]}"]
23 [label="GreaterEqual:{in:[Left:{t_25,},Right:{t_29,},],out:[Out:{t_30,},],attr:[],party:[alice,]}"]
24 [label="apply_filter:{in:[Filter:{t_30,},In:{t_25,t_27,},],out:[Out:{t_31,t_32,},],attr:[],party:[alice,]}"]
25 [label="publish:{in:[In:{t_31,t_32,},],out:[Out:{t_33,t_34,},],attr:[],party:[alice,]}"]
0 -> 11 [label = "t_2:{Column#272:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{Column#275:PRIVATE:INT64}"]
0 -> 7 [label = "t_1:{Column#276:PRIVATE:INT64}"]
1 -> 12 [label = "t_5:{Column#272:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{Column#275:PRIVATE:INT64}"]
1 -> 8 [label = "t_4:{Column#276:PRIVATE:INT64}"]
10 -> 19 [label = "t_16:{Column#276:SECRET:INT64}"]
11 -> 14 [label = "t_17:{Column#272:SECRET:INT64}"]
12 -> 14 [label = "t_18:{Column#272:SECRET:INT64}"]
13 -> 14 [label = "t_19:{Column#272:SECRET:INT64}"]
14 -> 15 [label = "t_20:{Column#272:SECRET:INT64}"]
15 -> 16 [label = "t_21:{Column#272:PRIVATE:INT64}"]
16 -> 18 [label = "t_22:{group_id:PRIVATE:INT64}"]
16 -> 18 [label = "t_23:{group_num:PRIVATE:INT64}"]
16 -> 20 [label = "t_22:{group_id:PRIVATE:INT64}"]
16 -> 20 [label = "t_23:{group_num:PRIVATE:INT64}"]
17 -> 18 [label = "t_24:{Column#275:PRIVATE:INT64}"]
18 -> 22 [label = "t_25:{Column#275_sum:PRIVATE:INT64}"]
18 -> 23 [label = "t_25:{Column#275_sum:PRIVATE:INT64}"]
18 -> 24 [label = "t_25:{Column#275_sum:PRIVATE:INT64}"]
19 -> 20 [label = "t_26:{Column#276:PRIVATE:INT64}"]
2 -> 13 [label = "t_8:{Column#272:PRIVATE:INT64}"]
2 -> 5 [label = "t_6:{Column#275:PRIVATE:INT64}"]
2 -> 9 [label = "t_7:{Column#276:PRIVATE:INT64}"]
20 -> 24 [label = "t_27:{Column#276_max:PRIVATE:INT64}"]
21 -> 22 [label = "t_28:{constant_data:PUBLIC:INT64}"]
22 -> 23 [label = "t_29:{constant_data:PRIVATE:INT64}"]
23 -> 24 [label = "t_30:{GreaterEqual_out:PRIVATE:BOOL}"]
24 -> 25 [label = "t_31:{Column#275_sum:PRIVATE:INT64}"]
24 -> 25 [label = "t_32:{Column#276_max:PRIVATE:INT64}"]
3 -> 6 [label = "t_9:{Column#275:SECRET:INT64}"]
4 -> 6 [label = "t_10:{Column#275:SECRET:INT64}"]
5 -> 6 [label = "t_11:{Column#275:SECRET:INT64}"]
6 -> 17 [label = "t_12:{Column#275:SECRET:INT64}"]
7 -> 10 [label = "t_13:{Column#276:SECRET:INT64}"]
8 -> 10 [label = "t_14:{Column#276:SECRET:INT64}"]
9 -> 10 [label = "t_15:{Column#276:SECRET:INT64}"]
}`, testConf{}},
	{`select alice.plain_int_0 from alice.tbl_0 as alice join bob.tbl_0 as bob on alice.join_int_0 = bob.join_int_0 where alice.compare_int_0 Div bob.compare_int_0 > bob.compare_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select alice.compare_int_0,alice.join_int_0,alice.plain_int_0 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,t_4,},],attr:[sql:select bob.compare_int_0,bob.join_int_0 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_4,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{t_6,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,t_8,t_9,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,t_4,},RowsIndexFilter:{t_6,},],out:[Out:{t_10,t_11,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_10,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="IntDiv:{in:[Left:{t_12,},Right:{t_13,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="Greater:{in:[Left:{t_14,},Right:{t_13,},],out:[Out:{t_15,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_private:{in:[In:{t_15,},],out:[Out:{t_16,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
10 [label="apply_filter:{in:[Filter:{t_16,},In:{t_7,t_8,t_9,},],out:[Out:{t_17,t_18,t_19,},],attr:[],party:[alice,]}"]
11 [label="make_private:{in:[In:{t_15,},],out:[Out:{t_20,},],attr:[reveal_to:bob,],party:[alice,bob,carol,]}"]
12 [label="apply_filter:{in:[Filter:{t_20,},In:{t_10,t_11,},],out:[Out:{t_21,t_22,},],attr:[],party:[bob,]}"]
13 [label="publish:{in:[In:{t_19,},],out:[Out:{t_23,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
10 -> 13 [label = "t_19:{plain_int_0:PRIVATE:INT64}"]
11 -> 12 [label = "t_20:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
3 -> 10 [label = "t_7:{compare_int_0:PRIVATE:INT64}"]
3 -> 10 [label = "t_8:{join_int_0:PRIVATE:INT64}"]
3 -> 10 [label = "t_9:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_7:{compare_int_0:PRIVATE:INT64}"]
4 -> 12 [label = "t_10:{compare_int_0:PRIVATE:INT64}"]
4 -> 12 [label = "t_11:{join_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_10:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_12:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_13:{compare_int_0:SECRET:INT64}"]
6 -> 8 [label = "t_13:{compare_int_0:SECRET:INT64}"]
7 -> 8 [label = "t_14:{IntDiv_out:SECRET:INT64}"]
8 -> 11 [label = "t_15:{Greater_out:SECRET:BOOL}"]
8 -> 9 [label = "t_15:{Greater_out:SECRET:BOOL}"]
9 -> 10 [label = "t_16:{Greater_out:PRIVATE:BOOL}"]
}`, testConf{}},
	{`select alice.groupby_string_0,bob.groupby_string_0, count(*) as cnt from alice.tbl_0 as alice join bob.tbl_0 as bob where alice.join_int_0=bob.join_int_0 group by alice.groupby_string_0, bob.groupby_string_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.groupby_string_0,alice.join_int_0 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select bob.groupby_string_0,bob.join_int_0 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_9,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="sort:{in:[In:{t_10,t_11,t_10,t_12,t_11,t_13,},Key:{t_10,t_11,},],out:[Out:{t_14,t_15,t_16,t_17,t_18,t_19,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
10 [label="group_mark:{in:[Key:{t_14,t_15,},],out:[Group:{t_20,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="count:{in:[Group:{t_20,},In:{t_20,},],out:[Out:{t_21,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="shuffle:{in:[In:{t_21,t_16,t_18,t_20,},],out:[Out:{t_22,t_23,t_24,t_25,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_public:{in:[In:{t_25,},],out:[Out:{t_26,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="filter:{in:[Filter:{t_26,},In:{t_22,t_23,t_24,},],out:[Out:{t_27,t_28,t_29,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="make_constant:{in:[],out:[Out:{t_30,},],attr:[scalar:4,to_status:1,],party:[alice,bob,carol,]}"]
16 [label="broadcast:{in:[In:{t_30,},ShapeRefTensor:{t_27,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="make_private:{in:[In:{t_27,},],out:[Out:{t_32,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
18 [label="make_private:{in:[In:{t_31,},],out:[Out:{t_33,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
19 [label="GreaterEqual:{in:[Left:{t_32,},Right:{t_33,},],out:[Out:{t_34,},],attr:[],party:[alice,]}"]
20 [label="make_public:{in:[In:{t_34,},],out:[Out:{t_35,},],attr:[],party:[alice,bob,carol,]}"]
21 [label="apply_filter:{in:[Filter:{t_35,},In:{t_28,t_29,t_27,},],out:[Out:{t_36,t_37,t_38,},],attr:[],party:[alice,bob,carol,]}"]
22 [label="make_private:{in:[In:{t_36,},],out:[Out:{t_39,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
23 [label="make_private:{in:[In:{t_37,},],out:[Out:{t_41,},],attr:[reveal_to:bob,],party:[alice,bob,carol,]}"]
24 [label="copy:{in:[In:{t_41,},],out:[Out:{t_42,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
25 [label="make_private:{in:[In:{t_38,},],out:[Out:{t_44,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
26 [label="publish:{in:[In:{t_39,t_42,t_44,},],out:[Out:{t_40,t_43,t_45,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{groupby_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{groupby_string_0:PRIVATE:STRING}"]
1 -> 4 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_20:{group_mark:SECRET:BOOL}"]
10 -> 11 [label = "t_20:{group_mark:SECRET:BOOL}"]
10 -> 12 [label = "t_20:{group_mark:SECRET:BOOL}"]
11 -> 12 [label = "t_21:{group_mark:SECRET:INT64}"]
12 -> 13 [label = "t_25:{group_mark:SECRET:BOOL}"]
12 -> 14 [label = "t_22:{group_mark:SECRET:INT64}"]
12 -> 14 [label = "t_23:{groupby_string_0:SECRET:STRING}"]
12 -> 14 [label = "t_24:{groupby_string_0:SECRET:STRING}"]
13 -> 14 [label = "t_26:{group_mark:PUBLIC:BOOL}"]
14 -> 16 [label = "t_27:{group_mark:SECRET:INT64}"]
14 -> 17 [label = "t_27:{group_mark:SECRET:INT64}"]
14 -> 21 [label = "t_27:{group_mark:SECRET:INT64}"]
14 -> 21 [label = "t_28:{groupby_string_0:SECRET:STRING}"]
14 -> 21 [label = "t_29:{groupby_string_0:SECRET:STRING}"]
15 -> 16 [label = "t_30:{constant_data:PUBLIC:INT64}"]
16 -> 18 [label = "t_31:{constant_data:PUBLIC:INT64}"]
17 -> 19 [label = "t_32:{group_mark:PRIVATE:INT64}"]
18 -> 19 [label = "t_33:{constant_data:PRIVATE:INT64}"]
19 -> 20 [label = "t_34:{GreaterEqual_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
20 -> 21 [label = "t_35:{GreaterEqual_out:PUBLIC:BOOL}"]
21 -> 22 [label = "t_36:{groupby_string_0:SECRET:STRING}"]
21 -> 23 [label = "t_37:{groupby_string_0:SECRET:STRING}"]
21 -> 25 [label = "t_38:{group_mark:SECRET:INT64}"]
22 -> 26 [label = "t_39:{groupby_string_0:PRIVATE:STRING}"]
23 -> 24 [label = "t_41:{groupby_string_0:PRIVATE:STRING}"]
24 -> 26 [label = "t_42:{groupby_string_0:PRIVATE:STRING}"]
25 -> 26 [label = "t_44:{group_mark:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{groupby_string_0:PRIVATE:STRING}"]
3 -> 7 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_8:{groupby_string_0:PRIVATE:STRING}"]
4 -> 8 [label = "t_9:{join_int_0:PRIVATE:INT64}"]
5 -> 9 [label = "t_10:{groupby_string_0:SECRET:STRING}"]
5 -> 9 [label = "t_10:{groupby_string_0:SECRET:STRING}"]
5 -> 9 [label = "t_10:{groupby_string_0:SECRET:STRING}"]
6 -> 9 [label = "t_11:{groupby_string_0:SECRET:STRING}"]
6 -> 9 [label = "t_11:{groupby_string_0:SECRET:STRING}"]
6 -> 9 [label = "t_11:{groupby_string_0:SECRET:STRING}"]
7 -> 9 [label = "t_12:{join_int_0:SECRET:INT64}"]
8 -> 9 [label = "t_13:{join_int_0:SECRET:INT64}"]
9 -> 10 [label = "t_14:{groupby_string_0:SECRET:STRING}"]
9 -> 10 [label = "t_15:{groupby_string_0:SECRET:STRING}"]
9 -> 12 [label = "t_16:{groupby_string_0:SECRET:STRING}"]
9 -> 12 [label = "t_18:{groupby_string_0:SECRET:STRING}"]
}`, testConf{}},
	{`select case when alice.compare_int_0 > bob.compare_int_0 then alice.plain_int_0 else bob.plain_int_0 end as case_when1, case when bob.compare_int_0 > carol.compare_int_0 then 1 else 0 end as case_when2 from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.join_int_0 = bob.join_int_0 and bob.join_int_0 = carol.join_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select alice.compare_int_0,alice.join_int_0,alice.plain_int_0 from alice.tbl_0 as alice,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,t_4,t_5,},],attr:[sql:select bob.compare_int_0,bob.join_int_0,bob.plain_int_0 from bob.tbl_0 as bob,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_4,},],out:[LeftJoinIndex:{t_6,},RightJoinIndex:{t_7,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,t_9,t_10,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,t_4,t_5,},RowsIndexFilter:{t_7,},],out:[Out:{t_11,t_12,t_13,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_14,t_15,},],attr:[sql:select carol.compare_int_0,carol.join_int_0 from carol.tbl_0 as carol,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_12,},Right:{t_15,},],out:[LeftJoinIndex:{t_16,},RightJoinIndex:{t_17,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_16,},],out:[Out:{t_18,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_8,t_9,t_10,},RowsIndexFilter:{t_18,},],out:[Out:{t_19,t_20,t_21,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_11,t_12,t_13,},RowsIndexFilter:{t_16,},],out:[Out:{t_22,t_23,t_24,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_14,t_15,},RowsIndexFilter:{t_17,},],out:[Out:{t_25,t_26,},],attr:[],party:[carol,]}"]
11 [label="make_share:{in:[In:{t_19,},],out:[Out:{t_27,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_22,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="Greater:{in:[Left:{t_27,},Right:{t_28,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_private:{in:[In:{t_29,},],out:[Out:{t_31,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
15 [label="copy:{in:[In:{t_24,},],out:[Out:{t_32,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
16 [label="CaseWhen:{in:[Condition:{t_31,},Value:{t_21,},ValueElse:{t_32,},],out:[Out:{t_30,},],attr:[],party:[alice,]}"]
17 [label="make_share:{in:[In:{t_25,},],out:[Out:{t_33,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="Greater:{in:[Left:{t_28,},Right:{t_33,},],out:[Out:{t_34,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="make_constant:{in:[],out:[Out:{t_35,},],attr:[scalar:1,to_status:1,],party:[alice,bob,carol,]}"]
20 [label="make_constant:{in:[],out:[Out:{t_36,},],attr:[scalar:0,to_status:1,],party:[alice,bob,carol,]}"]
21 [label="broadcast:{in:[In:{t_35,t_36,},ShapeRefTensor:{t_34,},],out:[Out:{t_37,t_38,},],attr:[],party:[alice,bob,carol,]}"]
22 [label="make_private:{in:[In:{t_34,},],out:[Out:{t_40,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
23 [label="make_private:{in:[In:{t_37,},],out:[Out:{t_41,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
24 [label="make_private:{in:[In:{t_38,},],out:[Out:{t_42,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
25 [label="CaseWhen:{in:[Condition:{t_40,},Value:{t_41,},ValueElse:{t_42,},],out:[Out:{t_39,},],attr:[],party:[alice,]}"]
26 [label="publish:{in:[In:{t_30,t_39,},],out:[Out:{t_43,t_44,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
10 -> 17 [label = "t_25:{compare_int_0:PRIVATE:INT64}"]
11 -> 13 [label = "t_27:{compare_int_0:SECRET:INT64}"]
12 -> 13 [label = "t_28:{compare_int_0:SECRET:INT64}"]
12 -> 18 [label = "t_28:{compare_int_0:SECRET:INT64}"]
13 -> 14 [label = "t_29:{Greater_out:SECRET:BOOL}"]
14 -> 16 [label = "t_31:{Greater_out:PRIVATE:BOOL}"]
15 -> 16 [label = "t_32:{plain_int_0:PRIVATE:INT64}"]
16 -> 26 [label = "t_30:{plain_int_0:PRIVATE:INT64}"]
17 -> 18 [label = "t_33:{compare_int_0:SECRET:INT64}"]
18 -> 21 [label = "t_34:{Greater_out:SECRET:BOOL}"]
18 -> 22 [label = "t_34:{Greater_out:SECRET:BOOL}"]
19 -> 21 [label = "t_35:{constant_data:PUBLIC:INT64}"]
2 -> 3 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
20 -> 21 [label = "t_36:{constant_data:PUBLIC:INT64}"]
21 -> 23 [label = "t_37:{constant_data:PUBLIC:INT64}"]
21 -> 24 [label = "t_38:{constant_data:PUBLIC:INT64}"]
22 -> 25 [label = "t_40:{Greater_out:PRIVATE:BOOL}"]
23 -> 25 [label = "t_41:{constant_data:PRIVATE:INT64}"]
24 -> 25 [label = "t_42:{constant_data:PRIVATE:INT64}"]
25 -> 26 [label = "t_39:{constant_data:PRIVATE:INT64}"]
3 -> 8 [label = "t_10:{plain_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_8:{compare_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_9:{join_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_12:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_11:{compare_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_12:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_14:{compare_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_15:{join_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_15:{join_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_17:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_18:{join_int_0:PRIVATE:INT64}"]
8 -> 11 [label = "t_19:{compare_int_0:PRIVATE:INT64}"]
8 -> 16 [label = "t_21:{plain_int_0:PRIVATE:INT64}"]
9 -> 12 [label = "t_22:{compare_int_0:PRIVATE:INT64}"]
9 -> 15 [label = "t_24:{plain_int_0:PRIVATE:INT64}"]
}`, testConf{}},
	{`select alice.groupby_int_0, alice.GROUPBY_int_1, bob.join_string_0, bob.JOIN_STRING_0, carol.COMPARE_float_0 > 0, carol.compare_float_1 > 0 from alice.UPPER_table as alice, bob.UPPER_table as bob, carol.UPPER_table as carol where alice.join_string_0 = bob.JOIN_string_0 and bob.join_string_1 = carol.JOIN_string_1;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select alice.GROUPBY_int_0,alice.JOIN_string_0,alice.groupby_int_1 from alice.UPPER_table as alice,table_refs:[alice.UPPER_table],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,t_4,},],attr:[sql:select bob.JOIN_string_0,bob.join_string_1 from bob.UPPER_table as bob,table_refs:[bob.UPPER_table],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{t_6,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,t_8,t_9,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,t_4,},RowsIndexFilter:{t_6,},],out:[Out:{t_10,t_11,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_12,t_13,t_14,},],attr:[sql:select carol.COMPARE_float_0,carol.compare_float_1,carol.join_string_1 from carol.UPPER_table as carol,table_refs:[carol.UPPER_table],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_11,},Right:{t_14,},],out:[LeftJoinIndex:{t_15,},RightJoinIndex:{t_16,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_15,},],out:[Out:{t_17,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_7,t_8,t_9,},RowsIndexFilter:{t_17,},],out:[Out:{t_18,t_19,t_20,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_10,t_11,},RowsIndexFilter:{t_15,},],out:[Out:{t_21,t_22,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_12,t_13,t_14,},RowsIndexFilter:{t_16,},],out:[Out:{t_23,t_24,t_25,},],attr:[],party:[carol,]}"]
11 [label="make_constant:{in:[],out:[Out:{t_26,},],attr:[scalar:0,to_status:1,],party:[alice,bob,carol,]}"]
12 [label="broadcast:{in:[In:{t_26,},ShapeRefTensor:{t_23,},],out:[Out:{t_27,},],attr:[],party:[carol,]}"]
13 [label="Greater:{in:[Left:{t_23,},Right:{t_27,},],out:[Out:{t_28,},],attr:[],party:[carol,]}"]
14 [label="make_constant:{in:[],out:[Out:{t_29,},],attr:[scalar:0,to_status:1,],party:[alice,bob,carol,]}"]
15 [label="broadcast:{in:[In:{t_29,},ShapeRefTensor:{t_24,},],out:[Out:{t_30,},],attr:[],party:[carol,]}"]
16 [label="Greater:{in:[Left:{t_24,},Right:{t_30,},],out:[Out:{t_31,},],attr:[],party:[carol,]}"]
17 [label="copy:{in:[In:{t_21,},],out:[Out:{t_34,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
18 [label="copy:{in:[In:{t_28,},],out:[Out:{t_37,},],attr:[input_party_codes:carol,output_party_codes:alice,],party:[carol,alice,]}"]
19 [label="copy:{in:[In:{t_31,},],out:[Out:{t_39,},],attr:[input_party_codes:carol,output_party_codes:alice,],party:[carol,alice,]}"]
20 [label="publish:{in:[In:{t_18,t_20,t_34,t_34,t_37,t_39,},],out:[Out:{t_32,t_33,t_35,t_36,t_38,t_40,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{JOIN_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_0:{GROUPBY_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{JOIN_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_2:{groupby_int_1:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{JOIN_string_0:PRIVATE:STRING}"]
1 -> 4 [label = "t_3:{JOIN_string_0:PRIVATE:STRING}"]
1 -> 4 [label = "t_4:{join_string_1:PRIVATE:STRING}"]
10 -> 12 [label = "t_23:{COMPARE_float_0:PRIVATE:FLOAT32}"]
10 -> 13 [label = "t_23:{COMPARE_float_0:PRIVATE:FLOAT32}"]
10 -> 15 [label = "t_24:{compare_float_1:PRIVATE:FLOAT32}"]
10 -> 16 [label = "t_24:{compare_float_1:PRIVATE:FLOAT32}"]
11 -> 12 [label = "t_26:{constant_data:PUBLIC:INT64}"]
12 -> 13 [label = "t_27:{constant_data:PRIVATE:INT64}"]
13 -> 18 [label = "t_28:{Greater_out:PRIVATE:BOOL}"]
14 -> 15 [label = "t_29:{constant_data:PUBLIC:INT64}"]
15 -> 16 [label = "t_30:{constant_data:PRIVATE:INT64}"]
16 -> 19 [label = "t_31:{Greater_out:PRIVATE:BOOL}"]
17 -> 20 [label = "t_34:{JOIN_string_0:PRIVATE:STRING}"]
17 -> 20 [label = "t_34:{JOIN_string_0:PRIVATE:STRING}"]
18 -> 20 [label = "t_37:{Greater_out:PRIVATE:BOOL}"]
19 -> 20 [label = "t_39:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_5:{JOIN_string_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{JOIN_string_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_7:{GROUPBY_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_8:{JOIN_string_0:PRIVATE:STRING}"]
3 -> 8 [label = "t_9:{groupby_int_1:PRIVATE:INT64}"]
4 -> 6 [label = "t_11:{join_string_1:PRIVATE:STRING}"]
4 -> 9 [label = "t_10:{JOIN_string_0:PRIVATE:STRING}"]
4 -> 9 [label = "t_11:{join_string_1:PRIVATE:STRING}"]
5 -> 10 [label = "t_12:{COMPARE_float_0:PRIVATE:FLOAT32}"]
5 -> 10 [label = "t_13:{compare_float_1:PRIVATE:FLOAT32}"]
5 -> 10 [label = "t_14:{join_string_1:PRIVATE:STRING}"]
5 -> 6 [label = "t_14:{join_string_1:PRIVATE:STRING}"]
6 -> 10 [label = "t_16:{join_string_1:PRIVATE:INT64}"]
6 -> 7 [label = "t_15:{join_string_1:PRIVATE:INT64}"]
6 -> 9 [label = "t_15:{join_string_1:PRIVATE:INT64}"]
7 -> 8 [label = "t_17:{join_string_1:PRIVATE:INT64}"]
8 -> 20 [label = "t_18:{GROUPBY_int_0:PRIVATE:INT64}"]
8 -> 20 [label = "t_20:{groupby_int_1:PRIVATE:INT64}"]
9 -> 17 [label = "t_21:{JOIN_string_0:PRIVATE:STRING}"]
}`, testConf{}},
	{`select sum(l_extendedprice*l_discount) as revenue from ((select l_extendedprice, l_discount, l_shipdate, l_quantity from alice.lineitem limit 500) union all (select l_extendedprice, l_discount, l_shipdate, l_quantity from bob.lineitem limit 500)) as lineitem where l_shipdate >= STR_TO_DATE('1995-02-06','%Y-%m-%d') and l_shipdate < ADDDATE(STR_TO_DATE('1995-01-01','%Y-%m-%d'), interval 1 year) and l_discount >= 0.05 - 0.01 and l_discount <= 0.05 + 0.01 and l_quantity < 60;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select sum(t_0.l_extendedprice*t_0.l_discount) as expr_28 from (select lineitem.l_discount,lineitem.l_extendedprice,lineitem.l_quantity,lineitem.l_shipdate from alice.lineitem where ((((lineitem.l_shipdate>=str_to_date('1995-02-06', '%Y-%m-%d')) and (lineitem.l_shipdate<adddate(str_to_date('1995-01-01', '%Y-%m-%d'), interval 1 YEAR))) and (lineitem.l_discount>=0.05-0.01)) and (lineitem.l_discount<=0.05+0.01)) and (lineitem.l_quantity<60) limit 500) as t_0,table_refs:[alice.lineitem],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select sum(t_0.l_extendedprice*t_0.l_discount) as expr_28 from (select lineitem.l_discount,lineitem.l_extendedprice,lineitem.l_quantity,lineitem.l_shipdate from bob.lineitem where ((((lineitem.l_shipdate>=str_to_date('1995-02-06', '%Y-%m-%d')) and (lineitem.l_shipdate<adddate(str_to_date('1995-01-01', '%Y-%m-%d'), interval 1 YEAR))) and (lineitem.l_discount>=0.05-0.01)) and (lineitem.l_discount<=0.05+0.01)) and (lineitem.l_quantity<60) limit 500) as t_0,table_refs:[bob.lineitem],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="reduce_sum:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_private:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
7 [label="publish:{in:[In:{t_6,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#28:PRIVATE:FLOAT64}"]
1 -> 3 [label = "t_1:{Column#28:PRIVATE:FLOAT64}"]
2 -> 4 [label = "t_2:{Column#28:SECRET:FLOAT64}"]
3 -> 4 [label = "t_3:{Column#28:SECRET:FLOAT64}"]
4 -> 5 [label = "t_4:{Column#28:SECRET:FLOAT64}"]
5 -> 6 [label = "t_5:{Column#28:SECRET:FLOAT64}"]
6 -> 7 [label = "t_6:{Column#28:PRIVATE:FLOAT64}"]
}`, testConf{groupThreshold: 1}},
	{`select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, sum(l_quantity)/count(*) as avg_qty, sum(l_extendedprice)/count(*) as avg_price, sum(l_discount)/count(*) as avg_disc, count(*) as count_order from ((select l_returnflag, l_linestatus, l_quantity, l_extendedprice, l_shipdate, l_discount, l_tax from alice.lineitem limit 500) union all (select l_returnflag, l_linestatus, l_quantity, l_extendedprice, l_shipdate, l_discount, l_tax from bob.lineitem limit 500)) as lineitem where l_shipdate <= DATE_SUB(STR_TO_DATE('1996-01-01','%Y-%m-%d'), INTERVAL 37 DAY) group by l_returnflag, l_linestatus`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,t_3,t_4,t_5,t_6,t_7,},],attr:[sql:select sum(t_0.l_quantity) as expr_39,sum(t_0.l_extendedprice) as expr_40,sum(t_0.l_extendedprice*(1-t_0.l_discount)) as expr_41,sum(t_0.l_extendedprice*(1-t_0.l_discount)*(1+t_0.l_tax)) as expr_42,count(1) as expr_43,sum(t_0.l_discount) as expr_44,any_value(t_0.l_returnflag) as expr_45,any_value(t_0.l_linestatus) as expr_46 from (select lineitem.l_discount,lineitem.l_extendedprice,lineitem.l_linestatus,lineitem.l_quantity,lineitem.l_returnflag,lineitem.l_shipdate,lineitem.l_tax from alice.lineitem where lineitem.l_shipdate<=date_sub(str_to_date('1996-01-01', '%Y-%m-%d'), interval 37 'DAY') limit 500) as t_0 group by t_0.l_returnflag,t_0.l_linestatus,table_refs:[alice.lineitem],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_8,t_9,t_10,t_11,t_12,t_13,t_14,t_15,},],attr:[sql:select sum(t_0.l_quantity) as expr_39,sum(t_0.l_extendedprice) as expr_40,sum(t_0.l_extendedprice*(1-t_0.l_discount)) as expr_41,sum(t_0.l_extendedprice*(1-t_0.l_discount)*(1+t_0.l_tax)) as expr_42,count(1) as expr_43,sum(t_0.l_discount) as expr_44,any_value(t_0.l_returnflag) as expr_45,any_value(t_0.l_linestatus) as expr_46 from (select lineitem.l_discount,lineitem.l_extendedprice,lineitem.l_linestatus,lineitem.l_quantity,lineitem.l_returnflag,lineitem.l_shipdate,lineitem.l_tax from bob.lineitem where lineitem.l_shipdate<=date_sub(str_to_date('1996-01-01', '%Y-%m-%d'), interval 37 'DAY') limit 500) as t_0 group by t_0.l_returnflag,t_0.l_linestatus,table_refs:[bob.lineitem],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_16,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_17,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_16,t_17,},],out:[Out:{t_18,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_19,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_9,},],out:[Out:{t_20,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="concat:{in:[In:{t_19,t_20,},],out:[Out:{t_21,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_2,},],out:[Out:{t_22,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_share:{in:[In:{t_10,},],out:[Out:{t_23,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="concat:{in:[In:{t_22,t_23,},],out:[Out:{t_24,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
11 [label="make_share:{in:[In:{t_3,},],out:[Out:{t_25,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_11,},],out:[Out:{t_26,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="concat:{in:[In:{t_25,t_26,},],out:[Out:{t_27,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_4,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="make_share:{in:[In:{t_12,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="concat:{in:[In:{t_28,t_29,},],out:[Out:{t_30,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
17 [label="make_share:{in:[In:{t_5,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="make_share:{in:[In:{t_13,},],out:[Out:{t_32,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="concat:{in:[In:{t_31,t_32,},],out:[Out:{t_33,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
20 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_34,},],attr:[],party:[alice,bob,carol,]}"]
21 [label="make_share:{in:[In:{t_14,},],out:[Out:{t_35,},],attr:[],party:[alice,bob,carol,]}"]
22 [label="concat:{in:[In:{t_34,t_35,},],out:[Out:{t_36,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
23 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_37,},],attr:[],party:[alice,bob,carol,]}"]
24 [label="make_share:{in:[In:{t_15,},],out:[Out:{t_38,},],attr:[],party:[alice,bob,carol,]}"]
25 [label="concat:{in:[In:{t_37,t_38,},],out:[Out:{t_39,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
26 [label="make_public:{in:[In:{t_36,},],out:[Out:{t_40,},],attr:[],party:[alice,bob,carol,]}"]
27 [label="make_private:{in:[In:{t_40,},],out:[Out:{t_41,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
28 [label="make_public:{in:[In:{t_39,},],out:[Out:{t_42,},],attr:[],party:[alice,bob,carol,]}"]
29 [label="make_private:{in:[In:{t_42,},],out:[Out:{t_43,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
30 [label="group:{in:[Key:{t_41,t_43,},],out:[GroupId:{t_44,},GroupNum:{t_45,},],attr:[],party:[alice,]}"]
31 [label="make_private:{in:[In:{t_18,},],out:[Out:{t_46,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
32 [label="sum:{in:[GroupId:{t_44,},GroupNum:{t_45,},In:{t_46,},],out:[Out:{t_47,},],attr:[],party:[alice,]}"]
33 [label="make_private:{in:[In:{t_21,},],out:[Out:{t_48,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
34 [label="sum:{in:[GroupId:{t_44,},GroupNum:{t_45,},In:{t_48,},],out:[Out:{t_49,},],attr:[],party:[alice,]}"]
35 [label="make_private:{in:[In:{t_24,},],out:[Out:{t_50,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
36 [label="sum:{in:[GroupId:{t_44,},GroupNum:{t_45,},In:{t_50,},],out:[Out:{t_51,},],attr:[],party:[alice,]}"]
37 [label="make_private:{in:[In:{t_27,},],out:[Out:{t_52,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
38 [label="sum:{in:[GroupId:{t_44,},GroupNum:{t_45,},In:{t_52,},],out:[Out:{t_53,},],attr:[],party:[alice,]}"]
39 [label="make_private:{in:[In:{t_30,},],out:[Out:{t_54,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
40 [label="sum:{in:[GroupId:{t_44,},GroupNum:{t_45,},In:{t_54,},],out:[Out:{t_55,},],attr:[],party:[alice,]}"]
41 [label="make_private:{in:[In:{t_33,},],out:[Out:{t_56,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
42 [label="sum:{in:[GroupId:{t_44,},GroupNum:{t_45,},In:{t_56,},],out:[Out:{t_57,},],attr:[],party:[alice,]}"]
43 [label="firstrow:{in:[GroupId:{t_44,},GroupNum:{t_45,},In:{t_41,},],out:[Out:{t_58,},],attr:[],party:[alice,]}"]
44 [label="firstrow:{in:[GroupId:{t_44,},GroupNum:{t_45,},In:{t_43,},],out:[Out:{t_59,},],attr:[],party:[alice,]}"]
45 [label="Div:{in:[Left:{t_47,},Right:{t_55,},],out:[Out:{t_60,},],attr:[],party:[alice,]}"]
46 [label="Div:{in:[Left:{t_49,},Right:{t_55,},],out:[Out:{t_61,},],attr:[],party:[alice,]}"]
47 [label="Div:{in:[Left:{t_57,},Right:{t_55,},],out:[Out:{t_62,},],attr:[],party:[alice,]}"]
48 [label="publish:{in:[In:{t_58,t_59,t_47,t_49,t_51,t_53,t_60,t_61,t_62,t_55,},],out:[Out:{t_63,t_64,t_65,t_66,t_67,t_68,t_69,t_70,t_71,t_72,},],attr:[],party:[alice,]}"]
0 -> 11 [label = "t_3:{Column#42:PRIVATE:FLOAT64}"]
0 -> 14 [label = "t_4:{Column#43:PRIVATE:INT64}"]
0 -> 17 [label = "t_5:{Column#44:PRIVATE:FLOAT64}"]
0 -> 2 [label = "t_0:{Column#39:PRIVATE:FLOAT64}"]
0 -> 20 [label = "t_6:{Column#45:PRIVATE:STRING}"]
0 -> 23 [label = "t_7:{Column#46:PRIVATE:STRING}"]
0 -> 5 [label = "t_1:{Column#40:PRIVATE:FLOAT64}"]
0 -> 8 [label = "t_2:{Column#41:PRIVATE:FLOAT64}"]
1 -> 12 [label = "t_11:{Column#42:PRIVATE:FLOAT64}"]
1 -> 15 [label = "t_12:{Column#43:PRIVATE:INT64}"]
1 -> 18 [label = "t_13:{Column#44:PRIVATE:FLOAT64}"]
1 -> 21 [label = "t_14:{Column#45:PRIVATE:STRING}"]
1 -> 24 [label = "t_15:{Column#46:PRIVATE:STRING}"]
1 -> 3 [label = "t_8:{Column#39:PRIVATE:FLOAT64}"]
1 -> 6 [label = "t_9:{Column#40:PRIVATE:FLOAT64}"]
1 -> 9 [label = "t_10:{Column#41:PRIVATE:FLOAT64}"]
10 -> 35 [label = "t_24:{Column#41:SECRET:FLOAT64}"]
11 -> 13 [label = "t_25:{Column#42:SECRET:FLOAT64}"]
12 -> 13 [label = "t_26:{Column#42:SECRET:FLOAT64}"]
13 -> 37 [label = "t_27:{Column#42:SECRET:FLOAT64}"]
14 -> 16 [label = "t_28:{Column#43:SECRET:INT64}"]
15 -> 16 [label = "t_29:{Column#43:SECRET:INT64}"]
16 -> 39 [label = "t_30:{Column#43:SECRET:INT64}"]
17 -> 19 [label = "t_31:{Column#44:SECRET:FLOAT64}"]
18 -> 19 [label = "t_32:{Column#44:SECRET:FLOAT64}"]
19 -> 41 [label = "t_33:{Column#44:SECRET:FLOAT64}"]
2 -> 4 [label = "t_16:{Column#39:SECRET:FLOAT64}"]
20 -> 22 [label = "t_34:{Column#45:SECRET:STRING}"]
21 -> 22 [label = "t_35:{Column#45:SECRET:STRING}"]
22 -> 26 [label = "t_36:{Column#45:SECRET:STRING}"]
23 -> 25 [label = "t_37:{Column#46:SECRET:STRING}"]
24 -> 25 [label = "t_38:{Column#46:SECRET:STRING}"]
25 -> 28 [label = "t_39:{Column#46:SECRET:STRING}"]
26 -> 27 [label = "t_40:{Column#45:PUBLIC:STRING}"]
27 -> 30 [label = "t_41:{Column#45:PRIVATE:STRING}"]
27 -> 43 [label = "t_41:{Column#45:PRIVATE:STRING}"]
28 -> 29 [label = "t_42:{Column#46:PUBLIC:STRING}"]
29 -> 30 [label = "t_43:{Column#46:PRIVATE:STRING}"]
29 -> 44 [label = "t_43:{Column#46:PRIVATE:STRING}"]
3 -> 4 [label = "t_17:{Column#39:SECRET:FLOAT64}"]
30 -> 32 [label = "t_44:{group_id:PRIVATE:INT64}"]
30 -> 32 [label = "t_45:{group_num:PRIVATE:INT64}"]
30 -> 34 [label = "t_44:{group_id:PRIVATE:INT64}"]
30 -> 34 [label = "t_45:{group_num:PRIVATE:INT64}"]
30 -> 36 [label = "t_44:{group_id:PRIVATE:INT64}"]
30 -> 36 [label = "t_45:{group_num:PRIVATE:INT64}"]
30 -> 38 [label = "t_44:{group_id:PRIVATE:INT64}"]
30 -> 38 [label = "t_45:{group_num:PRIVATE:INT64}"]
30 -> 40 [label = "t_44:{group_id:PRIVATE:INT64}"]
30 -> 40 [label = "t_45:{group_num:PRIVATE:INT64}"]
30 -> 42 [label = "t_44:{group_id:PRIVATE:INT64}"]
30 -> 42 [label = "t_45:{group_num:PRIVATE:INT64}"]
30 -> 43 [label = "t_44:{group_id:PRIVATE:INT64}"]
30 -> 43 [label = "t_45:{group_num:PRIVATE:INT64}"]
30 -> 44 [label = "t_44:{group_id:PRIVATE:INT64}"]
30 -> 44 [label = "t_45:{group_num:PRIVATE:INT64}"]
31 -> 32 [label = "t_46:{Column#39:PRIVATE:FLOAT64}"]
32 -> 45 [label = "t_47:{Column#39_sum:PRIVATE:FLOAT64}"]
32 -> 48 [label = "t_47:{Column#39_sum:PRIVATE:FLOAT64}"]
33 -> 34 [label = "t_48:{Column#40:PRIVATE:FLOAT64}"]
34 -> 46 [label = "t_49:{Column#40_sum:PRIVATE:FLOAT64}"]
34 -> 48 [label = "t_49:{Column#40_sum:PRIVATE:FLOAT64}"]
35 -> 36 [label = "t_50:{Column#41:PRIVATE:FLOAT64}"]
36 -> 48 [label = "t_51:{Column#41_sum:PRIVATE:FLOAT64}"]
37 -> 38 [label = "t_52:{Column#42:PRIVATE:FLOAT64}"]
38 -> 48 [label = "t_53:{Column#42_sum:PRIVATE:FLOAT64}"]
39 -> 40 [label = "t_54:{Column#43:PRIVATE:INT64}"]
4 -> 31 [label = "t_18:{Column#39:SECRET:FLOAT64}"]
40 -> 45 [label = "t_55:{Column#43_sum:PRIVATE:INT64}"]
40 -> 46 [label = "t_55:{Column#43_sum:PRIVATE:INT64}"]
40 -> 47 [label = "t_55:{Column#43_sum:PRIVATE:INT64}"]
40 -> 48 [label = "t_55:{Column#43_sum:PRIVATE:INT64}"]
41 -> 42 [label = "t_56:{Column#44:PRIVATE:FLOAT64}"]
42 -> 47 [label = "t_57:{Column#44_sum:PRIVATE:FLOAT64}"]
43 -> 48 [label = "t_58:{Column#45_firstrow:PRIVATE:STRING}"]
44 -> 48 [label = "t_59:{Column#46_firstrow:PRIVATE:STRING}"]
45 -> 48 [label = "t_60:{Div_out:PRIVATE:FLOAT64}"]
46 -> 48 [label = "t_61:{Div_out:PRIVATE:FLOAT64}"]
47 -> 48 [label = "t_62:{Div_out:PRIVATE:FLOAT64}"]
5 -> 7 [label = "t_19:{Column#40:SECRET:FLOAT64}"]
6 -> 7 [label = "t_20:{Column#40:SECRET:FLOAT64}"]
7 -> 33 [label = "t_21:{Column#40:SECRET:FLOAT64}"]
8 -> 10 [label = "t_22:{Column#41:SECRET:FLOAT64}"]
9 -> 10 [label = "t_23:{Column#41:SECRET:FLOAT64}"]
}`, testConf{groupThreshold: 1}},
	{`select 100.00 * sum(case when isv.type_promo then ant.l_extendedprice*(1-ant.l_discount) else 0.0 end) / sum(ant.l_extendedprice * (1 - ant.l_discount)) as promo_revenue from (select * from alice.lineitem limit 1000) as ant join (select p_partkey, p_type LIKE 'PROMO%' as type_promo from bob.part limit 1000) as isv where ant.l_partkey = isv.p_partkey and ant.l_shipdate >= STR_TO_DATE('1995-02-06','%Y-%m-%d') and ant.l_shipdate <ADDDATE(STR_TO_DATE('1996-01-01','%Y-%m-%d'), interval 11 MONTH)`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,t_3,},],attr:[sql:select lineitem.l_discount,lineitem.l_extendedprice,lineitem.l_partkey,lineitem.l_shipdate from alice.lineitem where (lineitem.l_shipdate>=str_to_date('1995-02-06', '%Y-%m-%d')) and (lineitem.l_shipdate<adddate(str_to_date('1996-01-01', '%Y-%m-%d'), interval 11 MONTH)) limit 1000,table_refs:[alice.lineitem],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_4,t_5,},],attr:[sql:select part.p_partkey,part.p_type like 'PROMO%' as type_promo from bob.part limit 1000,table_refs:[bob.part],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_2,},Right:{t_4,},],out:[LeftJoinIndex:{t_6,},RightJoinIndex:{t_7,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,t_3,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,t_9,t_10,t_11,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_4,t_5,},RowsIndexFilter:{t_7,},],out:[Out:{t_12,t_13,},],attr:[],party:[bob,]}"]
5 [label="make_constant:{in:[],out:[Out:{t_14,},],attr:[scalar:1,to_status:1,],party:[alice,bob,carol,]}"]
6 [label="broadcast:{in:[In:{t_14,},ShapeRefTensor:{t_8,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
7 [label="Minus:{in:[Left:{t_15,},Right:{t_8,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
8 [label="Mul:{in:[Left:{t_9,},Right:{t_16,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
9 [label="make_constant:{in:[],out:[Out:{t_18,},],attr:[scalar:0,to_status:1,],party:[alice,bob,carol,]}"]
10 [label="broadcast:{in:[In:{t_18,},ShapeRefTensor:{t_17,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
11 [label="copy:{in:[In:{t_13,},],out:[Out:{t_21,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
12 [label="CaseWhen:{in:[Condition:{t_21,},Value:{t_17,},ValueElse:{t_19,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
13 [label="reduce_sum:{in:[In:{t_20,},],out:[Out:{t_22,},],attr:[],party:[alice,]}"]
14 [label="make_constant:{in:[],out:[Out:{t_23,},],attr:[scalar:1,to_status:1,],party:[alice,bob,carol,]}"]
15 [label="broadcast:{in:[In:{t_23,},ShapeRefTensor:{t_8,},],out:[Out:{t_24,},],attr:[],party:[alice,]}"]
16 [label="Minus:{in:[Left:{t_24,},Right:{t_8,},],out:[Out:{t_25,},],attr:[],party:[alice,]}"]
17 [label="Mul:{in:[Left:{t_9,},Right:{t_25,},],out:[Out:{t_26,},],attr:[],party:[alice,]}"]
18 [label="reduce_sum:{in:[In:{t_26,},],out:[Out:{t_27,},],attr:[],party:[alice,]}"]
19 [label="make_constant:{in:[],out:[Out:{t_28,},],attr:[scalar:100,to_status:1,],party:[alice,bob,carol,]}"]
20 [label="broadcast:{in:[In:{t_28,},ShapeRefTensor:{t_22,},],out:[Out:{t_29,},],attr:[],party:[alice,]}"]
21 [label="Mul:{in:[Left:{t_29,},Right:{t_22,},],out:[Out:{t_30,},],attr:[],party:[alice,]}"]
22 [label="Div:{in:[Left:{t_30,},Right:{t_27,},],out:[Out:{t_31,},],attr:[],party:[alice,]}"]
23 [label="publish:{in:[In:{t_31,},],out:[Out:{t_32,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_2:{l_partkey:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{l_discount:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_1:{l_extendedprice:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_2:{l_partkey:PRIVATE:INT64}"]
0 -> 3 [label = "t_3:{l_shipdate:PRIVATE:DATETIME}"]
1 -> 2 [label = "t_4:{p_partkey:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{p_partkey:PRIVATE:INT64}"]
1 -> 4 [label = "t_5:{Column#16:PRIVATE:BOOL}"]
10 -> 12 [label = "t_19:{constant_data:PRIVATE:FLOAT64}"]
11 -> 12 [label = "t_21:{Column#16:PRIVATE:BOOL}"]
12 -> 13 [label = "t_20:{constant_data:PRIVATE:FLOAT64}"]
13 -> 20 [label = "t_22:{constant_data:PRIVATE:FLOAT64}"]
13 -> 21 [label = "t_22:{constant_data:PRIVATE:FLOAT64}"]
14 -> 15 [label = "t_23:{constant_data:PUBLIC:INT64}"]
15 -> 16 [label = "t_24:{constant_data:PRIVATE:INT64}"]
16 -> 17 [label = "t_25:{Minus_out:PRIVATE:FLOAT64}"]
17 -> 18 [label = "t_26:{Mul_out:PRIVATE:FLOAT64}"]
18 -> 22 [label = "t_27:{Mul_out:PRIVATE:FLOAT64}"]
19 -> 20 [label = "t_28:{constant_data:PUBLIC:FLOAT64}"]
2 -> 3 [label = "t_6:{l_partkey:PRIVATE:INT64}"]
2 -> 4 [label = "t_7:{p_partkey:PRIVATE:INT64}"]
20 -> 21 [label = "t_29:{constant_data:PRIVATE:FLOAT64}"]
21 -> 22 [label = "t_30:{Mul_out:PRIVATE:FLOAT64}"]
22 -> 23 [label = "t_31:{Div_out:PRIVATE:FLOAT64}"]
3 -> 15 [label = "t_8:{l_discount:PRIVATE:FLOAT32}"]
3 -> 16 [label = "t_8:{l_discount:PRIVATE:FLOAT32}"]
3 -> 17 [label = "t_9:{l_extendedprice:PRIVATE:FLOAT32}"]
3 -> 6 [label = "t_8:{l_discount:PRIVATE:FLOAT32}"]
3 -> 7 [label = "t_8:{l_discount:PRIVATE:FLOAT32}"]
3 -> 8 [label = "t_9:{l_extendedprice:PRIVATE:FLOAT32}"]
4 -> 11 [label = "t_13:{Column#16:PRIVATE:BOOL}"]
5 -> 6 [label = "t_14:{constant_data:PUBLIC:INT64}"]
6 -> 7 [label = "t_15:{constant_data:PRIVATE:INT64}"]
7 -> 8 [label = "t_16:{Minus_out:PRIVATE:FLOAT64}"]
8 -> 10 [label = "t_17:{Mul_out:PRIVATE:FLOAT64}"]
8 -> 12 [label = "t_17:{Mul_out:PRIVATE:FLOAT64}"]
9 -> 10 [label = "t_18:{constant_data:PUBLIC:FLOAT64}"]
}`, testConf{groupThreshold: 1}},
	{`select ant.l_shipmode, sum(case when isv.o_orderpriority ='1-URGENT' or isv.o_orderpriority ='2-HIGH' then 1 else 0 end) as high_line_count, sum(case when isv.o_orderpriority <> '1-URGENT' and isv.o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from (select * from alice.lineitem limit 1000) as ant, (select * from bob.orders limit 1000) as isv where isv.o_orderkey = ant.l_orderkey and ant.l_shipmode1 in ('AIR', 'SHIP','RAIL') and ant.l_commitdate < ant.l_receiptdate and ant.l_shipdate < ant.l_commitdate and ant.l_receiptdate >= STR_TO_DATE('1995-02-06','%Y-%m-%d') and ant.l_receiptdate < ADDDATE(STR_TO_DATE('1995-01-01','%Y-%m-%d'), interval 1 year) group by ant.l_shipmode;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,t_3,t_4,t_5,},],attr:[sql:select lineitem.l_commitdate,lineitem.l_orderkey,lineitem.l_receiptdate,lineitem.l_shipdate,lineitem.l_shipmode,lineitem.l_shipmode1 from alice.lineitem where ((((lineitem.l_shipmode1='AIR' or lineitem.l_shipmode1='SHIP' or lineitem.l_shipmode1='RAIL') and (lineitem.l_commitdate<lineitem.l_receiptdate)) and (lineitem.l_shipdate<lineitem.l_commitdate)) and (lineitem.l_receiptdate>=str_to_date('1995-02-06', '%Y-%m-%d'))) and (lineitem.l_receiptdate<adddate(str_to_date('1995-01-01', '%Y-%m-%d'), interval 1 YEAR)) limit 1000,table_refs:[alice.lineitem],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_6,t_7,},],attr:[sql:select orders.o_orderkey,orders.o_orderpriority from bob.orders limit 1000,table_refs:[bob.orders],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_6,},],out:[LeftJoinIndex:{t_8,},RightJoinIndex:{t_9,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,t_3,t_4,t_5,},RowsIndexFilter:{t_8,},],out:[Out:{t_10,t_11,t_12,t_13,t_14,t_15,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_6,t_7,},RowsIndexFilter:{t_9,},],out:[Out:{t_16,t_17,},],attr:[],party:[bob,]}"]
5 [label="group:{in:[Key:{t_14,},],out:[GroupId:{t_18,},GroupNum:{t_19,},],attr:[],party:[alice,]}"]
6 [label="make_constant:{in:[],out:[Out:{t_20,},],attr:[scalar:1-URGENT,to_status:1,],party:[alice,bob,carol,]}"]
7 [label="broadcast:{in:[In:{t_20,},ShapeRefTensor:{t_17,},],out:[Out:{t_21,},],attr:[],party:[bob,]}"]
8 [label="Equal:{in:[Left:{t_17,},Right:{t_21,},],out:[Out:{t_22,},],attr:[],party:[bob,]}"]
9 [label="make_constant:{in:[],out:[Out:{t_23,},],attr:[scalar:2-HIGH,to_status:1,],party:[alice,bob,carol,]}"]
10 [label="broadcast:{in:[In:{t_23,},ShapeRefTensor:{t_17,},],out:[Out:{t_24,},],attr:[],party:[bob,]}"]
11 [label="Equal:{in:[Left:{t_17,},Right:{t_24,},],out:[Out:{t_25,},],attr:[],party:[bob,]}"]
12 [label="LogicalOr:{in:[Left:{t_22,},Right:{t_25,},],out:[Out:{t_26,},],attr:[],party:[bob,]}"]
13 [label="make_constant:{in:[],out:[Out:{t_27,},],attr:[scalar:1,to_status:1,],party:[alice,bob,carol,]}"]
14 [label="make_constant:{in:[],out:[Out:{t_28,},],attr:[scalar:0,to_status:1,],party:[alice,bob,carol,]}"]
15 [label="broadcast:{in:[In:{t_27,t_28,},ShapeRefTensor:{t_26,},],out:[Out:{t_29,t_30,},],attr:[],party:[bob,]}"]
16 [label="CaseWhen:{in:[Condition:{t_26,},Value:{t_29,},ValueElse:{t_30,},],out:[Out:{t_31,},],attr:[],party:[bob,]}"]
17 [label="copy:{in:[In:{t_31,},],out:[Out:{t_32,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
18 [label="sum:{in:[GroupId:{t_18,},GroupNum:{t_19,},In:{t_32,},],out:[Out:{t_33,},],attr:[],party:[alice,]}"]
19 [label="make_constant:{in:[],out:[Out:{t_34,},],attr:[scalar:1-URGENT,to_status:1,],party:[alice,bob,carol,]}"]
20 [label="broadcast:{in:[In:{t_34,},ShapeRefTensor:{t_17,},],out:[Out:{t_35,},],attr:[],party:[bob,]}"]
21 [label="NotEqual:{in:[Left:{t_17,},Right:{t_35,},],out:[Out:{t_36,},],attr:[],party:[bob,]}"]
22 [label="make_constant:{in:[],out:[Out:{t_37,},],attr:[scalar:2-HIGH,to_status:1,],party:[alice,bob,carol,]}"]
23 [label="broadcast:{in:[In:{t_37,},ShapeRefTensor:{t_17,},],out:[Out:{t_38,},],attr:[],party:[bob,]}"]
24 [label="NotEqual:{in:[Left:{t_17,},Right:{t_38,},],out:[Out:{t_39,},],attr:[],party:[bob,]}"]
25 [label="LogicalAnd:{in:[Left:{t_36,},Right:{t_39,},],out:[Out:{t_40,},],attr:[],party:[bob,]}"]
26 [label="make_constant:{in:[],out:[Out:{t_41,},],attr:[scalar:1,to_status:1,],party:[alice,bob,carol,]}"]
27 [label="make_constant:{in:[],out:[Out:{t_42,},],attr:[scalar:0,to_status:1,],party:[alice,bob,carol,]}"]
28 [label="broadcast:{in:[In:{t_41,t_42,},ShapeRefTensor:{t_40,},],out:[Out:{t_43,t_44,},],attr:[],party:[bob,]}"]
29 [label="CaseWhen:{in:[Condition:{t_40,},Value:{t_43,},ValueElse:{t_44,},],out:[Out:{t_45,},],attr:[],party:[bob,]}"]
30 [label="copy:{in:[In:{t_45,},],out:[Out:{t_46,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
31 [label="sum:{in:[GroupId:{t_18,},GroupNum:{t_19,},In:{t_46,},],out:[Out:{t_47,},],attr:[],party:[alice,]}"]
32 [label="firstrow:{in:[GroupId:{t_18,},GroupNum:{t_19,},In:{t_14,},],out:[Out:{t_48,},],attr:[],party:[alice,]}"]
33 [label="publish:{in:[In:{t_48,t_33,t_47,},],out:[Out:{t_49,t_50,t_51,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{l_orderkey:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{l_commitdate:PRIVATE:DATETIME}"]
0 -> 3 [label = "t_1:{l_orderkey:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{l_receiptdate:PRIVATE:DATETIME}"]
0 -> 3 [label = "t_3:{l_shipdate:PRIVATE:DATETIME}"]
0 -> 3 [label = "t_4:{l_shipmode:PRIVATE:STRING}"]
0 -> 3 [label = "t_5:{l_shipmode1:PRIVATE:STRING}"]
1 -> 2 [label = "t_6:{o_orderkey:PRIVATE:INT64}"]
1 -> 4 [label = "t_6:{o_orderkey:PRIVATE:INT64}"]
1 -> 4 [label = "t_7:{o_orderpriority:PRIVATE:STRING}"]
10 -> 11 [label = "t_24:{constant_data:PRIVATE:STRING}"]
11 -> 12 [label = "t_25:{Equal_out:PRIVATE:BOOL}"]
12 -> 15 [label = "t_26:{LogicalOr_out:PRIVATE:BOOL}"]
12 -> 16 [label = "t_26:{LogicalOr_out:PRIVATE:BOOL}"]
13 -> 15 [label = "t_27:{constant_data:PUBLIC:INT64}"]
14 -> 15 [label = "t_28:{constant_data:PUBLIC:INT64}"]
15 -> 16 [label = "t_29:{constant_data:PRIVATE:INT64}"]
15 -> 16 [label = "t_30:{constant_data:PRIVATE:INT64}"]
16 -> 17 [label = "t_31:{constant_data:PRIVATE:INT64}"]
17 -> 18 [label = "t_32:{constant_data:PRIVATE:INT64}"]
18 -> 33 [label = "t_33:{constant_data_sum:PRIVATE:INT64}"]
19 -> 20 [label = "t_34:{constant_data:PUBLIC:STRING}"]
2 -> 3 [label = "t_8:{l_orderkey:PRIVATE:INT64}"]
2 -> 4 [label = "t_9:{o_orderkey:PRIVATE:INT64}"]
20 -> 21 [label = "t_35:{constant_data:PRIVATE:STRING}"]
21 -> 25 [label = "t_36:{NotEqual_out:PRIVATE:BOOL}"]
22 -> 23 [label = "t_37:{constant_data:PUBLIC:STRING}"]
23 -> 24 [label = "t_38:{constant_data:PRIVATE:STRING}"]
24 -> 25 [label = "t_39:{NotEqual_out:PRIVATE:BOOL}"]
25 -> 28 [label = "t_40:{LogicalAnd_out:PRIVATE:BOOL}"]
25 -> 29 [label = "t_40:{LogicalAnd_out:PRIVATE:BOOL}"]
26 -> 28 [label = "t_41:{constant_data:PUBLIC:INT64}"]
27 -> 28 [label = "t_42:{constant_data:PUBLIC:INT64}"]
28 -> 29 [label = "t_43:{constant_data:PRIVATE:INT64}"]
28 -> 29 [label = "t_44:{constant_data:PRIVATE:INT64}"]
29 -> 30 [label = "t_45:{constant_data:PRIVATE:INT64}"]
3 -> 32 [label = "t_14:{l_shipmode:PRIVATE:STRING}"]
3 -> 5 [label = "t_14:{l_shipmode:PRIVATE:STRING}"]
30 -> 31 [label = "t_46:{constant_data:PRIVATE:INT64}"]
31 -> 33 [label = "t_47:{constant_data_sum:PRIVATE:INT64}"]
32 -> 33 [label = "t_48:{l_shipmode_firstrow:PRIVATE:STRING}"]
4 -> 10 [label = "t_17:{o_orderpriority:PRIVATE:STRING}"]
4 -> 11 [label = "t_17:{o_orderpriority:PRIVATE:STRING}"]
4 -> 20 [label = "t_17:{o_orderpriority:PRIVATE:STRING}"]
4 -> 21 [label = "t_17:{o_orderpriority:PRIVATE:STRING}"]
4 -> 23 [label = "t_17:{o_orderpriority:PRIVATE:STRING}"]
4 -> 24 [label = "t_17:{o_orderpriority:PRIVATE:STRING}"]
4 -> 7 [label = "t_17:{o_orderpriority:PRIVATE:STRING}"]
4 -> 8 [label = "t_17:{o_orderpriority:PRIVATE:STRING}"]
5 -> 18 [label = "t_18:{group_id:PRIVATE:INT64}"]
5 -> 18 [label = "t_19:{group_num:PRIVATE:INT64}"]
5 -> 31 [label = "t_18:{group_id:PRIVATE:INT64}"]
5 -> 31 [label = "t_19:{group_num:PRIVATE:INT64}"]
5 -> 32 [label = "t_18:{group_id:PRIVATE:INT64}"]
5 -> 32 [label = "t_19:{group_num:PRIVATE:INT64}"]
6 -> 7 [label = "t_20:{constant_data:PUBLIC:STRING}"]
7 -> 8 [label = "t_21:{constant_data:PRIVATE:STRING}"]
8 -> 12 [label = "t_22:{Equal_out:PRIVATE:BOOL}"]
9 -> 10 [label = "t_23:{constant_data:PUBLIC:STRING}"]
}`, testConf{groupThreshold: 1}},
	{`SELECT ant.l_returnflag,isv.l_linestatus,sum(ant.l_quantity) AS sum_qty,sum(ant.l_extendedprice) AS sum_base_price,sum(ant.l_extendedprice * (1 - ant.l_discount)) AS sum_disc_price,sum(ant.l_extendedprice * (1 - ant.l_discount) * (1 + ant.l_tax)) AS sum_charge,sum(ant.l_quantity)/count(*) AS avg_qty,sum(ant.l_extendedprice)/count(*) AS avg_price,sum(ant.l_discount)/count(*) AS avg_disc,count(*) AS count_order FROM (select * from alice.lineitem limit 1000) AS ant JOIN (select * from bob.lineitem limit 1000) AS isv ON ant.l_orderkey = isv.l_orderkey WHERE ant.l_shipdate <= DATE_SUB(STR_TO_DATE('1996-01-01','%Y-%m-%d'), INTERVAL 37 DAY) GROUP BY ant.l_returnflag,isv.l_linestatus`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,t_3,t_4,t_5,t_6,},],attr:[sql:select lineitem.l_discount,lineitem.l_extendedprice,lineitem.l_orderkey,lineitem.l_quantity,lineitem.l_returnflag,lineitem.l_shipdate,lineitem.l_tax from alice.lineitem where lineitem.l_shipdate<=date_sub(str_to_date('1996-01-01', '%Y-%m-%d'), interval 37 'DAY') limit 1000,table_refs:[alice.lineitem],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_7,t_8,},],attr:[sql:select lineitem.l_linestatus,lineitem.l_orderkey from bob.lineitem limit 1000,table_refs:[bob.lineitem],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_2,},Right:{t_8,},],out:[LeftJoinIndex:{t_9,},RightJoinIndex:{t_10,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,t_3,t_4,t_5,t_6,},RowsIndexFilter:{t_9,},],out:[Out:{t_11,t_12,t_13,t_14,t_15,t_16,t_17,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_7,t_8,},RowsIndexFilter:{t_10,},],out:[Out:{t_18,t_19,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_15,},],out:[Out:{t_20,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_18,},],out:[Out:{t_21,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_11,},],out:[Out:{t_22,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_12,},],out:[Out:{t_23,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_share:{in:[In:{t_13,},],out:[Out:{t_24,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="make_share:{in:[In:{t_14,},],out:[Out:{t_25,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_share:{in:[In:{t_16,},],out:[Out:{t_26,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_17,},],out:[Out:{t_27,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_share:{in:[In:{t_19,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="sort:{in:[In:{t_20,t_21,t_22,t_23,t_24,t_25,t_20,t_26,t_27,t_21,t_28,},Key:{t_20,t_21,},],out:[Out:{t_29,t_30,t_31,t_32,t_33,t_34,t_35,t_36,t_37,t_38,t_39,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
15 [label="group_mark:{in:[Key:{t_29,t_30,},],out:[Group:{t_40,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="sum:{in:[Group:{t_40,},In:{t_34,},],out:[Out:{t_41,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="sum:{in:[Group:{t_40,},In:{t_32,},],out:[Out:{t_42,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="make_constant:{in:[],out:[Out:{t_43,},],attr:[scalar:1,to_status:1,],party:[alice,bob,carol,]}"]
19 [label="broadcast:{in:[In:{t_43,},ShapeRefTensor:{t_31,},],out:[Out:{t_44,},],attr:[],party:[alice,bob,carol,]}"]
20 [label="make_private:{in:[In:{t_44,},],out:[Out:{t_45,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
21 [label="make_private:{in:[In:{t_31,},],out:[Out:{t_46,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
22 [label="Minus:{in:[Left:{t_45,},Right:{t_46,},],out:[Out:{t_47,},],attr:[],party:[alice,]}"]
23 [label="make_private:{in:[In:{t_32,},],out:[Out:{t_48,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
24 [label="Mul:{in:[Left:{t_48,},Right:{t_47,},],out:[Out:{t_49,},],attr:[],party:[alice,]}"]
25 [label="make_share:{in:[In:{t_49,},],out:[Out:{t_50,},],attr:[],party:[alice,bob,carol,]}"]
26 [label="sum:{in:[Group:{t_40,},In:{t_50,},],out:[Out:{t_51,},],attr:[],party:[alice,bob,carol,]}"]
27 [label="make_constant:{in:[],out:[Out:{t_52,},],attr:[scalar:1,to_status:1,],party:[alice,bob,carol,]}"]
28 [label="broadcast:{in:[In:{t_52,},ShapeRefTensor:{t_31,},],out:[Out:{t_53,},],attr:[],party:[alice,bob,carol,]}"]
29 [label="make_private:{in:[In:{t_53,},],out:[Out:{t_54,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
30 [label="Minus:{in:[Left:{t_54,},Right:{t_46,},],out:[Out:{t_55,},],attr:[],party:[alice,]}"]
31 [label="Mul:{in:[Left:{t_48,},Right:{t_55,},],out:[Out:{t_56,},],attr:[],party:[alice,]}"]
32 [label="make_constant:{in:[],out:[Out:{t_57,},],attr:[scalar:1,to_status:1,],party:[alice,bob,carol,]}"]
33 [label="broadcast:{in:[In:{t_57,},ShapeRefTensor:{t_37,},],out:[Out:{t_58,},],attr:[],party:[alice,bob,carol,]}"]
34 [label="make_private:{in:[In:{t_58,},],out:[Out:{t_59,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
35 [label="make_private:{in:[In:{t_37,},],out:[Out:{t_60,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
36 [label="Add:{in:[Left:{t_59,},Right:{t_60,},],out:[Out:{t_61,},],attr:[],party:[alice,]}"]
37 [label="Mul:{in:[Left:{t_56,},Right:{t_61,},],out:[Out:{t_62,},],attr:[],party:[alice,]}"]
38 [label="make_share:{in:[In:{t_62,},],out:[Out:{t_63,},],attr:[],party:[alice,bob,carol,]}"]
39 [label="sum:{in:[Group:{t_40,},In:{t_63,},],out:[Out:{t_64,},],attr:[],party:[alice,bob,carol,]}"]
40 [label="count:{in:[Group:{t_40,},In:{t_40,},],out:[Out:{t_65,},],attr:[],party:[alice,bob,carol,]}"]
41 [label="sum:{in:[Group:{t_40,},In:{t_31,},],out:[Out:{t_66,},],attr:[],party:[alice,bob,carol,]}"]
42 [label="shuffle:{in:[In:{t_41,t_42,t_51,t_64,t_65,t_66,t_35,t_38,t_40,},],out:[Out:{t_67,t_68,t_69,t_70,t_71,t_72,t_73,t_74,t_75,},],attr:[],party:[alice,bob,carol,]}"]
43 [label="make_public:{in:[In:{t_75,},],out:[Out:{t_76,},],attr:[],party:[alice,bob,carol,]}"]
44 [label="filter:{in:[Filter:{t_76,},In:{t_67,t_68,t_69,t_70,t_71,t_72,t_73,t_74,},],out:[Out:{t_77,t_78,t_79,t_80,t_81,t_82,t_83,t_84,},],attr:[],party:[alice,bob,carol,]}"]
45 [label="make_private:{in:[In:{t_77,},],out:[Out:{t_85,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
46 [label="make_private:{in:[In:{t_81,},],out:[Out:{t_86,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
47 [label="Div:{in:[Left:{t_85,},Right:{t_86,},],out:[Out:{t_87,},],attr:[],party:[alice,]}"]
48 [label="make_private:{in:[In:{t_78,},],out:[Out:{t_88,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
49 [label="Div:{in:[Left:{t_88,},Right:{t_86,},],out:[Out:{t_89,},],attr:[],party:[alice,]}"]
50 [label="make_private:{in:[In:{t_82,},],out:[Out:{t_90,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
51 [label="Div:{in:[Left:{t_90,},Right:{t_86,},],out:[Out:{t_91,},],attr:[],party:[alice,]}"]
52 [label="make_private:{in:[In:{t_83,},],out:[Out:{t_92,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
53 [label="make_private:{in:[In:{t_84,},],out:[Out:{t_94,},],attr:[reveal_to:bob,],party:[alice,bob,carol,]}"]
54 [label="copy:{in:[In:{t_94,},],out:[Out:{t_95,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
55 [label="make_private:{in:[In:{t_79,},],out:[Out:{t_99,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
56 [label="make_private:{in:[In:{t_80,},],out:[Out:{t_101,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
57 [label="publish:{in:[In:{t_92,t_95,t_85,t_88,t_99,t_101,t_87,t_89,t_91,t_86,},],out:[Out:{t_93,t_96,t_97,t_98,t_100,t_102,t_103,t_104,t_105,t_106,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_2:{l_orderkey:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{l_discount:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_1:{l_extendedprice:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_2:{l_orderkey:PRIVATE:INT64}"]
0 -> 3 [label = "t_3:{l_quantity:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_4:{l_returnflag:PRIVATE:STRING}"]
0 -> 3 [label = "t_5:{l_shipdate:PRIVATE:DATETIME}"]
0 -> 3 [label = "t_6:{l_tax:PRIVATE:FLOAT32}"]
1 -> 2 [label = "t_8:{l_orderkey:PRIVATE:INT64}"]
1 -> 4 [label = "t_7:{l_linestatus:PRIVATE:STRING}"]
1 -> 4 [label = "t_8:{l_orderkey:PRIVATE:INT64}"]
10 -> 14 [label = "t_25:{l_quantity:SECRET:FLOAT32}"]
11 -> 14 [label = "t_26:{l_shipdate:SECRET:DATETIME}"]
12 -> 14 [label = "t_27:{l_tax:SECRET:FLOAT32}"]
13 -> 14 [label = "t_28:{l_orderkey:SECRET:INT64}"]
14 -> 15 [label = "t_29:{l_returnflag:SECRET:STRING}"]
14 -> 15 [label = "t_30:{l_linestatus:SECRET:STRING}"]
14 -> 16 [label = "t_34:{l_quantity:SECRET:FLOAT32}"]
14 -> 17 [label = "t_32:{l_extendedprice:SECRET:FLOAT32}"]
14 -> 19 [label = "t_31:{l_discount:SECRET:FLOAT32}"]
14 -> 21 [label = "t_31:{l_discount:SECRET:FLOAT32}"]
14 -> 23 [label = "t_32:{l_extendedprice:SECRET:FLOAT32}"]
14 -> 28 [label = "t_31:{l_discount:SECRET:FLOAT32}"]
14 -> 33 [label = "t_37:{l_tax:SECRET:FLOAT32}"]
14 -> 35 [label = "t_37:{l_tax:SECRET:FLOAT32}"]
14 -> 41 [label = "t_31:{l_discount:SECRET:FLOAT32}"]
14 -> 42 [label = "t_35:{l_returnflag:SECRET:STRING}"]
14 -> 42 [label = "t_38:{l_linestatus:SECRET:STRING}"]
15 -> 16 [label = "t_40:{group_mark:SECRET:BOOL}"]
15 -> 17 [label = "t_40:{group_mark:SECRET:BOOL}"]
15 -> 26 [label = "t_40:{group_mark:SECRET:BOOL}"]
15 -> 39 [label = "t_40:{group_mark:SECRET:BOOL}"]
15 -> 40 [label = "t_40:{group_mark:SECRET:BOOL}"]
15 -> 40 [label = "t_40:{group_mark:SECRET:BOOL}"]
15 -> 41 [label = "t_40:{group_mark:SECRET:BOOL}"]
15 -> 42 [label = "t_40:{group_mark:SECRET:BOOL}"]
16 -> 42 [label = "t_41:{l_quantity:SECRET:FLOAT64}"]
17 -> 42 [label = "t_42:{l_extendedprice:SECRET:FLOAT64}"]
18 -> 19 [label = "t_43:{constant_data:PUBLIC:INT64}"]
19 -> 20 [label = "t_44:{constant_data:PUBLIC:INT64}"]
2 -> 3 [label = "t_9:{l_orderkey:PRIVATE:INT64}"]
2 -> 4 [label = "t_10:{l_orderkey:PRIVATE:INT64}"]
20 -> 22 [label = "t_45:{constant_data:PRIVATE:INT64}"]
21 -> 22 [label = "t_46:{l_discount:PRIVATE:FLOAT32}"]
21 -> 30 [label = "t_46:{l_discount:PRIVATE:FLOAT32}"]
22 -> 24 [label = "t_47:{Minus_out:PRIVATE:FLOAT64}"]
23 -> 24 [label = "t_48:{l_extendedprice:PRIVATE:FLOAT32}"]
23 -> 31 [label = "t_48:{l_extendedprice:PRIVATE:FLOAT32}"]
24 -> 25 [label = "t_49:{Mul_out:PRIVATE:FLOAT64}"]
25 -> 26 [label = "t_50:{Mul_out:SECRET:FLOAT64}"]
26 -> 42 [label = "t_51:{Mul_out:SECRET:FLOAT64}"]
27 -> 28 [label = "t_52:{constant_data:PUBLIC:INT64}"]
28 -> 29 [label = "t_53:{constant_data:PUBLIC:INT64}"]
29 -> 30 [label = "t_54:{constant_data:PRIVATE:INT64}"]
3 -> 10 [label = "t_14:{l_quantity:PRIVATE:FLOAT32}"]
3 -> 11 [label = "t_16:{l_shipdate:PRIVATE:DATETIME}"]
3 -> 12 [label = "t_17:{l_tax:PRIVATE:FLOAT32}"]
3 -> 5 [label = "t_15:{l_returnflag:PRIVATE:STRING}"]
3 -> 7 [label = "t_11:{l_discount:PRIVATE:FLOAT32}"]
3 -> 8 [label = "t_12:{l_extendedprice:PRIVATE:FLOAT32}"]
3 -> 9 [label = "t_13:{l_orderkey:PRIVATE:INT64}"]
30 -> 31 [label = "t_55:{Minus_out:PRIVATE:FLOAT64}"]
31 -> 37 [label = "t_56:{Mul_out:PRIVATE:FLOAT64}"]
32 -> 33 [label = "t_57:{constant_data:PUBLIC:INT64}"]
33 -> 34 [label = "t_58:{constant_data:PUBLIC:INT64}"]
34 -> 36 [label = "t_59:{constant_data:PRIVATE:INT64}"]
35 -> 36 [label = "t_60:{l_tax:PRIVATE:FLOAT32}"]
36 -> 37 [label = "t_61:{Add_out:PRIVATE:FLOAT64}"]
37 -> 38 [label = "t_62:{Mul_out:PRIVATE:FLOAT64}"]
38 -> 39 [label = "t_63:{Mul_out:SECRET:FLOAT64}"]
39 -> 42 [label = "t_64:{Mul_out:SECRET:FLOAT64}"]
4 -> 13 [label = "t_19:{l_orderkey:PRIVATE:INT64}"]
4 -> 6 [label = "t_18:{l_linestatus:PRIVATE:STRING}"]
40 -> 42 [label = "t_65:{group_mark:SECRET:INT64}"]
41 -> 42 [label = "t_66:{l_discount:SECRET:FLOAT64}"]
42 -> 43 [label = "t_75:{group_mark:SECRET:BOOL}"]
42 -> 44 [label = "t_67:{l_quantity:SECRET:FLOAT64}"]
42 -> 44 [label = "t_68:{l_extendedprice:SECRET:FLOAT64}"]
42 -> 44 [label = "t_69:{Mul_out:SECRET:FLOAT64}"]
42 -> 44 [label = "t_70:{Mul_out:SECRET:FLOAT64}"]
42 -> 44 [label = "t_71:{group_mark:SECRET:INT64}"]
42 -> 44 [label = "t_72:{l_discount:SECRET:FLOAT64}"]
42 -> 44 [label = "t_73:{l_returnflag:SECRET:STRING}"]
42 -> 44 [label = "t_74:{l_linestatus:SECRET:STRING}"]
43 -> 44 [label = "t_76:{group_mark:PUBLIC:BOOL}"]
44 -> 45 [label = "t_77:{l_quantity:SECRET:FLOAT64}"]
44 -> 46 [label = "t_81:{group_mark:SECRET:INT64}"]
44 -> 48 [label = "t_78:{l_extendedprice:SECRET:FLOAT64}"]
44 -> 50 [label = "t_82:{l_discount:SECRET:FLOAT64}"]
44 -> 52 [label = "t_83:{l_returnflag:SECRET:STRING}"]
44 -> 53 [label = "t_84:{l_linestatus:SECRET:STRING}"]
44 -> 55 [label = "t_79:{Mul_out:SECRET:FLOAT64}"]
44 -> 56 [label = "t_80:{Mul_out:SECRET:FLOAT64}"]
45 -> 47 [label = "t_85:{l_quantity:PRIVATE:FLOAT64}"]
45 -> 57 [label = "t_85:{l_quantity:PRIVATE:FLOAT64}"]
46 -> 47 [label = "t_86:{group_mark:PRIVATE:INT64}"]
46 -> 49 [label = "t_86:{group_mark:PRIVATE:INT64}"]
46 -> 51 [label = "t_86:{group_mark:PRIVATE:INT64}"]
46 -> 57 [label = "t_86:{group_mark:PRIVATE:INT64}"]
47 -> 57 [label = "t_87:{Div_out:PRIVATE:FLOAT64}"]
48 -> 49 [label = "t_88:{l_extendedprice:PRIVATE:FLOAT64}"]
48 -> 57 [label = "t_88:{l_extendedprice:PRIVATE:FLOAT64}"]
49 -> 57 [label = "t_89:{Div_out:PRIVATE:FLOAT64}"]
5 -> 14 [label = "t_20:{l_returnflag:SECRET:STRING}"]
5 -> 14 [label = "t_20:{l_returnflag:SECRET:STRING}"]
5 -> 14 [label = "t_20:{l_returnflag:SECRET:STRING}"]
50 -> 51 [label = "t_90:{l_discount:PRIVATE:FLOAT64}"]
51 -> 57 [label = "t_91:{Div_out:PRIVATE:FLOAT64}"]
52 -> 57 [label = "t_92:{l_returnflag:PRIVATE:STRING}"]
53 -> 54 [label = "t_94:{l_linestatus:PRIVATE:STRING}"]
54 -> 57 [label = "t_95:{l_linestatus:PRIVATE:STRING}"]
55 -> 57 [label = "t_99:{Mul_out:PRIVATE:FLOAT64}"]
56 -> 57 [label = "t_101:{Mul_out:PRIVATE:FLOAT64}"]
6 -> 14 [label = "t_21:{l_linestatus:SECRET:STRING}"]
6 -> 14 [label = "t_21:{l_linestatus:SECRET:STRING}"]
6 -> 14 [label = "t_21:{l_linestatus:SECRET:STRING}"]
7 -> 14 [label = "t_22:{l_discount:SECRET:FLOAT32}"]
8 -> 14 [label = "t_23:{l_extendedprice:SECRET:FLOAT32}"]
9 -> 14 [label = "t_24:{l_orderkey:SECRET:INT64}"]
}`, testConf{groupThreshold: 1}},
}
