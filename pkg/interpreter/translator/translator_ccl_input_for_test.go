// Copyright 2023 Ant Group Co., Ltd.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package translator

var translateNumericTestCases = []sPair{
	{`select alice.plain_datetime_0 from alice.tbl_0 as alice join bob.tbl_0 as bob on bob.join_string_0 = alice.encrypt_string_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.encrypt_string_0,alice.plain_datetime_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select bob.join_string_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="publish:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{encrypt_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_1:{plain_datetime_0:PRIVATE:DATETIME}"]
1 -> 2 [label = "t_2:{join_string_0:PRIVATE:STRING}"]
2 -> 3 [label = "t_3:{encrypt_string_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{plain_datetime_0:PRIVATE:DATETIME}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT ABS(ta.plain_int_0) AS abs_out,
	CEIL(ta.plain_int_0) AS ceil_out,
	FLOOR(ta.plain_int_0) AS floor_out,
	ROUND(ta.plain_int_0) AS round_out,
	RADIANS(ta.plain_int_0) AS radians_out,
	DEGREES(ta.plain_int_0) AS degrees_out,
	LN(ta.plain_int_0) AS ln_out,
	LOG10(ta.plain_int_0) AS log10_out,
	LOG2(ta.plain_int_0) AS log2_out,
	SQRT(ta.plain_int_0) AS sqrt_out,
	EXP(ta.plain_int_0) AS exp_out
	FROM alice.tbl_0 as ta INNER JOIN bob.tbl_0 as tb
	ON ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="Abs:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
5 [label="Ceil:{in:[In:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
6 [label="Floor:{in:[In:{t_4,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
7 [label="Round:{in:[In:{t_4,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="Radians:{in:[In:{t_4,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
9 [label="Degrees:{in:[In:{t_4,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
10 [label="Ln:{in:[In:{t_4,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
11 [label="Log10:{in:[In:{t_4,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
12 [label="Log2:{in:[In:{t_4,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
13 [label="Sqrt:{in:[In:{t_4,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
14 [label="Exp:{in:[In:{t_4,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
15 [label="publish:{in:[In:{t_5,t_6,t_7,t_8,t_9,t_10,t_11,t_12,t_13,t_14,t_15,},],out:[Out:{t_16,t_17,t_18,t_19,t_20,t_21,t_22,t_23,t_24,t_25,t_26,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
10 -> 15 [label = "t_11:{plain_int_0:PRIVATE:FLOAT64}"]
11 -> 15 [label = "t_12:{plain_int_0:PRIVATE:FLOAT64}"]
12 -> 15 [label = "t_13:{plain_int_0:PRIVATE:FLOAT64}"]
13 -> 15 [label = "t_14:{plain_int_0:PRIVATE:FLOAT64}"]
14 -> 15 [label = "t_15:{plain_int_0:PRIVATE:FLOAT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 10 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 11 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 12 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 13 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 14 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
4 -> 15 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
5 -> 15 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
6 -> 15 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
7 -> 15 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
8 -> 15 [label = "t_9:{plain_int_0:PRIVATE:FLOAT64}"]
9 -> 15 [label = "t_10:{plain_int_0:PRIVATE:FLOAT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
}
var translateWithCCLTestCases = []sPair{
	{`SELECT ta.join_int_0, ta.plain_datetime_0 from alice.tbl_0 as ta right join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0 where ta.plain_datetime_0 > str_to_date(tb.plain_string_0, '%Y-%m-%d')`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_datetime_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.join_int_0,tb.plain_string_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:2,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,},],attr:[],party:[bob,]}"]
5 [label="make_constant:{in:[],out:[Out:{t_9,},],attr:[scalar:%Y-%m-%d,],party:[alice,bob,carol,]}"]
6 [label="str_to_date:{in:[In:{t_8,},],out:[Out:{t_10,},],attr:[func_name:strptime,func_opt_type:StrptimeOptions,],party:[bob,]}"]
7 [label="copy:{in:[In:{t_10,},],out:[Out:{t_11,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="Greater:{in:[Left:{t_7,},Right:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
9 [label="apply_filter:{in:[Filter:{t_12,},In:{t_6,t_7,},],out:[Out:{t_13,t_14,},],attr:[],party:[alice,]}"]
10 [label="publish:{in:[In:{t_13,t_14,},],out:[Out:{t_15,t_16,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_datetime_0:PRIVATE:DATETIME}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{plain_string_0:PRIVATE:STRING}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_7:{plain_datetime_0:PRIVATE:DATETIME}"]
3 -> 9 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_7:{plain_datetime_0:PRIVATE:DATETIME}"]
4 -> 6 [label = "t_8:{plain_string_0:PRIVATE:STRING}"]
6 -> 7 [label = "t_10:{str_to_date_out:PRIVATE:DATETIME}"]
7 -> 8 [label = "t_11:{str_to_date_out:PRIVATE:DATETIME}"]
8 -> 9 [label = "t_12:{Greater_out:PRIVATE:BOOL}"]
9 -> 10 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
9 -> 10 [label = "t_14:{plain_datetime_0:PRIVATE:DATETIME}"]
}`, ``, testConf{groupThreshold: 0, batched: false},
	},
	{`SELECT ta.join_int_0, ta.plain_datetime_0 from alice.tbl_0 as ta right join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0 where ta.plain_datetime_0 > str_to_date('2025-06-05', '%Y-%m-%d')`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_datetime_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:2,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,t_6,},],attr:[],party:[alice,]}"]
4 [label="make_constant:{in:[],out:[Out:{t_7,},],attr:[scalar:2025-06-05,],party:[alice,bob,carol,]}"]
5 [label="make_constant:{in:[],out:[Out:{t_8,},],attr:[scalar:%Y-%m-%d,],party:[alice,bob,carol,]}"]
6 [label="make_constant:{in:[],out:[Out:{t_9,},],attr:[scalar:1749081600,],party:[alice,bob,carol,]}"]
7 [label="broadcast:{in:[In:{t_9,},ShapeRefTensor:{t_6,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
8 [label="Greater:{in:[Left:{t_6,},Right:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
9 [label="apply_filter:{in:[Filter:{t_11,},In:{t_5,t_6,},],out:[Out:{t_12,t_13,},],attr:[],party:[alice,]}"]
10 [label="publish:{in:[In:{t_12,t_13,},],out:[Out:{t_14,t_15,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_datetime_0:PRIVATE:DATETIME}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_6:{plain_datetime_0:PRIVATE:DATETIME}"]
3 -> 8 [label = "t_6:{plain_datetime_0:PRIVATE:DATETIME}"]
3 -> 9 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_6:{plain_datetime_0:PRIVATE:DATETIME}"]
6 -> 7 [label = "t_9:{constant_data:PUBLIC:INT64}"]
7 -> 8 [label = "t_10:{constant_data:PRIVATE:INT64}"]
8 -> 9 [label = "t_11:{Greater_out:PRIVATE:BOOL}"]
9 -> 10 [label = "t_12:{join_int_0:PRIVATE:INT64}"]
9 -> 10 [label = "t_13:{plain_datetime_0:PRIVATE:DATETIME}"]
}`, ``, testConf{groupThreshold: 0, batched: false},
	},
	{`SELECT ta.join_int_0, ta.plain_datetime_0 from alice.tbl_0 as ta right join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0 where ta.plain_datetime_0 between '2025-04-23 12:25:42' and '2025-05-29 15:36:36'`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_datetime_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:2,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,t_6,},],attr:[],party:[alice,]}"]
4 [label="make_constant:{in:[],out:[Out:{t_7,},],attr:[scalar:1745411142,],party:[alice,bob,carol,]}"]
5 [label="broadcast:{in:[In:{t_7,},ShapeRefTensor:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
7 [label="GreaterEqual:{in:[Left:{t_6,},Right:{t_8,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_11,},],attr:[scalar:1748532996,],party:[alice,bob,carol,]}"]
9 [label="broadcast:{in:[In:{t_11,},ShapeRefTensor:{t_6,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
11 [label="LessEqual:{in:[Left:{t_6,},Right:{t_12,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
12 [label="logical_and:{in:[Left:{t_10,},Right:{t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
13 [label="apply_filter:{in:[Filter:{t_15,},In:{t_5,t_6,},],out:[Out:{t_16,t_17,},],attr:[],party:[alice,]}"]
14 [label="publish:{in:[In:{t_16,t_17,},],out:[Out:{t_18,t_19,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_datetime_0:PRIVATE:DATETIME}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
11 -> 12 [label = "t_14:{LessEqual_out:PRIVATE:BOOL}"]
12 -> 13 [label = "t_15:{logical_and_out:PRIVATE:BOOL}"]
13 -> 14 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
13 -> 14 [label = "t_17:{plain_datetime_0:PRIVATE:DATETIME}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 11 [label = "t_6:{plain_datetime_0:PRIVATE:DATETIME}"]
3 -> 13 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 13 [label = "t_6:{plain_datetime_0:PRIVATE:DATETIME}"]
3 -> 5 [label = "t_6:{plain_datetime_0:PRIVATE:DATETIME}"]
3 -> 7 [label = "t_6:{plain_datetime_0:PRIVATE:DATETIME}"]
3 -> 9 [label = "t_6:{plain_datetime_0:PRIVATE:DATETIME}"]
4 -> 5 [label = "t_7:{constant_data:PUBLIC:INT64}"]
5 -> 7 [label = "t_8:{constant_data:PRIVATE:INT64}"]
7 -> 12 [label = "t_10:{GreaterEqual_out:PRIVATE:BOOL}"]
8 -> 9 [label = "t_11:{constant_data:PUBLIC:INT64}"]
9 -> 11 [label = "t_12:{constant_data:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false},
	},
	{`SELECT ta.join_int_0, ta.plain_datetime_0 from alice.tbl_0 as ta right join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0 where ta.plain_datetime_0 > '2025-04-23 12:25:42'`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_datetime_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:2,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,t_6,},],attr:[],party:[alice,]}"]
4 [label="make_constant:{in:[],out:[Out:{t_7,},],attr:[scalar:1745411142,],party:[alice,bob,carol,]}"]
5 [label="broadcast:{in:[In:{t_7,},ShapeRefTensor:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
7 [label="Greater:{in:[Left:{t_6,},Right:{t_8,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
8 [label="apply_filter:{in:[Filter:{t_10,},In:{t_5,t_6,},],out:[Out:{t_11,t_12,},],attr:[],party:[alice,]}"]
9 [label="publish:{in:[In:{t_11,t_12,},],out:[Out:{t_13,t_14,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_datetime_0:PRIVATE:DATETIME}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{plain_datetime_0:PRIVATE:DATETIME}"]
3 -> 7 [label = "t_6:{plain_datetime_0:PRIVATE:DATETIME}"]
3 -> 8 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_6:{plain_datetime_0:PRIVATE:DATETIME}"]
4 -> 5 [label = "t_7:{constant_data:PUBLIC:INT64}"]
5 -> 7 [label = "t_8:{constant_data:PRIVATE:INT64}"]
7 -> 8 [label = "t_10:{Greater_out:PRIVATE:BOOL}"]
8 -> 9 [label = "t_11:{join_int_0:PRIVATE:INT64}"]
8 -> 9 [label = "t_12:{plain_datetime_0:PRIVATE:DATETIME}"]
}`, ``, testConf{groupThreshold: 0, batched: false},
	},
	{`SELECT PERCENTILE_DISC(u.int_0, 0.3) AS _30percent FROM (SELECT ta.plain_int_0 as int_0 FROM alice.tbl_0 AS ta UNION ALL SELECT tb.plain_int_0 as int_0 FROM bob.tbl_0 AS tb) as u`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="reduce_percentile_disc:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[percent:0.3,],party:[alice,bob,carol,]}"]
6 [label="make_private:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
7 [label="publish:{in:[In:{t_6,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#241:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#241:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{Column#241:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#241:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#241:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#241:SECRET:INT64}"]
6 -> 7 [label = "t_6:{Column#241:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT PERCENTILE_DISC(ta.plain_int_0, 0.3) AS _30percent_plain_int FROM alice.tbl_0 AS ta JOIN bob.tbl_0 AS tb ON ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="reduce_percentile_disc:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[percent:0.3,],party:[alice,]}"]
5 [label="publish:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.groupby_string_0,tb.groupby_string_0, percentile_disc(ta.aggregate_int_0, 0.5) _50percent from alice.tbl_0 AS ta JOIN bob.tbl_0 AS tb ON ta.join_int_0 = tb.join_int_0 group by ta.groupby_string_0,tb.groupby_string_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select ta.aggregate_int_0,ta.groupby_string_0,ta.join_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,t_4,},],attr:[sql:select tb.groupby_string_0,tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_2,},Right:{t_4,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{t_6,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,t_8,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_6,},],out:[Out:{t_9,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_9,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="sort:{in:[In:{t_10,t_11,t_12,t_10,t_11,},Key:{t_10,t_11,},],out:[Out:{t_13,t_14,t_15,t_16,t_17,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
9 [label="group_mark:{in:[Key:{t_13,t_14,},],out:[Group:{t_18,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="sort:{in:[In:{t_15,},Key:{t_13,t_14,t_15,},],out:[Out:{t_19,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
11 [label="percentile_disc:{in:[Group:{t_18,},In:{t_19,},],out:[Out:{t_20,},],attr:[percent:0.5,],party:[alice,bob,carol,]}"]
12 [label="count:{in:[Group:{t_18,},In:{t_18,},],out:[Out:{t_21,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="shuffle:{in:[In:{t_20,t_16,t_17,t_21,t_18,},],out:[Out:{t_22,t_23,t_24,t_25,t_26,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_public:{in:[In:{t_26,},],out:[Out:{t_27,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="filter:{in:[Filter:{t_27,},In:{t_22,t_23,t_24,t_25,},],out:[Out:{t_28,t_29,t_30,t_31,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_constant:{in:[],out:[Out:{t_32,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
17 [label="broadcast:{in:[In:{t_32,},ShapeRefTensor:{t_31,},],out:[Out:{t_33,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="make_private:{in:[In:{t_31,},],out:[Out:{t_34,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
19 [label="make_private:{in:[In:{t_33,},],out:[Out:{t_35,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
20 [label="GreaterEqual:{in:[Left:{t_34,},Right:{t_35,},],out:[Out:{t_36,},],attr:[],party:[alice,]}"]
21 [label="make_public:{in:[In:{t_36,},],out:[Out:{t_37,},],attr:[],party:[alice,bob,carol,]}"]
22 [label="apply_filter:{in:[Filter:{t_37,},In:{t_29,t_30,t_28,t_31,},],out:[Out:{t_38,t_39,t_40,t_41,},],attr:[],party:[alice,bob,carol,]}"]
23 [label="make_private:{in:[In:{t_38,},],out:[Out:{t_42,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
24 [label="make_private:{in:[In:{t_39,},],out:[Out:{t_44,},],attr:[reveal_to:bob,],party:[alice,bob,carol,]}"]
25 [label="copy:{in:[In:{t_44,},],out:[Out:{t_45,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
26 [label="make_private:{in:[In:{t_40,},],out:[Out:{t_47,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
27 [label="publish:{in:[In:{t_42,t_45,t_47,},],out:[Out:{t_43,t_46,t_48,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{aggregate_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{groupby_string_0:PRIVATE:STRING}"]
1 -> 2 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{groupby_string_0:PRIVATE:STRING}"]
10 -> 11 [label = "t_19:{aggregate_int_0:SECRET:INT64}"]
11 -> 13 [label = "t_20:{aggregate_int_0:SECRET:INT64}"]
12 -> 13 [label = "t_21:{group_mark:SECRET:INT64}"]
13 -> 14 [label = "t_26:{group_mark:SECRET:BOOL}"]
13 -> 15 [label = "t_22:{aggregate_int_0:SECRET:INT64}"]
13 -> 15 [label = "t_23:{groupby_string_0:SECRET:STRING}"]
13 -> 15 [label = "t_24:{groupby_string_0:SECRET:STRING}"]
13 -> 15 [label = "t_25:{group_mark:SECRET:INT64}"]
14 -> 15 [label = "t_27:{group_mark:PUBLIC:BOOL}"]
15 -> 17 [label = "t_31:{group_mark:SECRET:INT64}"]
15 -> 18 [label = "t_31:{group_mark:SECRET:INT64}"]
15 -> 22 [label = "t_28:{aggregate_int_0:SECRET:INT64}"]
15 -> 22 [label = "t_29:{groupby_string_0:SECRET:STRING}"]
15 -> 22 [label = "t_30:{groupby_string_0:SECRET:STRING}"]
15 -> 22 [label = "t_31:{group_mark:SECRET:INT64}"]
16 -> 17 [label = "t_32:{constant_data:PUBLIC:INT64}"]
17 -> 19 [label = "t_33:{constant_data:PUBLIC:INT64}"]
18 -> 20 [label = "t_34:{group_mark:PRIVATE:INT64}"]
19 -> 20 [label = "t_35:{constant_data:PRIVATE:INT64}"]
2 -> 3 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
20 -> 21 [label = "t_36:{GreaterEqual_out:PRIVATE:BOOL}"]
21 -> 22 [label = "t_37:{GreaterEqual_out:PUBLIC:BOOL}"]
22 -> 23 [label = "t_38:{groupby_string_0:SECRET:STRING}"]
22 -> 24 [label = "t_39:{groupby_string_0:SECRET:STRING}"]
22 -> 26 [label = "t_40:{aggregate_int_0:SECRET:INT64}"]
23 -> 27 [label = "t_42:{groupby_string_0:PRIVATE:STRING}"]
24 -> 25 [label = "t_44:{groupby_string_0:PRIVATE:STRING}"]
25 -> 27 [label = "t_45:{groupby_string_0:PRIVATE:STRING}"]
26 -> 27 [label = "t_47:{aggregate_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_8:{groupby_string_0:PRIVATE:STRING}"]
3 -> 7 [label = "t_7:{aggregate_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_9:{groupby_string_0:PRIVATE:STRING}"]
5 -> 8 [label = "t_10:{groupby_string_0:SECRET:STRING}"]
5 -> 8 [label = "t_10:{groupby_string_0:SECRET:STRING}"]
5 -> 8 [label = "t_10:{groupby_string_0:SECRET:STRING}"]
6 -> 8 [label = "t_11:{groupby_string_0:SECRET:STRING}"]
6 -> 8 [label = "t_11:{groupby_string_0:SECRET:STRING}"]
6 -> 8 [label = "t_11:{groupby_string_0:SECRET:STRING}"]
7 -> 8 [label = "t_12:{aggregate_int_0:SECRET:INT64}"]
8 -> 10 [label = "t_13:{groupby_string_0:SECRET:STRING}"]
8 -> 10 [label = "t_14:{groupby_string_0:SECRET:STRING}"]
8 -> 10 [label = "t_15:{aggregate_int_0:SECRET:INT64}"]
8 -> 10 [label = "t_15:{aggregate_int_0:SECRET:INT64}"]
8 -> 13 [label = "t_16:{groupby_string_0:SECRET:STRING}"]
8 -> 13 [label = "t_17:{groupby_string_0:SECRET:STRING}"]
8 -> 9 [label = "t_13:{groupby_string_0:SECRET:STRING}"]
8 -> 9 [label = "t_14:{groupby_string_0:SECRET:STRING}"]
9 -> 11 [label = "t_18:{group_mark:SECRET:BOOL}"]
9 -> 12 [label = "t_18:{group_mark:SECRET:BOOL}"]
9 -> 12 [label = "t_18:{group_mark:SECRET:BOOL}"]
9 -> 13 [label = "t_18:{group_mark:SECRET:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT ta.join_int_0, PERCENTILE_DISC(ta.plain_int_0, 0.3) AS _30percent_plain_int FROM alice.tbl_0 AS ta JOIN bob.tbl_0 AS tb ON ta.join_int_0 = tb.join_int_0 GROUP BY ta.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,t_5,},],attr:[],party:[alice,]}"]
4 [label="group:{in:[Key:{t_4,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
5 [label="percentile_disc:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_5,},],out:[Out:{t_8,},],attr:[percent:0.3,],party:[alice,]}"]
6 [label="firstrow:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_4,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
7 [label="count:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_6,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_11,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
9 [label="broadcast:{in:[In:{t_11,},ShapeRefTensor:{t_10,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
10 [label="GreaterEqual:{in:[Left:{t_10,},Right:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
11 [label="apply_filter:{in:[Filter:{t_13,},In:{t_9,t_8,t_10,},],out:[Out:{t_14,t_15,t_16,},],attr:[],party:[alice,]}"]
12 [label="publish:{in:[In:{t_14,t_15,},],out:[Out:{t_17,t_18,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_13:{GreaterEqual_out:PRIVATE:BOOL}"]
11 -> 12 [label = "t_14:{join_int_0_firstrow:PRIVATE:INT64}"]
11 -> 12 [label = "t_15:{plain_int_0_percentile_disc:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 5 [label = "t_7:{group_num:PRIVATE:INT64}"]
4 -> 6 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{group_num:PRIVATE:INT64}"]
4 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 7 [label = "t_7:{group_num:PRIVATE:INT64}"]
5 -> 11 [label = "t_8:{plain_int_0_percentile_disc:PRIVATE:INT64}"]
6 -> 11 [label = "t_9:{join_int_0_firstrow:PRIVATE:INT64}"]
7 -> 10 [label = "t_10:{group_id_count:PRIVATE:INT64}"]
7 -> 11 [label = "t_10:{group_id_count:PRIVATE:INT64}"]
7 -> 9 [label = "t_10:{group_id_count:PRIVATE:INT64}"]
8 -> 9 [label = "t_11:{constant_data:PUBLIC:INT64}"]
9 -> 10 [label = "t_12:{constant_data:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT ta.join_int_0 FROM alice.tbl_0 AS ta JOIN bob.tbl_0 AS tb ON ta.join_int_0 = tb.join_int_0 GROUP BY ta.join_int_0 HAVING SUM(ta.plain_int_0) = ANY(SELECT ta.plain_int_0 FROM alice.tbl_0 AS ta)`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,t_5,},],attr:[],party:[alice,]}"]
4 [label="group:{in:[Key:{t_4,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
5 [label="sum:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_5,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
6 [label="firstrow:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_4,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
7 [label="count:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_6,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_11,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
9 [label="broadcast:{in:[In:{t_11,},ShapeRefTensor:{t_10,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
10 [label="GreaterEqual:{in:[Left:{t_10,},Right:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
11 [label="apply_filter:{in:[Filter:{t_13,},In:{t_9,t_8,t_10,},],out:[Out:{t_14,t_15,t_16,},],attr:[],party:[alice,]}"]
12 [label="runsql:{in:[],out:[Out:{t_17,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
13 [label="psi_in:{in:[Left:{t_15,},Right:{t_17,},],out:[Out:{t_18,},],attr:[in_type:2,input_party_codes:[alice alice],psi_algorithm:0,reveal_to:[alice],],party:[alice,]}"]
14 [label="apply_filter:{in:[Filter:{t_18,},In:{t_14,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
15 [label="publish:{in:[In:{t_19,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_13:{GreaterEqual_out:PRIVATE:BOOL}"]
11 -> 13 [label = "t_15:{plain_int_0_sum:PRIVATE:INT64}"]
11 -> 14 [label = "t_14:{join_int_0_firstrow:PRIVATE:INT64}"]
12 -> 13 [label = "t_17:{plain_int_0:PRIVATE:INT64}"]
13 -> 14 [label = "t_18:{psi_in_out:PRIVATE:BOOL}"]
14 -> 15 [label = "t_19:{join_int_0_firstrow:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 5 [label = "t_7:{group_num:PRIVATE:INT64}"]
4 -> 6 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{group_num:PRIVATE:INT64}"]
4 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 7 [label = "t_7:{group_num:PRIVATE:INT64}"]
5 -> 11 [label = "t_8:{plain_int_0_sum:PRIVATE:INT64}"]
6 -> 11 [label = "t_9:{join_int_0_firstrow:PRIVATE:INT64}"]
7 -> 10 [label = "t_10:{group_id_count:PRIVATE:INT64}"]
7 -> 11 [label = "t_10:{group_id_count:PRIVATE:INT64}"]
7 -> 9 [label = "t_10:{group_id_count:PRIVATE:INT64}"]
8 -> 9 [label = "t_11:{constant_data:PUBLIC:INT64}"]
9 -> 10 [label = "t_12:{constant_data:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT ta.join_int_0 FROM alice.tbl_0 AS ta JOIN bob.tbl_0 AS tb ON ta.join_int_0 = tb.join_int_0 GROUP BY ta.join_int_0 HAVING SUM(ta.plain_int_0) > ANY(SELECT ta.plain_int_0 FROM alice.tbl_0 AS ta)`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,t_5,},],attr:[],party:[alice,]}"]
4 [label="group:{in:[Key:{t_4,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
5 [label="sum:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_5,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
6 [label="firstrow:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_4,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
7 [label="count:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_6,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_11,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
9 [label="broadcast:{in:[In:{t_11,},ShapeRefTensor:{t_10,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
10 [label="GreaterEqual:{in:[Left:{t_10,},Right:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
11 [label="apply_filter:{in:[Filter:{t_13,},In:{t_9,t_8,t_10,},],out:[Out:{t_14,t_15,t_16,},],attr:[],party:[alice,]}"]
12 [label="runsql:{in:[],out:[Out:{t_17,},],attr:[sql:select min(ta.plain_int_0) as expr_362 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
13 [label="Replicate:{in:[Left:{t_15,t_14,t_16,},Right:{t_17,},],out:[LeftOut:{t_18,t_19,t_20,},RightOut:{t_21,},],attr:[input_party_codes:[alice alice],],party:[alice,]}"]
14 [label="Greater:{in:[Left:{t_18,},Right:{t_21,},],out:[Out:{t_22,},],attr:[],party:[alice,]}"]
15 [label="apply_filter:{in:[Filter:{t_22,},In:{t_19,},],out:[Out:{t_23,},],attr:[],party:[alice,]}"]
16 [label="publish:{in:[In:{t_23,},],out:[Out:{t_24,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_13:{GreaterEqual_out:PRIVATE:BOOL}"]
11 -> 13 [label = "t_14:{join_int_0_firstrow:PRIVATE:INT64}"]
11 -> 13 [label = "t_15:{plain_int_0_sum:PRIVATE:INT64}"]
11 -> 13 [label = "t_16:{group_id_count:PRIVATE:INT64}"]
12 -> 13 [label = "t_17:{Column#362:PRIVATE:INT64}"]
13 -> 14 [label = "t_18:{plain_int_0_sum:PRIVATE:INT64}"]
13 -> 14 [label = "t_21:{Column#362:PRIVATE:INT64}"]
13 -> 15 [label = "t_19:{join_int_0_firstrow:PRIVATE:INT64}"]
14 -> 15 [label = "t_22:{Greater_out:PRIVATE:BOOL}"]
15 -> 16 [label = "t_23:{join_int_0_firstrow:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 5 [label = "t_7:{group_num:PRIVATE:INT64}"]
4 -> 6 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{group_num:PRIVATE:INT64}"]
4 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 7 [label = "t_7:{group_num:PRIVATE:INT64}"]
5 -> 11 [label = "t_8:{plain_int_0_sum:PRIVATE:INT64}"]
6 -> 11 [label = "t_9:{join_int_0_firstrow:PRIVATE:INT64}"]
7 -> 10 [label = "t_10:{group_id_count:PRIVATE:INT64}"]
7 -> 11 [label = "t_10:{group_id_count:PRIVATE:INT64}"]
7 -> 9 [label = "t_10:{group_id_count:PRIVATE:INT64}"]
8 -> 9 [label = "t_11:{constant_data:PUBLIC:INT64}"]
9 -> 10 [label = "t_12:{constant_data:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT ta.join_int_0, PERCENT_RANK() OVER(PARTITION BY ta.rank_float_0 ORDER BY tb.rank_float_0) as rank_percent FROM alice.tbl_0 AS ta JOIN bob.tbl_0 AS tb ON ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.rank_float_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.join_int_0,tb.rank_float_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_9,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="sort:{in:[In:{t_9,t_11,},Key:{t_9,t_10,},],out:[Out:{t_12,t_13,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
9 [label="partition_mark:{in:[Key:{t_12,},],out:[Group:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="percent_rank:{in:[Group:{t_14,},In:{t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_private:{in:[In:{t_13,},],out:[Out:{t_16,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
12 [label="make_private:{in:[In:{t_15,},],out:[Out:{t_18,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
13 [label="publish:{in:[In:{t_16,t_18,},],out:[Out:{t_17,t_19,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{rank_float_0:PRIVATE:FLOAT32}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{rank_float_0:PRIVATE:FLOAT32}"]
10 -> 12 [label = "t_15:{group_mark:SECRET:FLOAT64}"]
11 -> 13 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
12 -> 13 [label = "t_18:{group_mark:PRIVATE:FLOAT64}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_7:{rank_float_0:PRIVATE:FLOAT32}"]
3 -> 7 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_8:{rank_float_0:PRIVATE:FLOAT32}"]
5 -> 8 [label = "t_9:{rank_float_0:SECRET:FLOAT32}"]
5 -> 8 [label = "t_9:{rank_float_0:SECRET:FLOAT32}"]
6 -> 8 [label = "t_10:{rank_float_0:SECRET:FLOAT32}"]
7 -> 8 [label = "t_11:{join_int_0:SECRET:INT64}"]
8 -> 11 [label = "t_13:{join_int_0:SECRET:INT64}"]
8 -> 9 [label = "t_12:{rank_float_0:SECRET:FLOAT32}"]
9 -> 10 [label = "t_14:{group_mark:SECRET:BOOL}"]
9 -> 10 [label = "t_14:{group_mark:SECRET:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT ta.join_int_0, PERCENT_RANK() OVER(PARTITION BY ta.join_int_0 ORDER BY ta.plain_int_0) as rank_percent FROM alice.tbl_0 AS ta JOIN bob.tbl_0 AS tb ON ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,t_5,},],attr:[],party:[alice,]}"]
4 [label="group:{in:[Key:{t_4,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
5 [label="PercentRank:{in:[Key:{t_5,},PartitionId:{t_6,},PartitionNum:{t_7,},],out:[Out:{t_8,},],attr:[reverse:[0],],party:[alice,]}"]
6 [label="publish:{in:[In:{t_4,t_8,},],out:[Out:{t_9,t_10,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_6:{group_id:PRIVATE:INT64}"]
4 -> 5 [label = "t_7:{group_num:PRIVATE:INT64}"]
5 -> 6 [label = "t_8:{Out:PRIVATE:FLOAT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT ta.join_int_0 FROM
		alice.tbl_0 AS ta INNER JOIN bob.tbl_0 AS tb
		ON ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.join_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="publish:{in:[In:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select alice.plain_int_0 from alice.tbl_0 as alice join bob.tbl_0 as bob on alice.join_int_0 = bob.join_int_0 where alice.join_string_0 is null`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.join_int_0,alice.plain_int_0 from alice.tbl_0 as alice where alice.join_string_0 is null;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select bob.join_int_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="publish:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT ta.plain_int_0 FROM alice.tbl_0 AS ta INNER JOIN bob.tbl_0 AS tb ON ta.join_int_0 = tb.join_int_0 where ta.plain_int_0 > tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.join_int_0,tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_7,},],out:[Out:{t_8,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="Greater:{in:[Left:{t_6,},Right:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
7 [label="apply_filter:{in:[Filter:{t_9,},In:{t_6,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_9:{Greater_out:PRIVATE:BOOL}"]
7 -> 8 [label = "t_10:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT ta.plain_int_0 FROM alice.tbl_0 as ta WHERE ta.plain_int_0 = ANY(SELECT ta.plain_int_0 + ta.plain_int_1 + 1 FROM alice.tbl_0 AS ta INNER JOIN bob.tbl_0 AS tb ON ta.plain_int_0 = tb.plain_int_0)`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,t_2,},],attr:[sql:select ta.plain_int_0,ta.plain_int_1 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
2 [label="runsql:{in:[],out:[Out:{t_3,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
3 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_5,t_6,},],attr:[],party:[alice,]}"]
5 [label="Add:{in:[Left:{t_5,},Right:{t_6,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
6 [label="make_constant:{in:[],out:[Out:{t_8,},],attr:[scalar:1,],party:[alice,bob,carol,]}"]
7 [label="broadcast:{in:[In:{t_8,},ShapeRefTensor:{t_7,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
8 [label="Add:{in:[Left:{t_7,},Right:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
9 [label="psi_in:{in:[Left:{t_0,},Right:{t_10,},],out:[Out:{t_11,},],attr:[in_type:2,input_party_codes:[alice alice],psi_algorithm:0,reveal_to:[alice],],party:[alice,]}"]
10 [label="apply_filter:{in:[Filter:{t_11,},In:{t_0,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
11 [label="publish:{in:[In:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
0 -> 10 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 9 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{plain_int_1:PRIVATE:INT64}"]
10 -> 11 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_6:{plain_int_1:PRIVATE:INT64}"]
5 -> 7 [label = "t_7:{Add_out:PRIVATE:INT64}"]
5 -> 8 [label = "t_7:{Add_out:PRIVATE:INT64}"]
6 -> 7 [label = "t_8:{constant_data:PUBLIC:INT64}"]
7 -> 8 [label = "t_9:{constant_data:PRIVATE:INT64}"]
8 -> 9 [label = "t_10:{Add_out:PRIVATE:INT64}"]
9 -> 10 [label = "t_11:{psi_in_out:PRIVATE:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT ta.plain_int_0 FROM alice.tbl_0 as ta WHERE ta.plain_int_0 > (SELECT AVG(ta.plain_int_0) + SUM(ta.plain_int_1) + 1 FROM alice.tbl_0 AS ta INNER JOIN bob.tbl_0 AS tb ON ta.plain_int_0 = tb.plain_int_0)`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,t_2,},],attr:[sql:select ta.plain_int_0,ta.plain_int_1 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
2 [label="runsql:{in:[],out:[Out:{t_3,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
3 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_5,t_6,},],attr:[],party:[alice,]}"]
5 [label="reduce_avg:{in:[In:{t_5,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
6 [label="reduce_sum:{in:[In:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
7 [label="Add:{in:[Left:{t_7,},Right:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_10,},],attr:[scalar:1,],party:[alice,bob,carol,]}"]
9 [label="broadcast:{in:[In:{t_10,},ShapeRefTensor:{t_9,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
10 [label="Add:{in:[Left:{t_9,},Right:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
11 [label="Replicate:{in:[Left:{t_0,},Right:{t_12,},],out:[LeftOut:{t_13,},RightOut:{t_14,},],attr:[input_party_codes:[alice alice],],party:[alice,]}"]
12 [label="Greater:{in:[Left:{t_13,},Right:{t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
13 [label="apply_filter:{in:[Filter:{t_15,},In:{t_13,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
14 [label="publish:{in:[In:{t_16,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
0 -> 11 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{plain_int_1:PRIVATE:INT64}"]
10 -> 11 [label = "t_12:{Add_out:PRIVATE:FLOAT64}"]
11 -> 12 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
11 -> 12 [label = "t_14:{Add_out:PRIVATE:FLOAT64}"]
11 -> 13 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
12 -> 13 [label = "t_15:{Greater_out:PRIVATE:BOOL}"]
13 -> 14 [label = "t_16:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_6:{plain_int_1:PRIVATE:INT64}"]
5 -> 7 [label = "t_7:{plain_int_0:PRIVATE:FLOAT64}"]
6 -> 7 [label = "t_8:{plain_int_1:PRIVATE:INT64}"]
7 -> 10 [label = "t_9:{Add_out:PRIVATE:FLOAT64}"]
7 -> 9 [label = "t_9:{Add_out:PRIVATE:FLOAT64}"]
8 -> 9 [label = "t_10:{constant_data:PUBLIC:INT64}"]
9 -> 10 [label = "t_11:{constant_data:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT GREATEST(ta.plain_int_0, tb.plain_float_0), LEAST(ta.plain_int_0, tb.plain_int_0), GREATEST(ta.plain_timestamp_0, tb.plain_timestamp_0) FROM alice.tbl_0 as ta INNER JOIN bob.tbl_0 as tb ON ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select ta.join_int_0,ta.plain_int_0,ta.plain_timestamp_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,t_4,t_5,t_6,},],attr:[sql:select tb.join_int_0,tb.plain_float_0,tb.plain_int_0,tb.plain_timestamp_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_3,},],out:[LeftJoinIndex:{t_7,},RightJoinIndex:{t_8,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,t_2,},RowsIndexFilter:{t_7,},],out:[Out:{t_9,t_10,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_4,t_5,t_6,},RowsIndexFilter:{t_8,},],out:[Out:{t_11,t_12,t_13,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_11,},],out:[Out:{t_14,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="Greatest:{in:[In:{t_9,t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
7 [label="copy:{in:[In:{t_12,},],out:[Out:{t_16,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="Least:{in:[In:{t_9,t_16,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
9 [label="copy:{in:[In:{t_13,},],out:[Out:{t_18,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
10 [label="Greatest:{in:[In:{t_10,t_18,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
11 [label="publish:{in:[In:{t_15,t_17,t_19,},],out:[Out:{t_20,t_21,t_22,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{plain_timestamp_0:PRIVATE:TIMESTAMP}"]
1 -> 2 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{plain_float_0:PRIVATE:FLOAT32}"]
1 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_6:{plain_timestamp_0:PRIVATE:TIMESTAMP}"]
10 -> 11 [label = "t_19:{plain_timestamp_0:PRIVATE:TIMESTAMP}"]
2 -> 3 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_8:{join_int_0:PRIVATE:INT64}"]
3 -> 10 [label = "t_10:{plain_timestamp_0:PRIVATE:TIMESTAMP}"]
3 -> 6 [label = "t_9:{plain_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_9:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_11:{plain_float_0:PRIVATE:FLOAT32}"]
4 -> 7 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_13:{plain_timestamp_0:PRIVATE:TIMESTAMP}"]
5 -> 6 [label = "t_14:{plain_float_0:PRIVATE:FLOAT32}"]
6 -> 11 [label = "t_15:{plain_int_0:PRIVATE:FLOAT64}"]
7 -> 8 [label = "t_16:{plain_int_0:PRIVATE:INT64}"]
8 -> 11 [label = "t_17:{plain_int_0:PRIVATE:INT64}"]
9 -> 10 [label = "t_18:{plain_timestamp_0:PRIVATE:TIMESTAMP}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT POW(ta.plain_int_0, 2) as pow_2_int, POW(ta.plain_float_0, 3) as pow_3_float  FROM
	alice.tbl_0 AS ta INNER JOIN bob.tbl_0 AS tb
	ON ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select ta.join_int_0,ta.plain_float_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_5,t_6,},],attr:[],party:[alice,]}"]
4 [label="make_constant:{in:[],out:[Out:{t_7,},],attr:[scalar:2,],party:[alice,bob,carol,]}"]
5 [label="broadcast:{in:[In:{t_7,},ShapeRefTensor:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
6 [label="Pow:{in:[Left:{t_6,},Right:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
7 [label="make_constant:{in:[],out:[Out:{t_10,},],attr:[scalar:3,],party:[alice,bob,carol,]}"]
8 [label="broadcast:{in:[In:{t_10,},ShapeRefTensor:{t_5,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
9 [label="Pow:{in:[Left:{t_5,},Right:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
10 [label="publish:{in:[In:{t_9,t_12,},],out:[Out:{t_13,t_14,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_float_0:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_5:{plain_float_0:PRIVATE:FLOAT32}"]
3 -> 9 [label = "t_5:{plain_float_0:PRIVATE:FLOAT32}"]
4 -> 5 [label = "t_7:{constant_data:PUBLIC:INT64}"]
5 -> 6 [label = "t_8:{constant_data:PRIVATE:INT64}"]
6 -> 10 [label = "t_9:{Pow_out:PRIVATE:INT64}"]
7 -> 8 [label = "t_10:{constant_data:PUBLIC:INT64}"]
8 -> 9 [label = "t_11:{constant_data:PRIVATE:INT64}"]
9 -> 10 [label = "t_12:{Pow_out:PRIVATE:FLOAT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT ATAN2(ta.plain_int_0, tb.plain_int_0) as atan2_plain_int FROM
	alice.tbl_0 AS ta INNER JOIN bob.tbl_0 AS tb
	ON ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.join_int_0,tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_7,},],out:[Out:{t_8,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="ATan2:{in:[Left:{t_6,},Right:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
7 [label="publish:{in:[In:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_9:{ATan2_out:PRIVATE:FLOAT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`SELECT ta.join_int_0, TAN(ta.plain_int_0) AS tan_plain_int_0, TAN(ta.plain_float_0) AS tan_plain_float_0,
	COT(ta.plain_int_0) AS cot_plain_int_0, COT(ta.plain_float_0) AS cot_plain_float_0,
	ASIN(ta.plain_int_0) AS asin_plain_int_0, ASIN(ta.plain_float_0) AS asin_plain_float_0,
	ATAN(ta.plain_int_0) AS atan_plain_int_0, ATAN(ta.plain_float_0) AS atan_plain_float_0
		FROM alice.tbl_0 as ta INNER JOIN bob.tbl_0 as tb
		ON ta.join_int_0 = tb.join_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select ta.join_int_0,ta.plain_float_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_5,t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="Tan:{in:[In:{t_7,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
5 [label="Tan:{in:[In:{t_6,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
6 [label="make_constant:{in:[],out:[Out:{t_10,},],attr:[scalar:1,],party:[alice,bob,carol,]}"]
7 [label="Tan:{in:[In:{t_7,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
8 [label="broadcast:{in:[In:{t_10,},ShapeRefTensor:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
9 [label="Div:{in:[Left:{t_12,},Right:{t_11,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
10 [label="make_constant:{in:[],out:[Out:{t_14,},],attr:[scalar:1,],party:[alice,bob,carol,]}"]
11 [label="Tan:{in:[In:{t_6,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
12 [label="broadcast:{in:[In:{t_14,},ShapeRefTensor:{t_15,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
13 [label="Div:{in:[Left:{t_16,},Right:{t_15,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
14 [label="ASin:{in:[In:{t_7,},],out:[Out:{t_18,},],attr:[],party:[alice,]}"]
15 [label="ASin:{in:[In:{t_6,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
16 [label="ATan:{in:[In:{t_7,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
17 [label="ATan:{in:[In:{t_6,},],out:[Out:{t_21,},],attr:[],party:[alice,]}"]
18 [label="publish:{in:[In:{t_5,t_8,t_9,t_13,t_17,t_18,t_19,t_20,t_21,},],out:[Out:{t_22,t_23,t_24,t_25,t_26,t_27,t_28,t_29,t_30,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_float_0:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
10 -> 12 [label = "t_14:{constant_data:PUBLIC:INT64}"]
11 -> 12 [label = "t_15:{plain_float_0:PRIVATE:FLOAT64}"]
11 -> 13 [label = "t_15:{plain_float_0:PRIVATE:FLOAT64}"]
12 -> 13 [label = "t_16:{constant_data:PRIVATE:INT64}"]
13 -> 18 [label = "t_17:{Div_out:PRIVATE:FLOAT64}"]
14 -> 18 [label = "t_18:{plain_int_0:PRIVATE:FLOAT64}"]
15 -> 18 [label = "t_19:{plain_float_0:PRIVATE:FLOAT64}"]
16 -> 18 [label = "t_20:{plain_int_0:PRIVATE:FLOAT64}"]
17 -> 18 [label = "t_21:{plain_float_0:PRIVATE:FLOAT64}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
3 -> 11 [label = "t_6:{plain_float_0:PRIVATE:FLOAT32}"]
3 -> 14 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
3 -> 15 [label = "t_6:{plain_float_0:PRIVATE:FLOAT32}"]
3 -> 16 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
3 -> 17 [label = "t_6:{plain_float_0:PRIVATE:FLOAT32}"]
3 -> 18 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{plain_float_0:PRIVATE:FLOAT32}"]
3 -> 7 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
4 -> 18 [label = "t_8:{plain_int_0:PRIVATE:FLOAT64}"]
5 -> 18 [label = "t_9:{plain_float_0:PRIVATE:FLOAT64}"]
6 -> 8 [label = "t_10:{constant_data:PUBLIC:INT64}"]
7 -> 8 [label = "t_11:{plain_int_0:PRIVATE:FLOAT64}"]
7 -> 9 [label = "t_11:{plain_int_0:PRIVATE:FLOAT64}"]
8 -> 9 [label = "t_12:{constant_data:PRIVATE:INT64}"]
9 -> 18 [label = "t_13:{Div_out:PRIVATE:FLOAT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.join_int_0, ta.aggregate_string_0, tu.plain_float_0 from alice.tbl_0 as ta inner join (select tb.join_int_0, tb.plain_float_0 from bob.tbl_0 as tb union all select tc.join_int_0, tc.plain_float_0 from carol.tbl_0 as tc) as tu on ta.join_int_0=tu.join_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.aggregate_string_0,ta.join_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.join_int_0,tb.plain_float_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="runsql:{in:[],out:[Out:{t_4,t_5,},],attr:[sql:select tc.join_int_0,tc.plain_float_0 from carol.tbl_0 as tc;,table_refs:[carol.tbl_0],],party:[carol,]}"]
3 [label="make_share:{in:[In:{t_2,},],out:[Out:{t_6,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="make_share:{in:[In:{t_4,},],out:[Out:{t_7,},],attr:[],party:[alice,bob,carol,]}"]
5 [label="concat:{in:[In:{t_6,t_7,},],out:[Out:{t_8,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_3,},],out:[Out:{t_9,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_5,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="concat:{in:[In:{t_9,t_10,},],out:[Out:{t_11,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
9 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="secret_join:{in:[Left:{t_13,t_12,},LeftKey:{t_12,},Right:{t_11,},RightKey:{t_8,},],out:[LeftOutput:{t_14,t_15,},RightOutput:{t_16,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_private:{in:[In:{t_15,},],out:[Out:{t_17,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
13 [label="make_private:{in:[In:{t_14,},],out:[Out:{t_19,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
14 [label="make_private:{in:[In:{t_16,},],out:[Out:{t_21,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
15 [label="publish:{in:[In:{t_17,t_19,t_21,},],out:[Out:{t_18,t_20,t_22,},],attr:[],party:[alice,]}"]
0 -> 10 [label = "t_0:{aggregate_string_0:PRIVATE:STRING}"]
0 -> 9 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_2:{Column#361:PRIVATE:INT64}"]
1 -> 6 [label = "t_3:{Column#362:PRIVATE:FLOAT32}"]
10 -> 11 [label = "t_13:{aggregate_string_0:SECRET:STRING}"]
11 -> 12 [label = "t_15:{join_int_0:SECRET:INT64}"]
11 -> 13 [label = "t_14:{aggregate_string_0:SECRET:STRING}"]
11 -> 14 [label = "t_16:{Column#362:SECRET:FLOAT32}"]
12 -> 15 [label = "t_17:{join_int_0:PRIVATE:INT64}"]
13 -> 15 [label = "t_19:{aggregate_string_0:PRIVATE:STRING}"]
14 -> 15 [label = "t_21:{Column#362:PRIVATE:FLOAT32}"]
2 -> 4 [label = "t_4:{Column#361:PRIVATE:INT64}"]
2 -> 7 [label = "t_5:{Column#362:PRIVATE:FLOAT32}"]
3 -> 5 [label = "t_6:{Column#361:SECRET:INT64}"]
4 -> 5 [label = "t_7:{Column#361:SECRET:INT64}"]
5 -> 11 [label = "t_8:{Column#361:SECRET:INT64}"]
6 -> 8 [label = "t_9:{Column#362:SECRET:FLOAT32}"]
7 -> 8 [label = "t_10:{Column#362:SECRET:FLOAT32}"]
8 -> 11 [label = "t_11:{Column#362:SECRET:FLOAT32}"]
9 -> 11 [label = "t_12:{join_int_0:SECRET:INT64}"]
9 -> 11 [label = "t_12:{join_int_0:SECRET:INT64}"]
}`, `
pipeline 0 {
Batched: false
node: [runsql_0 runsql_1 runsql_2]
Inputs: []
Outputs: [t_0 t_1 t_2 t_3 t_4 t_5]
}
pipeline 1 {
Batched: false
node: [make_share_3 make_share_4]
Inputs: [t_2 t_4]
Outputs: [t_6 t_7]
}
pipeline 2 {
Batched: false
node: [concat_5]
Inputs: [t_6 t_7]
Outputs: [t_8]
}
pipeline 3 {
Batched: false
node: [make_share_6 make_share_7]
Inputs: [t_3 t_5]
Outputs: [t_10 t_9]
}
pipeline 4 {
Batched: false
node: [concat_8]
Inputs: [t_10 t_9]
Outputs: [t_11]
}
pipeline 5 {
Batched: false
node: [make_share_9 make_share_10]
Inputs: [t_0 t_1]
Outputs: [t_12 t_13]
}
pipeline 6 {
Batched: false
node: [secret_join_11]
Inputs: [t_11 t_12 t_13 t_8]
Outputs: [t_14 t_15 t_16]
}
pipeline 7 {
Batched: false
node: [make_private_12 make_private_13 make_private_14]
Inputs: [t_14 t_15 t_16]
Outputs: [t_17 t_19 t_21]
}
pipeline 8 {
Batched: false
node: [publish_15]
Inputs: [t_17 t_19 t_21]
Outputs: []
}
`, testConf{groupThreshold: 0, batched: true, revealGroupCount: false}},
	{`select ta.plain_int_0, ta.plain_int_0 in (select tb.plain_int_0 from bob.tbl_0 as tb) from alice.tbl_0 as ta`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="bucket:{in:[In:{t_0,},Key:{t_0,},],out:[Out:{t_2,},],attr:[input_party_codes:[alice bob],],party:[alice,]}"]
3 [label="bucket:{in:[In:{t_1,},Key:{t_1,},],out:[Out:{t_3,},],attr:[input_party_codes:[alice bob],],party:[bob,]}"]
4 [label="psi_in:{in:[Left:{t_2,},Right:{t_3,},],out:[Out:{t_4,},],attr:[in_type:0,input_party_codes:[alice bob],psi_algorithm:0,reveal_to:[alice],],party:[alice,bob,]}"]
5 [label="publish:{in:[In:{t_2,t_4,},],out:[Out:{t_5,t_6,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 5 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_4:{psi_in_out:PRIVATE:BOOL}"]
}`, `
pipeline 0 {
Batched: false
node: [runsql_0 runsql_1 bucket_2 bucket_3]
Inputs: []
Outputs: [t_2 t_3]
}
pipeline 1 {
Batched: true
node: [psi_in_4]
Inputs: [t_2 t_3]
Outputs: [t_4]
}
pipeline 2 {
Batched: false
node: [publish_5]
Inputs: [t_2 t_4]
Outputs: []
}
`, testConf{groupThreshold: 0, batched: true, revealGroupCount: false}},
	{`select ta.plain_int_0 from alice.tbl_0 as ta where ta.plain_int_0 in (select tb.plain_int_0 from bob.tbl_0 as tb)`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="bucket:{in:[In:{t_0,},Key:{t_0,},],out:[Out:{t_2,},],attr:[input_party_codes:[alice bob],],party:[alice,]}"]
3 [label="bucket:{in:[In:{t_1,},Key:{t_1,},],out:[Out:{t_3,},],attr:[input_party_codes:[alice bob],],party:[bob,]}"]
4 [label="psi_in:{in:[Left:{t_2,},Right:{t_3,},],out:[Out:{t_4,},],attr:[in_type:0,input_party_codes:[alice bob],psi_algorithm:0,reveal_to:[alice],],party:[alice,bob,]}"]
5 [label="apply_filter:{in:[Filter:{t_4,},In:{t_2,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
6 [label="publish:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 5 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_4:{psi_in_out:PRIVATE:BOOL}"]
5 -> 6 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
}`, `
pipeline 0 {
Batched: false
node: [runsql_0 runsql_1 bucket_2 bucket_3]
Inputs: []
Outputs: [t_2 t_3]
}
pipeline 1 {
Batched: true
node: [psi_in_4 apply_filter_5]
Inputs: [t_2 t_3]
Outputs: [t_5]
}
pipeline 2 {
Batched: false
node: [publish_6]
Inputs: [t_5]
Outputs: []
}
`, testConf{groupThreshold: 0, batched: true, revealGroupCount: false}},
	{`select ta.plain_int_0 in (select tb.plain_int_0 from bob.tbl_0 as tb) and ta.plain_int_1 in (select tb.plain_int_1 from bob.tbl_0 as tb) from alice.tbl_0 as ta`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.plain_int_0,ta.plain_int_1 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="psi_in:{in:[Left:{t_0,},Right:{t_2,},],out:[Out:{t_3,},],attr:[in_type:0,input_party_codes:[alice bob],psi_algorithm:0,reveal_to:[alice],],party:[alice,bob,]}"]
3 [label="runsql:{in:[],out:[Out:{t_4,},],attr:[sql:select tb.plain_int_1 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
4 [label="psi_in:{in:[Left:{t_1,},Right:{t_4,},],out:[Out:{t_5,},],attr:[in_type:0,input_party_codes:[alice bob],psi_algorithm:0,reveal_to:[alice],],party:[alice,bob,]}"]
5 [label="LogicalAnd:{in:[Left:{t_3,},Right:{t_5,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
6 [label="publish:{in:[In:{t_6,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 4 [label = "t_1:{plain_int_1:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 5 [label = "t_3:{psi_in_out:PRIVATE:BOOL}"]
3 -> 4 [label = "t_4:{plain_int_1:PRIVATE:INT64}"]
4 -> 5 [label = "t_5:{psi_in_out:PRIVATE:BOOL}"]
5 -> 6 [label = "t_6:{LogicalAnd_out:PRIVATE:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select if(ta.plain_float_0, -1.0, -ta.plain_float_0) as res from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_float_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="make_constant:{in:[],out:[Out:{t_5,},],attr:[scalar:-1,],party:[alice,bob,carol,]}"]
5 [label="make_constant:{in:[],out:[Out:{t_6,},],attr:[scalar:0,],party:[alice,bob,carol,]}"]
6 [label="broadcast:{in:[In:{t_6,},ShapeRefTensor:{t_4,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
7 [label="Minus:{in:[Left:{t_7,},Right:{t_4,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="broadcast:{in:[In:{t_5,},ShapeRefTensor:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
9 [label="If:{in:[Condition:{t_4,},ValueIfFalse:{t_8,},ValueIfTrue:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
10 [label="publish:{in:[In:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_float_0:PRIVATE:FLOAT32}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{plain_float_0:PRIVATE:FLOAT32}"]
3 -> 7 [label = "t_4:{plain_float_0:PRIVATE:FLOAT32}"]
3 -> 9 [label = "t_4:{plain_float_0:PRIVATE:FLOAT32}"]
4 -> 8 [label = "t_5:{constant_data:PUBLIC:FLOAT64}"]
5 -> 6 [label = "t_6:{constant_data:PUBLIC:INT64}"]
6 -> 7 [label = "t_7:{constant_data:PRIVATE:INT64}"]
7 -> 8 [label = "t_8:{Minus_out:PRIVATE:FLOAT64}"]
7 -> 9 [label = "t_8:{Minus_out:PRIVATE:FLOAT64}"]
8 -> 9 [label = "t_9:{constant_data:PRIVATE:FLOAT64}"]
9 -> 10 [label = "t_10:{constant_data:PRIVATE:FLOAT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`(SELECT count(alice.groupby_int_1) as test1 FROM alice.tbl_0 as alice WHERE alice.groupby_int_0 >= 0 GROUP BY alice.groupby_int_1 HAVING test1 > 0  limit 3) union all (select count(bob.groupby_int_0) as test1 FROM bob.tbl_0 as bob WHERE bob.groupby_int_0 >= 0  limit 3);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select t_0.test1 from (select count(alice.groupby_int_1) as test1 from alice.tbl_0 as alice where alice.groupby_int_0>=0 group by alice.groupby_int_1 having (count(alice.groupby_int_1)>0) and (count(alice.groupby_int_1)>=4) limit 3) as t_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select t_0.expr_121 from (select count(bob.groupby_int_0) as expr_121 from bob.tbl_0 as bob where bob.groupby_int_0>=0 limit 3) as t_0;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_private:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
6 [label="publish:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#243:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#243:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{Column#243:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#243:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#243:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#243:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`(SELECT alice.groupby_int_1 is not null as c1, coalesce(alice.compare_float_0, alice.plain_float_1) as c2, ifnull(alice.join_string_0, "null") as c3 FROM alice.tbl_0 as alice join bob.tbl_0 as bob on alice.join_string_0=bob.join_string_0);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,t_3,},],attr:[sql:select alice.compare_float_0,alice.groupby_int_1,alice.join_string_0,alice.plain_float_1 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_4,},],attr:[sql:select bob.join_string_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_2,},Right:{t_4,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_6,t_7,t_8,t_9,},],attr:[],party:[alice,]}"]
4 [label="is_null:{in:[In:{t_7,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
5 [label="not:{in:[In:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
6 [label="coalesce:{in:[Exprs:{t_6,t_9,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
7 [label="make_constant:{in:[],out:[Out:{t_13,},],attr:[scalar:null,],party:[alice,bob,carol,]}"]
8 [label="broadcast:{in:[In:{t_13,},ShapeRefTensor:{t_8,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
9 [label="ifnull:{in:[AltValue:{t_14,},Expr:{t_8,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
10 [label="publish:{in:[In:{t_11,t_12,t_15,},],out:[Out:{t_16,t_17,t_18,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_2:{join_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_0:{compare_float_0:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_1:{groupby_int_1:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{join_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_3:{plain_float_1:PRIVATE:FLOAT32}"]
1 -> 2 [label = "t_4:{join_string_0:PRIVATE:STRING}"]
2 -> 3 [label = "t_5:{join_string_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_7:{groupby_int_1:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{compare_float_0:PRIVATE:FLOAT32}"]
3 -> 6 [label = "t_9:{plain_float_1:PRIVATE:FLOAT32}"]
3 -> 8 [label = "t_8:{join_string_0:PRIVATE:STRING}"]
3 -> 9 [label = "t_8:{join_string_0:PRIVATE:STRING}"]
4 -> 5 [label = "t_10:{isnull_out:PRIVATE:BOOL}"]
5 -> 10 [label = "t_11:{isnull_out:PRIVATE:BOOL}"]
6 -> 10 [label = "t_12:{coalesce_out:PRIVATE:FLOAT64}"]
7 -> 8 [label = "t_13:{constant_data:PUBLIC:STRING}"]
8 -> 9 [label = "t_14:{constant_data:PRIVATE:STRING}"]
9 -> 10 [label = "t_15:{ifnull_out:PRIVATE:STRING}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`(SELECT lower(alice.join_string_0) as c1, upper(alice.join_string_0) as c2, trim(alice.join_string_0) as c3, concat('prefix', alice.join_string_0, bob.join_string_0, 'suffix') FROM alice.tbl_0 as alice join bob.tbl_0 as bob on alice.join_string_0=bob.join_string_0);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.join_string_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select bob.join_string_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[bob,]}"]
5 [label="arrow_lower:{in:[In:{t_4,},],out:[Out:{t_6,},],attr:[func_name:utf8_lower,],party:[alice,]}"]
6 [label="arrow_upper:{in:[In:{t_4,},],out:[Out:{t_7,},],attr:[func_name:utf8_upper,],party:[alice,]}"]
7 [label="arrow_trim:{in:[In:{t_4,},],out:[Out:{t_8,},],attr:[func_name:utf8_trim,func_opt_type:TrimOptions,],party:[alice,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_9,},],attr:[scalar:prefix,],party:[alice,bob,carol,]}"]
9 [label="make_constant:{in:[],out:[Out:{t_10,},],attr:[scalar:suffix,],party:[alice,bob,carol,]}"]
10 [label="broadcast:{in:[In:{t_9,t_10,},ShapeRefTensor:{t_5,},],out:[Out:{t_11,t_12,},],attr:[],party:[bob,]}"]
11 [label="make_constant:{in:[],out:[Out:{t_13,},],attr:[scalar:,],party:[alice,bob,carol,]}"]
12 [label="broadcast:{in:[In:{t_13,},ShapeRefTensor:{t_12,},],out:[Out:{t_14,},],attr:[],party:[bob,]}"]
13 [label="copy:{in:[In:{t_11,},],out:[Out:{t_15,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
14 [label="copy:{in:[In:{t_5,},],out:[Out:{t_16,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
15 [label="copy:{in:[In:{t_12,},],out:[Out:{t_17,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
16 [label="copy:{in:[In:{t_14,},],out:[Out:{t_18,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
17 [label="arrow_concat:{in:[In:{t_15,t_4,t_16,t_17,t_18,},],out:[Out:{t_19,},],attr:[func_name:binary_join_element_wise,],party:[alice,]}"]
18 [label="publish:{in:[In:{t_6,t_7,t_8,t_19,},],out:[Out:{t_20,t_21,t_22,t_23,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_0:{join_string_0:PRIVATE:STRING}"]
1 -> 2 [label = "t_1:{join_string_0:PRIVATE:STRING}"]
1 -> 4 [label = "t_1:{join_string_0:PRIVATE:STRING}"]
10 -> 12 [label = "t_12:{constant_data:PRIVATE:STRING}"]
10 -> 13 [label = "t_11:{constant_data:PRIVATE:STRING}"]
10 -> 15 [label = "t_12:{constant_data:PRIVATE:STRING}"]
11 -> 12 [label = "t_13:{constant_data:PUBLIC:STRING}"]
12 -> 16 [label = "t_14:{constant_data:PRIVATE:STRING}"]
13 -> 17 [label = "t_15:{constant_data:PRIVATE:STRING}"]
14 -> 17 [label = "t_16:{join_string_0:PRIVATE:STRING}"]
15 -> 17 [label = "t_17:{constant_data:PRIVATE:STRING}"]
16 -> 17 [label = "t_18:{constant_data:PRIVATE:STRING}"]
17 -> 18 [label = "t_19:{arrow_concat_out:PRIVATE:STRING}"]
2 -> 3 [label = "t_2:{join_string_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{join_string_0:PRIVATE:INT64}"]
3 -> 17 [label = "t_4:{join_string_0:PRIVATE:STRING}"]
3 -> 5 [label = "t_4:{join_string_0:PRIVATE:STRING}"]
3 -> 6 [label = "t_4:{join_string_0:PRIVATE:STRING}"]
3 -> 7 [label = "t_4:{join_string_0:PRIVATE:STRING}"]
4 -> 10 [label = "t_5:{join_string_0:PRIVATE:STRING}"]
4 -> 14 [label = "t_5:{join_string_0:PRIVATE:STRING}"]
5 -> 18 [label = "t_6:{arrow_lower_out:PRIVATE:STRING}"]
6 -> 18 [label = "t_7:{arrow_upper_out:PRIVATE:STRING}"]
7 -> 18 [label = "t_8:{arrow_trim_out:PRIVATE:STRING}"]
8 -> 10 [label = "t_9:{constant_data:PUBLIC:STRING}"]
9 -> 10 [label = "t_10:{constant_data:PUBLIC:STRING}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`(SELECT substring(alice.join_string_0, 2) as c1, substring(alice.join_string_0, 1, 1) as c2 FROM alice.tbl_0 as alice join bob.tbl_0 as bob on alice.join_string_0=bob.join_string_0);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.join_string_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select bob.join_string_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="arrow_substr:{in:[In:{t_3,},],out:[Out:{t_4,},],attr:[func_name:utf8_slice_codeunits,func_opt_type:SliceOptions,],party:[alice,]}"]
5 [label="arrow_substr:{in:[In:{t_3,},],out:[Out:{t_5,},],attr:[func_name:utf8_slice_codeunits,func_opt_type:SliceOptions,],party:[alice,]}"]
6 [label="publish:{in:[In:{t_4,t_5,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_0:{join_string_0:PRIVATE:STRING}"]
1 -> 2 [label = "t_1:{join_string_0:PRIVATE:STRING}"]
2 -> 3 [label = "t_2:{join_string_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{join_string_0:PRIVATE:STRING}"]
3 -> 5 [label = "t_3:{join_string_0:PRIVATE:STRING}"]
4 -> 6 [label = "t_4:{arrow_substr_out:PRIVATE:STRING}"]
5 -> 6 [label = "t_5:{arrow_substr_out:PRIVATE:STRING}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`(SELECT count(alice.groupby_int_1) as test1 FROM alice.tbl_0 as alice WHERE alice.groupby_int_0 >= 0 GROUP BY alice.groupby_int_1 HAVING test1 > 0  limit 3) union (select count(bob.groupby_int_0) as test1 FROM bob.tbl_0 as bob WHERE bob.groupby_int_0 >= 0  limit 3);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(t_0.test1) as expr_244 from (select count(alice.groupby_int_1) as test1 from alice.tbl_0 as alice where alice.groupby_int_0>=0 group by alice.groupby_int_1 having (count(alice.groupby_int_1)>0) and (count(alice.groupby_int_1)>=4) limit 3) as t_0 group by t_0.test1;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select any_value(t_0.expr_121) as expr_244 from (select count(bob.groupby_int_0) as expr_121 from bob.tbl_0 as bob where bob.groupby_int_0>=0 limit 3) as t_0 group by t_0.expr_121;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_private:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
6 [label="group:{in:[Key:{t_5,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
7 [label="firstrow:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_5,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#244:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#244:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{Column#244:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#244:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#244:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#244:PRIVATE:INT64}"]
5 -> 7 [label = "t_5:{Column#244:PRIVATE:INT64}"]
6 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{group_num:PRIVATE:INT64}"]
7 -> 8 [label = "t_8:{Column#244_firstrow:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select if(ta.plain_int_0, -1, -ta.plain_int_0) as res from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="make_constant:{in:[],out:[Out:{t_5,},],attr:[scalar:-1,],party:[alice,bob,carol,]}"]
5 [label="make_constant:{in:[],out:[Out:{t_6,},],attr:[scalar:0,],party:[alice,bob,carol,]}"]
6 [label="broadcast:{in:[In:{t_6,},ShapeRefTensor:{t_4,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
7 [label="Minus:{in:[Left:{t_7,},Right:{t_4,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="broadcast:{in:[In:{t_5,},ShapeRefTensor:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
9 [label="If:{in:[Condition:{t_4,},ValueIfFalse:{t_8,},ValueIfTrue:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
10 [label="publish:{in:[In:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
4 -> 8 [label = "t_5:{constant_data:PUBLIC:INT64}"]
5 -> 6 [label = "t_6:{constant_data:PUBLIC:INT64}"]
6 -> 7 [label = "t_7:{constant_data:PRIVATE:INT64}"]
7 -> 8 [label = "t_8:{Minus_out:PRIVATE:INT64}"]
7 -> 9 [label = "t_8:{Minus_out:PRIVATE:INT64}"]
8 -> 9 [label = "t_9:{constant_data:PRIVATE:INT64}"]
9 -> 10 [label = "t_10:{constant_data:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select count(tb.join_string_0) from  alice.tbl_0 as ta inner join bob.tbl_0 as tb on ta.join_string_0=tb.join_string_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.join_string_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.join_string_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{},RightJoinIndex:{t_2,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_2,},],out:[Out:{t_3,},],attr:[],party:[bob,]}"]
4 [label="reduce_count:{in:[In:{t_3,},],out:[Out:{t_4,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="publish:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_string_0:PRIVATE:STRING}"]
1 -> 2 [label = "t_1:{join_string_0:PRIVATE:STRING}"]
1 -> 3 [label = "t_1:{join_string_0:PRIVATE:STRING}"]
2 -> 3 [label = "t_2:{join_string_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{join_string_0:PRIVATE:STRING}"]
4 -> 5 [label = "t_4:{join_string_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_5:{join_string_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select tt.compare_int_0 > 0 from (select compare_int_0 from alice.tbl_0 UNION select compare_int_0 from bob.tbl_0) as tt;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(tbl_0.compare_int_0) as expr_243 from alice.tbl_0 group by tbl_0.compare_int_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select any_value(tbl_0.compare_int_0) as expr_243 from bob.tbl_0 group by tbl_0.compare_int_0;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="sort:{in:[In:{t_4,t_4,},Key:{t_4,},],out:[Out:{t_5,t_6,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
6 [label="group_mark:{in:[Key:{t_5,},],out:[Group:{t_7,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="shuffle:{in:[In:{t_6,t_7,},],out:[Out:{t_8,t_9,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_public:{in:[In:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="filter:{in:[Filter:{t_10,},In:{t_8,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="make_constant:{in:[],out:[Out:{t_12,},],attr:[scalar:0,],party:[alice,bob,carol,]}"]
11 [label="broadcast:{in:[In:{t_12,},ShapeRefTensor:{t_11,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="Greater:{in:[Left:{t_11,},Right:{t_13,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_private:{in:[In:{t_14,},],out:[Out:{t_15,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
14 [label="publish:{in:[In:{t_15,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#243:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#243:PRIVATE:INT64}"]
10 -> 11 [label = "t_12:{constant_data:PUBLIC:INT64}"]
11 -> 12 [label = "t_13:{constant_data:PUBLIC:INT64}"]
12 -> 13 [label = "t_14:{Greater_out:SECRET:BOOL}"]
13 -> 14 [label = "t_15:{Greater_out:PRIVATE:BOOL}"]
2 -> 4 [label = "t_2:{Column#243:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#243:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#243:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#243:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#243:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#243:SECRET:INT64}"]
5 -> 7 [label = "t_6:{Column#243:SECRET:INT64}"]
6 -> 7 [label = "t_7:{group_mark:SECRET:BOOL}"]
7 -> 8 [label = "t_9:{group_mark:SECRET:BOOL}"]
7 -> 9 [label = "t_8:{Column#243:SECRET:INT64}"]
8 -> 9 [label = "t_10:{group_mark:PUBLIC:BOOL}"]
9 -> 11 [label = "t_11:{Column#243:SECRET:INT64}"]
9 -> 12 [label = "t_11:{Column#243:SECRET:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.join_int_0, tb.join_int_0 from (select distinct tbl_0.join_int_0, tbl_0.join_int_1 from alice.tbl_0) as ta join (select distinct tbl_0.join_int_0, tbl_0.join_int_1 from bob.tbl_0) as tb on ta.join_int_0 = tb.join_int_0 and ta.join_int_1 = tb.join_int_1;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select any_value(tbl_0.join_int_0) as expr_67,any_value(tbl_0.join_int_1) as expr_68 from alice.tbl_0 group by tbl_0.join_int_0,tbl_0.join_int_1;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select any_value(tbl_0.join_int_0) as expr_187,any_value(tbl_0.join_int_1) as expr_188 from bob.tbl_0 group by tbl_0.join_int_0,tbl_0.join_int_1;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,t_1,},Right:{t_2,t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_7,},],out:[Out:{t_9,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="publish:{in:[In:{t_6,t_9,},],out:[Out:{t_8,t_10,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 2 [label = "t_1:{join_int_1:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{join_int_1:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_9:{join_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.groupby_int_0 from alice.tbl_0 as ta WHERE groupby_int_0>0 UNION (select tb.groupby_int_0 from bob.tbl_0 as tb GROUP BY tb.groupby_int_0);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(ta.groupby_int_0) as expr_243 from alice.tbl_0 as ta where ta.groupby_int_0>0 group by ta.groupby_int_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select any_value(t_0.expr_241) as expr_243 from (select any_value(tb.groupby_int_0) as expr_241 from bob.tbl_0 as tb group by tb.groupby_int_0 having count(1)>=4) as t_0 group by t_0.expr_241;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_private:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
6 [label="group:{in:[Key:{t_5,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
7 [label="firstrow:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_5,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#243:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#243:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{Column#243:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#243:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#243:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#243:PRIVATE:INT64}"]
5 -> 7 [label = "t_5:{Column#243:PRIVATE:INT64}"]
6 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{group_num:PRIVATE:INT64}"]
7 -> 8 [label = "t_8:{Column#243_firstrow:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select count(distinct (if(ta.encrypt_int_0>1, tb.join_string_0, "aa"))) from  alice.tbl_0 as ta inner join bob.tbl_0 as tb on ta.join_string_0=tb.join_string_0 group by tb.groupby_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.encrypt_int_0,ta.join_string_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.groupby_int_0,tb.join_string_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,t_8,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_9,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="sort:{in:[In:{t_9,t_10,t_9,t_11,},Key:{t_9,},],out:[Out:{t_12,t_13,t_14,t_15,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
9 [label="group_mark:{in:[Key:{t_12,},],out:[Group:{t_16,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="make_constant:{in:[],out:[Out:{t_17,},],attr:[scalar:1,],party:[alice,bob,carol,]}"]
11 [label="broadcast:{in:[In:{t_17,},ShapeRefTensor:{t_13,},],out:[Out:{t_18,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_private:{in:[In:{t_13,},],out:[Out:{t_19,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
13 [label="make_private:{in:[In:{t_18,},],out:[Out:{t_20,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
14 [label="Greater:{in:[Left:{t_19,},Right:{t_20,},],out:[Out:{t_21,},],attr:[],party:[alice,]}"]
15 [label="make_constant:{in:[],out:[Out:{t_22,},],attr:[scalar:aa,],party:[alice,bob,carol,]}"]
16 [label="broadcast:{in:[In:{t_22,},ShapeRefTensor:{t_15,},],out:[Out:{t_23,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="make_private:{in:[In:{t_23,},],out:[Out:{t_25,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
18 [label="make_private:{in:[In:{t_15,},],out:[Out:{t_26,},],attr:[reveal_to:bob,],party:[alice,bob,carol,]}"]
19 [label="copy:{in:[In:{t_26,},],out:[Out:{t_27,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
20 [label="If:{in:[Condition:{t_21,},ValueIfFalse:{t_25,},ValueIfTrue:{t_27,},],out:[Out:{t_24,},],attr:[],party:[alice,]}"]
21 [label="make_share:{in:[In:{t_24,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
22 [label="sort:{in:[In:{t_28,},Key:{t_12,t_28,},],out:[Out:{t_29,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
23 [label="group_mark:{in:[Key:{t_29,},],out:[Group:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
24 [label="LogicalOr:{in:[Left:{t_16,},Right:{t_30,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
25 [label="sum:{in:[Group:{t_16,},In:{t_31,},],out:[Out:{t_32,},],attr:[],party:[alice,bob,carol,]}"]
26 [label="count:{in:[Group:{t_16,},In:{t_16,},],out:[Out:{t_33,},],attr:[],party:[alice,bob,carol,]}"]
27 [label="shuffle:{in:[In:{t_32,t_33,t_16,},],out:[Out:{t_34,t_35,t_36,},],attr:[],party:[alice,bob,carol,]}"]
28 [label="make_public:{in:[In:{t_36,},],out:[Out:{t_37,},],attr:[],party:[alice,bob,carol,]}"]
29 [label="filter:{in:[Filter:{t_37,},In:{t_34,t_35,},],out:[Out:{t_38,t_39,},],attr:[],party:[alice,bob,carol,]}"]
30 [label="make_constant:{in:[],out:[Out:{t_40,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
31 [label="broadcast:{in:[In:{t_40,},ShapeRefTensor:{t_39,},],out:[Out:{t_41,},],attr:[],party:[alice,bob,carol,]}"]
32 [label="make_private:{in:[In:{t_39,},],out:[Out:{t_42,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
33 [label="make_private:{in:[In:{t_41,},],out:[Out:{t_43,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
34 [label="GreaterEqual:{in:[Left:{t_42,},Right:{t_43,},],out:[Out:{t_44,},],attr:[],party:[alice,]}"]
35 [label="make_public:{in:[In:{t_44,},],out:[Out:{t_45,},],attr:[],party:[alice,bob,carol,]}"]
36 [label="apply_filter:{in:[Filter:{t_45,},In:{t_38,t_39,},],out:[Out:{t_46,t_47,},],attr:[],party:[alice,bob,carol,]}"]
37 [label="make_private:{in:[In:{t_46,},],out:[Out:{t_48,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
38 [label="publish:{in:[In:{t_48,},],out:[Out:{t_49,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_0:{encrypt_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{join_string_0:PRIVATE:STRING}"]
1 -> 4 [label = "t_2:{groupby_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{join_string_0:PRIVATE:STRING}"]
10 -> 11 [label = "t_17:{constant_data:PUBLIC:INT64}"]
11 -> 13 [label = "t_18:{constant_data:PUBLIC:INT64}"]
12 -> 14 [label = "t_19:{encrypt_int_0:PRIVATE:INT64}"]
13 -> 14 [label = "t_20:{constant_data:PRIVATE:INT64}"]
14 -> 20 [label = "t_21:{Greater_out:PRIVATE:BOOL}"]
15 -> 16 [label = "t_22:{constant_data:PUBLIC:STRING}"]
16 -> 17 [label = "t_23:{constant_data:PUBLIC:STRING}"]
17 -> 20 [label = "t_25:{constant_data:PRIVATE:STRING}"]
18 -> 19 [label = "t_26:{join_string_0:PRIVATE:STRING}"]
19 -> 20 [label = "t_27:{join_string_0:PRIVATE:STRING}"]
2 -> 3 [label = "t_4:{join_string_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_string_0:PRIVATE:INT64}"]
20 -> 21 [label = "t_24:{join_string_0:PRIVATE:STRING}"]
21 -> 22 [label = "t_28:{join_string_0:SECRET:STRING}"]
21 -> 22 [label = "t_28:{join_string_0:SECRET:STRING}"]
22 -> 23 [label = "t_29:{join_string_0:SECRET:STRING}"]
23 -> 24 [label = "t_30:{group_mark:SECRET:BOOL}"]
24 -> 25 [label = "t_31:{LogicalOr_out:SECRET:BOOL}"]
25 -> 27 [label = "t_32:{LogicalOr_out:SECRET:INT64}"]
26 -> 27 [label = "t_33:{group_mark:SECRET:INT64}"]
27 -> 28 [label = "t_36:{group_mark:SECRET:BOOL}"]
27 -> 29 [label = "t_34:{LogicalOr_out:SECRET:INT64}"]
27 -> 29 [label = "t_35:{group_mark:SECRET:INT64}"]
28 -> 29 [label = "t_37:{group_mark:PUBLIC:BOOL}"]
29 -> 31 [label = "t_39:{group_mark:SECRET:INT64}"]
29 -> 32 [label = "t_39:{group_mark:SECRET:INT64}"]
29 -> 36 [label = "t_38:{LogicalOr_out:SECRET:INT64}"]
29 -> 36 [label = "t_39:{group_mark:SECRET:INT64}"]
3 -> 6 [label = "t_6:{encrypt_int_0:PRIVATE:INT64}"]
30 -> 31 [label = "t_40:{constant_data:PUBLIC:INT64}"]
31 -> 33 [label = "t_41:{constant_data:PUBLIC:INT64}"]
32 -> 34 [label = "t_42:{group_mark:PRIVATE:INT64}"]
33 -> 34 [label = "t_43:{constant_data:PRIVATE:INT64}"]
34 -> 35 [label = "t_44:{GreaterEqual_out:PRIVATE:BOOL}"]
35 -> 36 [label = "t_45:{GreaterEqual_out:PUBLIC:BOOL}"]
36 -> 37 [label = "t_46:{LogicalOr_out:SECRET:INT64}"]
37 -> 38 [label = "t_48:{LogicalOr_out:PRIVATE:INT64}"]
4 -> 5 [label = "t_7:{groupby_int_0:PRIVATE:INT64}"]
4 -> 7 [label = "t_8:{join_string_0:PRIVATE:STRING}"]
5 -> 8 [label = "t_9:{groupby_int_0:SECRET:INT64}"]
5 -> 8 [label = "t_9:{groupby_int_0:SECRET:INT64}"]
5 -> 8 [label = "t_9:{groupby_int_0:SECRET:INT64}"]
6 -> 8 [label = "t_10:{encrypt_int_0:SECRET:INT64}"]
7 -> 8 [label = "t_11:{join_string_0:SECRET:STRING}"]
8 -> 11 [label = "t_13:{encrypt_int_0:SECRET:INT64}"]
8 -> 12 [label = "t_13:{encrypt_int_0:SECRET:INT64}"]
8 -> 16 [label = "t_15:{join_string_0:SECRET:STRING}"]
8 -> 18 [label = "t_15:{join_string_0:SECRET:STRING}"]
8 -> 22 [label = "t_12:{groupby_int_0:SECRET:INT64}"]
8 -> 9 [label = "t_12:{groupby_int_0:SECRET:INT64}"]
9 -> 24 [label = "t_16:{group_mark:SECRET:BOOL}"]
9 -> 25 [label = "t_16:{group_mark:SECRET:BOOL}"]
9 -> 26 [label = "t_16:{group_mark:SECRET:BOOL}"]
9 -> 26 [label = "t_16:{group_mark:SECRET:BOOL}"]
9 -> 27 [label = "t_16:{group_mark:SECRET:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select count(1) from (select aggregate_int_0 from alice.tbl_0 as ta union select aggregate_int_0 from bob.tbl_0) ua;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select any_value(1) as expr_245,any_value(ta.aggregate_int_0) as expr_241 from alice.tbl_0 as ta group by ta.aggregate_int_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select any_value(1) as expr_245,any_value(tbl_0.aggregate_int_0) as expr_241 from bob.tbl_0 group by tbl_0.aggregate_int_0;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_4,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_2,},],out:[Out:{t_5,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_4,t_5,},],out:[Out:{t_6,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_7,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_3,},],out:[Out:{t_8,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="concat:{in:[In:{t_7,t_8,},],out:[Out:{t_9,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
8 [label="sort:{in:[In:{t_9,t_6,t_9,},Key:{t_9,},],out:[Out:{t_10,t_11,t_12,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
9 [label="group_mark:{in:[Key:{t_10,},],out:[Group:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="shuffle:{in:[In:{t_11,t_13,},],out:[Out:{t_14,t_15,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_public:{in:[In:{t_15,},],out:[Out:{t_16,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="filter:{in:[Filter:{t_16,},In:{t_14,},],out:[Out:{t_17,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="shape:{in:[In:{t_17,},],out:[Out:{t_18,},],attr:[axis:0,],party:[alice,]}"]
14 [label="publish:{in:[In:{t_18,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#245:PRIVATE:BOOL}"]
0 -> 5 [label = "t_1:{Column#241:PRIVATE:INT64}"]
1 -> 3 [label = "t_2:{Column#245:PRIVATE:BOOL}"]
1 -> 6 [label = "t_3:{Column#241:PRIVATE:INT64}"]
10 -> 11 [label = "t_15:{group_mark:SECRET:BOOL}"]
10 -> 12 [label = "t_14:{Column#245:SECRET:BOOL}"]
11 -> 12 [label = "t_16:{group_mark:PUBLIC:BOOL}"]
12 -> 13 [label = "t_17:{Column#245:SECRET:BOOL}"]
13 -> 14 [label = "t_18:{Column#245:PRIVATE:INT64}"]
2 -> 4 [label = "t_4:{Column#245:SECRET:BOOL}"]
3 -> 4 [label = "t_5:{Column#245:SECRET:BOOL}"]
4 -> 8 [label = "t_6:{Column#245:SECRET:BOOL}"]
5 -> 7 [label = "t_7:{Column#241:SECRET:INT64}"]
6 -> 7 [label = "t_8:{Column#241:SECRET:INT64}"]
7 -> 8 [label = "t_9:{Column#241:SECRET:INT64}"]
7 -> 8 [label = "t_9:{Column#241:SECRET:INT64}"]
7 -> 8 [label = "t_9:{Column#241:SECRET:INT64}"]
8 -> 10 [label = "t_11:{Column#245:SECRET:BOOL}"]
8 -> 9 [label = "t_10:{Column#241:SECRET:INT64}"]
9 -> 10 [label = "t_13:{group_mark:SECRET:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.plain_int_0, ta.compare_int_0 < tb.compare_int_0 from alice.tbl_1 as ta inner join bob.tbl_1 as tb on ta.join_int_0=tb.join_int_0 limit 1,11;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select ta.compare_int_0,ta.join_int_0,ta.plain_int_0 from alice.tbl_1 as ta;,table_refs:[alice.tbl_1],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,t_4,},],attr:[sql:select tb.compare_int_0,tb.join_int_0 from bob.tbl_1 as tb;,table_refs:[bob.tbl_1],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_4,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{t_6,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,t_8,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_6,},],out:[Out:{t_9,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_9,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="Less:{in:[Left:{t_10,},Right:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="limit:{in:[In:{t_12,},],out:[Out:{t_13,},],attr:[count:11,offset:1,],party:[alice,bob,carol,]}"]
9 [label="limit:{in:[In:{t_8,},],out:[Out:{t_14,},],attr:[count:11,offset:1,],party:[alice,]}"]
10 [label="make_private:{in:[In:{t_13,},],out:[Out:{t_16,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
11 [label="publish:{in:[In:{t_14,t_16,},],out:[Out:{t_15,t_17,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{compare_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_16:{Less_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_7:{compare_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_9:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_10:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_11:{compare_int_0:SECRET:INT64}"]
7 -> 8 [label = "t_12:{Less_out:SECRET:BOOL}"]
8 -> 10 [label = "t_13:{Less_out:SECRET:BOOL}"]
9 -> 11 [label = "t_14:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.plain_int_0,tb.plain_int_0, sum(tb.aggregate_int_0), count(tb.encrypt_string_1) from alice.tbl_1 as ta inner join bob.tbl_1 as tb on ta.join_int_0 = tb.join_int_0 group by ta.plain_int_0, tb.plain_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_1 as ta;,table_refs:[alice.tbl_1],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,t_4,t_5,},],attr:[sql:select tb.aggregate_int_0,tb.encrypt_string_1,tb.join_int_0,tb.plain_int_0 from bob.tbl_1 as tb;,table_refs:[bob.tbl_1],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_4,},],out:[LeftJoinIndex:{t_6,},RightJoinIndex:{t_7,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,t_5,},RowsIndexFilter:{t_7,},],out:[Out:{t_9,t_10,t_11,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_11,},],out:[Out:{t_12,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="group:{in:[Key:{t_8,t_12,},],out:[GroupId:{t_13,},GroupNum:{t_14,},],attr:[],party:[alice,]}"]
7 [label="he_sum:{in:[GroupId:{t_13,},GroupNum:{t_14,},In:{t_9,},],out:[Out:{t_15,},],attr:[input_party_codes:[alice bob],],party:[alice,bob,]}"]
8 [label="count:{in:[GroupId:{t_13,},GroupNum:{t_14,},In:{t_13,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
9 [label="firstrow:{in:[GroupId:{t_13,},GroupNum:{t_14,},In:{t_8,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
10 [label="firstrow:{in:[GroupId:{t_13,},GroupNum:{t_14,},In:{t_12,},],out:[Out:{t_18,},],attr:[],party:[alice,]}"]
11 [label="copy:{in:[In:{t_15,},],out:[Out:{t_21,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
12 [label="publish:{in:[In:{t_17,t_18,t_21,t_16,},],out:[Out:{t_19,t_20,t_22,t_23,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{aggregate_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{encrypt_string_1:PRIVATE:STRING}"]
1 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
10 -> 12 [label = "t_18:{plain_int_0_firstrow:PRIVATE:INT64}"]
11 -> 12 [label = "t_21:{aggregate_int_0_sum:PRIVATE:INT64}"]
2 -> 3 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_11:{plain_int_0:PRIVATE:INT64}"]
4 -> 7 [label = "t_9:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_13:{group_id:PRIVATE:INT64}"]
6 -> 10 [label = "t_14:{group_num:PRIVATE:INT64}"]
6 -> 7 [label = "t_13:{group_id:PRIVATE:INT64}"]
6 -> 7 [label = "t_14:{group_num:PRIVATE:INT64}"]
6 -> 8 [label = "t_13:{group_id:PRIVATE:INT64}"]
6 -> 8 [label = "t_13:{group_id:PRIVATE:INT64}"]
6 -> 8 [label = "t_14:{group_num:PRIVATE:INT64}"]
6 -> 9 [label = "t_13:{group_id:PRIVATE:INT64}"]
6 -> 9 [label = "t_14:{group_num:PRIVATE:INT64}"]
7 -> 11 [label = "t_15:{aggregate_int_0_sum:PRIVATE:INT64}"]
8 -> 12 [label = "t_16:{group_id_count:PRIVATE:INT64}"]
9 -> 12 [label = "t_17:{plain_int_0_firstrow:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 1, batched: false, revealGroupCount: false}},
	{`select plain_int_0 from alice.tbl_1 where plain_int_0 in (2, 5, 15) and plain_int_1 not in (2, 5, 15);`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_1.plain_int_0 from alice.tbl_1 where (tbl_1.plain_int_0=2 or tbl_1.plain_int_0=5 or tbl_1.plain_int_0=15) and (not(tbl_1.plain_int_1=2 or tbl_1.plain_int_1=5 or tbl_1.plain_int_1=15));,table_refs:[alice.tbl_1],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select count(*), bob.gb_pl_en_int_0, carol.gb_en_pl_int_0, min(bob.ag_pl_en_int_0), max(carol.agg_en_pl_int_0) from alice.tbl_3 as alice join bob.tbl_3 as bob on alice.pl_jn_cp_int_0 = bob.jn_pl_cp_int_0 join carol.tbl_3 as carol on bob.cp_pl_jn_int_0 = carol.cp_jn_pl_int_0 group by bob.gb_pl_en_int_0, carol.gb_en_pl_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.pl_jn_cp_int_0 from alice.tbl_3 as alice;,table_refs:[alice.tbl_3],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,t_2,t_3,t_4,},],attr:[sql:select bob.ag_pl_en_int_0,bob.cp_pl_jn_int_0,bob.gb_pl_en_int_0,bob.jn_pl_cp_int_0 from bob.tbl_3 as bob;,table_refs:[bob.tbl_3],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_4,},],out:[LeftJoinIndex:{},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_6,t_7,t_8,},],attr:[],party:[bob,]}"]
4 [label="runsql:{in:[],out:[Out:{t_9,t_10,t_11,},],attr:[sql:select carol.agg_en_pl_int_0,carol.cp_jn_pl_int_0,carol.gb_en_pl_int_0 from carol.tbl_3 as carol;,table_refs:[carol.tbl_3],],party:[carol,]}"]
5 [label="join:{in:[Left:{t_7,},Right:{t_10,},],out:[LeftJoinIndex:{t_12,},RightJoinIndex:{t_13,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
6 [label="filter_by_index:{in:[Data:{t_6,t_8,},RowsIndexFilter:{t_12,},],out:[Out:{t_14,t_15,},],attr:[],party:[bob,]}"]
7 [label="filter_by_index:{in:[Data:{t_9,t_11,},RowsIndexFilter:{t_13,},],out:[Out:{t_16,t_17,},],attr:[],party:[carol,]}"]
8 [label="make_share:{in:[In:{t_15,},],out:[Out:{t_18,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_share:{in:[In:{t_17,},],out:[Out:{t_19,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="make_share:{in:[In:{t_14,},],out:[Out:{t_20,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_share:{in:[In:{t_16,},],out:[Out:{t_21,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="shuffle:{in:[In:{t_18,t_19,t_20,t_18,t_21,t_19,},],out:[Out:{t_22,t_23,t_24,t_25,t_26,t_27,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_private:{in:[In:{t_22,},],out:[Out:{t_28,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
14 [label="make_private:{in:[In:{t_23,},],out:[Out:{t_29,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
15 [label="make_share:{in:[In:{t_28,},],out:[Out:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_share:{in:[In:{t_29,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="sort:{in:[In:{t_30,t_31,t_24,t_25,t_26,t_27,},Key:{t_30,t_31,},],out:[Out:{t_32,t_33,t_34,t_35,t_36,t_37,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
18 [label="group_mark:{in:[Key:{t_32,t_33,},],out:[Group:{t_38,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="count:{in:[Group:{t_38,},In:{t_38,},],out:[Out:{t_39,},],attr:[],party:[alice,bob,carol,]}"]
20 [label="min:{in:[Group:{t_38,},In:{t_34,},],out:[Out:{t_40,},],attr:[],party:[alice,bob,carol,]}"]
21 [label="max:{in:[Group:{t_38,},In:{t_36,},],out:[Out:{t_41,},],attr:[],party:[alice,bob,carol,]}"]
22 [label="shuffle:{in:[In:{t_39,t_40,t_41,t_35,t_37,t_38,},],out:[Out:{t_42,t_43,t_44,t_45,t_46,t_47,},],attr:[],party:[alice,bob,carol,]}"]
23 [label="make_public:{in:[In:{t_47,},],out:[Out:{t_48,},],attr:[],party:[alice,bob,carol,]}"]
24 [label="filter:{in:[Filter:{t_48,},In:{t_42,t_43,t_44,t_45,t_46,},],out:[Out:{t_49,t_50,t_51,t_52,t_53,},],attr:[],party:[alice,bob,carol,]}"]
25 [label="make_constant:{in:[],out:[Out:{t_54,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
26 [label="broadcast:{in:[In:{t_54,},ShapeRefTensor:{t_49,},],out:[Out:{t_55,},],attr:[],party:[alice,bob,carol,]}"]
27 [label="make_private:{in:[In:{t_49,},],out:[Out:{t_56,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
28 [label="make_private:{in:[In:{t_55,},],out:[Out:{t_57,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
29 [label="GreaterEqual:{in:[Left:{t_56,},Right:{t_57,},],out:[Out:{t_58,},],attr:[],party:[alice,]}"]
30 [label="make_private:{in:[In:{t_52,},],out:[Out:{t_59,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
31 [label="make_private:{in:[In:{t_53,},],out:[Out:{t_60,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
32 [label="make_private:{in:[In:{t_50,},],out:[Out:{t_61,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
33 [label="make_private:{in:[In:{t_51,},],out:[Out:{t_62,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
34 [label="apply_filter:{in:[Filter:{t_58,},In:{t_59,t_60,t_56,t_61,t_62,},],out:[Out:{t_63,t_64,t_65,t_66,t_67,},],attr:[],party:[alice,]}"]
35 [label="publish:{in:[In:{t_65,t_63,t_64,t_66,t_67,},],out:[Out:{t_68,t_69,t_70,t_71,t_72,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{pl_jn_cp_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{jn_pl_cp_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{ag_pl_en_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_2:{cp_pl_jn_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_3:{gb_pl_en_int_0:PRIVATE:INT64}"]
10 -> 12 [label = "t_20:{ag_pl_en_int_0:SECRET:INT64}"]
11 -> 12 [label = "t_21:{agg_en_pl_int_0:SECRET:INT64}"]
12 -> 13 [label = "t_22:{gb_pl_en_int_0:SECRET:INT64}"]
12 -> 14 [label = "t_23:{gb_en_pl_int_0:SECRET:INT64}"]
12 -> 17 [label = "t_24:{ag_pl_en_int_0:SECRET:INT64}"]
12 -> 17 [label = "t_25:{gb_pl_en_int_0:SECRET:INT64}"]
12 -> 17 [label = "t_26:{agg_en_pl_int_0:SECRET:INT64}"]
12 -> 17 [label = "t_27:{gb_en_pl_int_0:SECRET:INT64}"]
13 -> 15 [label = "t_28:{gb_pl_en_int_0:PRIVATE:INT64}"]
14 -> 16 [label = "t_29:{gb_en_pl_int_0:PRIVATE:INT64}"]
15 -> 17 [label = "t_30:{gb_pl_en_int_0:SECRET:INT64}"]
15 -> 17 [label = "t_30:{gb_pl_en_int_0:SECRET:INT64}"]
16 -> 17 [label = "t_31:{gb_en_pl_int_0:SECRET:INT64}"]
16 -> 17 [label = "t_31:{gb_en_pl_int_0:SECRET:INT64}"]
17 -> 18 [label = "t_32:{gb_pl_en_int_0:SECRET:INT64}"]
17 -> 18 [label = "t_33:{gb_en_pl_int_0:SECRET:INT64}"]
17 -> 20 [label = "t_34:{ag_pl_en_int_0:SECRET:INT64}"]
17 -> 21 [label = "t_36:{agg_en_pl_int_0:SECRET:INT64}"]
17 -> 22 [label = "t_35:{gb_pl_en_int_0:SECRET:INT64}"]
17 -> 22 [label = "t_37:{gb_en_pl_int_0:SECRET:INT64}"]
18 -> 19 [label = "t_38:{group_mark:SECRET:BOOL}"]
18 -> 19 [label = "t_38:{group_mark:SECRET:BOOL}"]
18 -> 20 [label = "t_38:{group_mark:SECRET:BOOL}"]
18 -> 21 [label = "t_38:{group_mark:SECRET:BOOL}"]
18 -> 22 [label = "t_38:{group_mark:SECRET:BOOL}"]
19 -> 22 [label = "t_39:{group_mark:SECRET:INT64}"]
2 -> 3 [label = "t_5:{jn_pl_cp_int_0:PRIVATE:INT64}"]
20 -> 22 [label = "t_40:{ag_pl_en_int_0:SECRET:INT64}"]
21 -> 22 [label = "t_41:{agg_en_pl_int_0:SECRET:INT64}"]
22 -> 23 [label = "t_47:{group_mark:SECRET:BOOL}"]
22 -> 24 [label = "t_42:{group_mark:SECRET:INT64}"]
22 -> 24 [label = "t_43:{ag_pl_en_int_0:SECRET:INT64}"]
22 -> 24 [label = "t_44:{agg_en_pl_int_0:SECRET:INT64}"]
22 -> 24 [label = "t_45:{gb_pl_en_int_0:SECRET:INT64}"]
22 -> 24 [label = "t_46:{gb_en_pl_int_0:SECRET:INT64}"]
23 -> 24 [label = "t_48:{group_mark:PUBLIC:BOOL}"]
24 -> 26 [label = "t_49:{group_mark:SECRET:INT64}"]
24 -> 27 [label = "t_49:{group_mark:SECRET:INT64}"]
24 -> 30 [label = "t_52:{gb_pl_en_int_0:SECRET:INT64}"]
24 -> 31 [label = "t_53:{gb_en_pl_int_0:SECRET:INT64}"]
24 -> 32 [label = "t_50:{ag_pl_en_int_0:SECRET:INT64}"]
24 -> 33 [label = "t_51:{agg_en_pl_int_0:SECRET:INT64}"]
25 -> 26 [label = "t_54:{constant_data:PUBLIC:INT64}"]
26 -> 28 [label = "t_55:{constant_data:PUBLIC:INT64}"]
27 -> 29 [label = "t_56:{group_mark:PRIVATE:INT64}"]
27 -> 34 [label = "t_56:{group_mark:PRIVATE:INT64}"]
28 -> 29 [label = "t_57:{constant_data:PRIVATE:INT64}"]
29 -> 34 [label = "t_58:{GreaterEqual_out:PRIVATE:BOOL}"]
3 -> 5 [label = "t_7:{cp_pl_jn_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{ag_pl_en_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_8:{gb_pl_en_int_0:PRIVATE:INT64}"]
30 -> 34 [label = "t_59:{gb_pl_en_int_0:PRIVATE:INT64}"]
31 -> 34 [label = "t_60:{gb_en_pl_int_0:PRIVATE:INT64}"]
32 -> 34 [label = "t_61:{ag_pl_en_int_0:PRIVATE:INT64}"]
33 -> 34 [label = "t_62:{agg_en_pl_int_0:PRIVATE:INT64}"]
34 -> 35 [label = "t_63:{gb_pl_en_int_0:PRIVATE:INT64}"]
34 -> 35 [label = "t_64:{gb_en_pl_int_0:PRIVATE:INT64}"]
34 -> 35 [label = "t_65:{group_mark:PRIVATE:INT64}"]
34 -> 35 [label = "t_66:{ag_pl_en_int_0:PRIVATE:INT64}"]
34 -> 35 [label = "t_67:{agg_en_pl_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_10:{cp_jn_pl_int_0:PRIVATE:INT64}"]
4 -> 7 [label = "t_11:{gb_en_pl_int_0:PRIVATE:INT64}"]
4 -> 7 [label = "t_9:{agg_en_pl_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_12:{cp_pl_jn_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_13:{cp_jn_pl_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_14:{ag_pl_en_int_0:PRIVATE:INT64}"]
6 -> 8 [label = "t_15:{gb_pl_en_int_0:PRIVATE:INT64}"]
7 -> 11 [label = "t_16:{agg_en_pl_int_0:PRIVATE:INT64}"]
7 -> 9 [label = "t_17:{gb_en_pl_int_0:PRIVATE:INT64}"]
8 -> 12 [label = "t_18:{gb_pl_en_int_0:SECRET:INT64}"]
8 -> 12 [label = "t_18:{gb_pl_en_int_0:SECRET:INT64}"]
9 -> 12 [label = "t_19:{gb_en_pl_int_0:SECRET:INT64}"]
9 -> 12 [label = "t_19:{gb_en_pl_int_0:SECRET:INT64}"]
}`, ``, testConf{groupThreshold: 4, batched: false, revealGroupCount: true}},
	{`select bob.cp_pl_jn_int_0 > carol.cp_jn_pl_int_0, bob.cp_pl_jn_int_1 > carol.cp_jn_pl_int_1 from alice.tbl_3 as alice join bob.tbl_3 as bob on alice.pl_jn_cp_int_0 = bob.jn_pl_cp_int_0 join carol.tbl_3 as carol on bob.cp_pl_jn_int_0 = carol.cp_jn_pl_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.pl_jn_cp_int_0 from alice.tbl_3 as alice;,table_refs:[alice.tbl_3],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,t_2,t_3,},],attr:[sql:select bob.cp_pl_jn_int_0,bob.cp_pl_jn_int_1,bob.jn_pl_cp_int_0 from bob.tbl_3 as bob;,table_refs:[bob.tbl_3],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_3,},],out:[LeftJoinIndex:{},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_5,t_6,},],attr:[],party:[bob,]}"]
4 [label="runsql:{in:[],out:[Out:{t_7,t_8,},],attr:[sql:select carol.cp_jn_pl_int_0,carol.cp_jn_pl_int_1 from carol.tbl_3 as carol;,table_refs:[carol.tbl_3],],party:[carol,]}"]
5 [label="join:{in:[Left:{t_5,},Right:{t_7,},],out:[LeftJoinIndex:{t_9,},RightJoinIndex:{t_10,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
6 [label="filter_by_index:{in:[Data:{t_5,t_6,},RowsIndexFilter:{t_9,},],out:[Out:{t_11,t_12,},],attr:[],party:[bob,]}"]
7 [label="filter_by_index:{in:[Data:{t_7,t_8,},RowsIndexFilter:{t_10,},],out:[Out:{t_13,t_14,},],attr:[],party:[carol,]}"]
8 [label="copy:{in:[In:{t_13,},],out:[Out:{t_15,},],attr:[input_party_codes:carol,output_party_codes:bob,],party:[carol,bob,]}"]
9 [label="Greater:{in:[Left:{t_11,},Right:{t_15,},],out:[Out:{t_16,},],attr:[],party:[bob,]}"]
10 [label="make_share:{in:[In:{t_12,},],out:[Out:{t_17,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_share:{in:[In:{t_14,},],out:[Out:{t_18,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="Greater:{in:[Left:{t_17,},Right:{t_18,},],out:[Out:{t_19,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="copy:{in:[In:{t_16,},],out:[Out:{t_20,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
14 [label="make_private:{in:[In:{t_19,},],out:[Out:{t_22,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
15 [label="publish:{in:[In:{t_20,t_22,},],out:[Out:{t_21,t_23,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{pl_jn_cp_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{jn_pl_cp_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{cp_pl_jn_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_2:{cp_pl_jn_int_1:PRIVATE:INT64}"]
10 -> 12 [label = "t_17:{cp_pl_jn_int_1:SECRET:INT64}"]
11 -> 12 [label = "t_18:{cp_jn_pl_int_1:SECRET:INT64}"]
12 -> 14 [label = "t_19:{Greater_out:SECRET:BOOL}"]
13 -> 15 [label = "t_20:{Greater_out:PRIVATE:BOOL}"]
14 -> 15 [label = "t_22:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_4:{jn_pl_cp_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_5:{cp_pl_jn_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_5:{cp_pl_jn_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{cp_pl_jn_int_1:PRIVATE:INT64}"]
4 -> 5 [label = "t_7:{cp_jn_pl_int_0:PRIVATE:INT64}"]
4 -> 7 [label = "t_7:{cp_jn_pl_int_0:PRIVATE:INT64}"]
4 -> 7 [label = "t_8:{cp_jn_pl_int_1:PRIVATE:INT64}"]
5 -> 6 [label = "t_9:{cp_pl_jn_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_10:{cp_jn_pl_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_12:{cp_pl_jn_int_1:PRIVATE:INT64}"]
6 -> 9 [label = "t_11:{cp_pl_jn_int_0:PRIVATE:INT64}"]
7 -> 11 [label = "t_14:{cp_jn_pl_int_1:PRIVATE:INT64}"]
7 -> 8 [label = "t_13:{cp_jn_pl_int_0:PRIVATE:INT64}"]
8 -> 9 [label = "t_15:{cp_jn_pl_int_0:PRIVATE:INT64}"]
9 -> 13 [label = "t_16:{Greater_out:PRIVATE:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select bob.cp_pl_jn_int_0 > carol.cp_jn_pl_int_0 from alice.tbl_3 as alice join bob.tbl_3 as bob on alice.pl_jn_cp_int_0 = bob.jn_pl_cp_int_0 join carol.tbl_3 as carol on bob.cp_pl_jn_int_0 = carol.cp_jn_pl_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.pl_jn_cp_int_0 from alice.tbl_3 as alice;,table_refs:[alice.tbl_3],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,t_2,},],attr:[sql:select bob.cp_pl_jn_int_0,bob.jn_pl_cp_int_0 from bob.tbl_3 as bob;,table_refs:[bob.tbl_3],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,},],attr:[],party:[bob,]}"]
4 [label="runsql:{in:[],out:[Out:{t_5,},],attr:[sql:select carol.cp_jn_pl_int_0 from carol.tbl_3 as carol;,table_refs:[carol.tbl_3],],party:[carol,]}"]
5 [label="join:{in:[Left:{t_4,},Right:{t_5,},],out:[LeftJoinIndex:{t_6,},RightJoinIndex:{t_7,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
6 [label="filter_by_index:{in:[Data:{t_4,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,},],attr:[],party:[bob,]}"]
7 [label="filter_by_index:{in:[Data:{t_5,},RowsIndexFilter:{t_7,},],out:[Out:{t_9,},],attr:[],party:[carol,]}"]
8 [label="copy:{in:[In:{t_9,},],out:[Out:{t_10,},],attr:[input_party_codes:carol,output_party_codes:bob,],party:[carol,bob,]}"]
9 [label="Greater:{in:[Left:{t_8,},Right:{t_10,},],out:[Out:{t_11,},],attr:[],party:[bob,]}"]
10 [label="copy:{in:[In:{t_11,},],out:[Out:{t_12,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
11 [label="publish:{in:[In:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{pl_jn_cp_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{jn_pl_cp_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{cp_pl_jn_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_12:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_3:{jn_pl_cp_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_4:{cp_pl_jn_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{cp_pl_jn_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_5:{cp_jn_pl_int_0:PRIVATE:INT64}"]
4 -> 7 [label = "t_5:{cp_jn_pl_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_6:{cp_pl_jn_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_7:{cp_jn_pl_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_8:{cp_pl_jn_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_9:{cp_jn_pl_int_0:PRIVATE:INT64}"]
8 -> 9 [label = "t_10:{cp_jn_pl_int_0:PRIVATE:INT64}"]
9 -> 10 [label = "t_11:{Greater_out:PRIVATE:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select if(ta.plain_int_0, tb.plain_int_0, ta.plain_int_0) as res,if(ta.compare_int_0 > tb.compare_int_0, ta.compare_int_0, tb.compare_int_0) > ta.compare_int_1 as res1, if(ta.plain_int_0, ta.compare_int_0, tb.compare_int_0) > ta.compare_int_1 as res1, if(ta.compare_int_0 > tb.compare_int_1, ta.plain_string_0, tb.plain_string_0) as res2 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,t_3,t_4,},],attr:[sql:select ta.compare_int_0,ta.compare_int_1,ta.join_int_0,ta.plain_int_0,ta.plain_string_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_5,t_6,t_7,t_8,t_9,},],attr:[sql:select tb.compare_int_0,tb.compare_int_1,tb.join_int_0,tb.plain_int_0,tb.plain_string_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_2,},Right:{t_7,},],out:[LeftJoinIndex:{t_10,},RightJoinIndex:{t_11,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_3,t_4,},RowsIndexFilter:{t_10,},],out:[Out:{t_12,t_13,t_14,t_15,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_5,t_6,t_8,t_9,},RowsIndexFilter:{t_11,},],out:[Out:{t_16,t_17,t_18,t_19,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_18,},],out:[Out:{t_21,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="If:{in:[Condition:{t_14,},ValueIfFalse:{t_14,},ValueIfTrue:{t_21,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
7 [label="make_share:{in:[In:{t_12,},],out:[Out:{t_22,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_16,},],out:[Out:{t_23,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="Greater:{in:[Left:{t_22,},Right:{t_23,},],out:[Out:{t_24,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="If:{in:[Condition:{t_24,},ValueIfFalse:{t_23,},ValueIfTrue:{t_22,},],out:[Out:{t_25,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_share:{in:[In:{t_13,},],out:[Out:{t_26,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="Greater:{in:[Left:{t_25,},Right:{t_26,},],out:[Out:{t_27,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_share:{in:[In:{t_14,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="If:{in:[Condition:{t_29,},ValueIfFalse:{t_23,},ValueIfTrue:{t_22,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="Greater:{in:[Left:{t_28,},Right:{t_26,},],out:[Out:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_share:{in:[In:{t_17,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="Greater:{in:[Left:{t_22,},Right:{t_31,},],out:[Out:{t_32,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="make_private:{in:[In:{t_32,},],out:[Out:{t_34,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
19 [label="copy:{in:[In:{t_19,},],out:[Out:{t_35,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
20 [label="If:{in:[Condition:{t_34,},ValueIfFalse:{t_35,},ValueIfTrue:{t_15,},],out:[Out:{t_33,},],attr:[],party:[alice,]}"]
21 [label="make_private:{in:[In:{t_27,},],out:[Out:{t_37,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
22 [label="make_private:{in:[In:{t_30,},],out:[Out:{t_39,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
23 [label="publish:{in:[In:{t_20,t_37,t_39,t_33,},],out:[Out:{t_36,t_38,t_40,t_41,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{compare_int_1:PRIVATE:INT64}"]
0 -> 3 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_4:{plain_string_0:PRIVATE:STRING}"]
1 -> 2 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_5:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_6:{compare_int_1:PRIVATE:INT64}"]
1 -> 4 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_9:{plain_string_0:PRIVATE:STRING}"]
10 -> 12 [label = "t_25:{compare_int_0:SECRET:INT64}"]
11 -> 12 [label = "t_26:{compare_int_1:SECRET:INT64}"]
11 -> 15 [label = "t_26:{compare_int_1:SECRET:INT64}"]
12 -> 21 [label = "t_27:{Greater_out:SECRET:BOOL}"]
13 -> 14 [label = "t_29:{plain_int_0:SECRET:INT64}"]
14 -> 15 [label = "t_28:{compare_int_0:SECRET:INT64}"]
15 -> 22 [label = "t_30:{Greater_out:SECRET:BOOL}"]
16 -> 17 [label = "t_31:{compare_int_1:SECRET:INT64}"]
17 -> 18 [label = "t_32:{Greater_out:SECRET:BOOL}"]
18 -> 20 [label = "t_34:{Greater_out:PRIVATE:BOOL}"]
19 -> 20 [label = "t_35:{plain_string_0:PRIVATE:STRING}"]
2 -> 3 [label = "t_10:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_11:{join_int_0:PRIVATE:INT64}"]
20 -> 23 [label = "t_33:{plain_string_0:PRIVATE:STRING}"]
21 -> 23 [label = "t_37:{Greater_out:PRIVATE:BOOL}"]
22 -> 23 [label = "t_39:{Greater_out:PRIVATE:BOOL}"]
3 -> 11 [label = "t_13:{compare_int_1:PRIVATE:INT64}"]
3 -> 13 [label = "t_14:{plain_int_0:PRIVATE:INT64}"]
3 -> 20 [label = "t_15:{plain_string_0:PRIVATE:STRING}"]
3 -> 6 [label = "t_14:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_14:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_12:{compare_int_0:PRIVATE:INT64}"]
4 -> 16 [label = "t_17:{compare_int_1:PRIVATE:INT64}"]
4 -> 19 [label = "t_19:{plain_string_0:PRIVATE:STRING}"]
4 -> 5 [label = "t_18:{plain_int_0:PRIVATE:INT64}"]
4 -> 8 [label = "t_16:{compare_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_21:{plain_int_0:PRIVATE:INT64}"]
6 -> 23 [label = "t_20:{plain_int_0:PRIVATE:INT64}"]
7 -> 10 [label = "t_22:{compare_int_0:SECRET:INT64}"]
7 -> 14 [label = "t_22:{compare_int_0:SECRET:INT64}"]
7 -> 17 [label = "t_22:{compare_int_0:SECRET:INT64}"]
7 -> 9 [label = "t_22:{compare_int_0:SECRET:INT64}"]
8 -> 10 [label = "t_23:{compare_int_0:SECRET:INT64}"]
8 -> 14 [label = "t_23:{compare_int_0:SECRET:INT64}"]
8 -> 9 [label = "t_23:{compare_int_0:SECRET:INT64}"]
9 -> 10 [label = "t_24:{Greater_out:SECRET:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select key1, key2, count(*) as c, count(distinct bob_encrypt) as cd, sum(bob_aggregate) as sb, max(carol_aggregate) as sc, min(carol_aggregate) as min_ca, avg(carol_aggregate) as avg_ca from (select bob.plain_int_0 as bob_encrypt, bob.plain_int_0 as bob_aggregate, carol.plain_int_0 as carol_aggregate, alice.plain_int_0 as alice_join, bob.plain_int_0 as bob_join, carol.plain_int_0 as carol_join, alice.plain_int_0 + bob.plain_int_0 as key1, carol.plain_int_0 + bob.plain_int_0 as key2 from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol) as tt where alice_join = bob_join and bob_join = carol_join group by key1, key2;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.plain_int_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select bob.plain_int_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_6,},],attr:[sql:select carol.plain_int_0 from carol.tbl_0 as carol;,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_5,},Right:{t_6,},],out:[LeftJoinIndex:{t_7,},RightJoinIndex:{t_8,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_7,},],out:[Out:{t_9,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_4,},RowsIndexFilter:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_5,},RowsIndexFilter:{t_7,},],out:[Out:{t_11,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_6,},RowsIndexFilter:{t_8,},],out:[Out:{t_12,},],attr:[],party:[carol,]}"]
11 [label="copy:{in:[In:{t_11,},],out:[Out:{t_13,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
12 [label="Add:{in:[Left:{t_10,},Right:{t_13,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
13 [label="copy:{in:[In:{t_12,},],out:[Out:{t_15,},],attr:[input_party_codes:carol,output_party_codes:alice,],party:[carol,alice,]}"]
14 [label="Add:{in:[Left:{t_15,},Right:{t_13,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
15 [label="group:{in:[Key:{t_14,t_16,},],out:[GroupId:{t_17,},GroupNum:{t_18,},],attr:[],party:[alice,]}"]
16 [label="count:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_17,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
17 [label="count_distinct:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_13,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
18 [label="sum:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_13,},],out:[Out:{t_21,},],attr:[],party:[alice,]}"]
19 [label="max:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_15,},],out:[Out:{t_22,},],attr:[],party:[alice,]}"]
20 [label="min:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_15,},],out:[Out:{t_23,},],attr:[],party:[alice,]}"]
21 [label="avg:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_15,},],out:[Out:{t_24,},],attr:[],party:[alice,]}"]
22 [label="firstrow:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_14,},],out:[Out:{t_25,},],attr:[],party:[alice,]}"]
23 [label="firstrow:{in:[GroupId:{t_17,},GroupNum:{t_18,},In:{t_16,},],out:[Out:{t_26,},],attr:[],party:[alice,]}"]
24 [label="make_constant:{in:[],out:[Out:{t_27,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
25 [label="broadcast:{in:[In:{t_27,},ShapeRefTensor:{t_19,},],out:[Out:{t_28,},],attr:[],party:[alice,]}"]
26 [label="GreaterEqual:{in:[Left:{t_19,},Right:{t_28,},],out:[Out:{t_29,},],attr:[],party:[alice,]}"]
27 [label="apply_filter:{in:[Filter:{t_29,},In:{t_25,t_26,t_19,t_20,t_21,t_22,t_23,t_24,},],out:[Out:{t_30,t_31,t_32,t_33,t_34,t_35,t_36,t_37,},],attr:[],party:[alice,]}"]
28 [label="publish:{in:[In:{t_30,t_31,t_32,t_33,t_34,t_35,t_36,t_37,},],out:[Out:{t_38,t_39,t_40,t_41,t_42,t_43,t_44,t_45,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
10 -> 13 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
11 -> 12 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
11 -> 14 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
11 -> 17 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
11 -> 18 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
12 -> 15 [label = "t_14:{Add_out:PRIVATE:INT64}"]
12 -> 22 [label = "t_14:{Add_out:PRIVATE:INT64}"]
13 -> 14 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
13 -> 19 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
13 -> 20 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
13 -> 21 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
14 -> 15 [label = "t_16:{Add_out:PRIVATE:INT64}"]
14 -> 23 [label = "t_16:{Add_out:PRIVATE:INT64}"]
15 -> 16 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 16 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 16 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 17 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 17 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 18 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 18 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 19 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 19 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 20 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 20 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 21 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 21 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 22 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 22 [label = "t_18:{group_num:PRIVATE:INT64}"]
15 -> 23 [label = "t_17:{group_id:PRIVATE:INT64}"]
15 -> 23 [label = "t_18:{group_num:PRIVATE:INT64}"]
16 -> 25 [label = "t_19:{group_id_count:PRIVATE:INT64}"]
16 -> 26 [label = "t_19:{group_id_count:PRIVATE:INT64}"]
16 -> 27 [label = "t_19:{group_id_count:PRIVATE:INT64}"]
17 -> 27 [label = "t_20:{plain_int_0_count_distinct:PRIVATE:INT64}"]
18 -> 27 [label = "t_21:{plain_int_0_sum:PRIVATE:INT64}"]
19 -> 27 [label = "t_22:{plain_int_0_max:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
20 -> 27 [label = "t_23:{plain_int_0_min:PRIVATE:INT64}"]
21 -> 27 [label = "t_24:{plain_int_0_avg:PRIVATE:FLOAT64}"]
22 -> 27 [label = "t_25:{Add_out_firstrow:PRIVATE:INT64}"]
23 -> 27 [label = "t_26:{Add_out_firstrow:PRIVATE:INT64}"]
24 -> 25 [label = "t_27:{constant_data:PUBLIC:INT64}"]
25 -> 26 [label = "t_28:{constant_data:PRIVATE:INT64}"]
26 -> 27 [label = "t_29:{GreaterEqual_out:PRIVATE:BOOL}"]
27 -> 28 [label = "t_30:{Add_out_firstrow:PRIVATE:INT64}"]
27 -> 28 [label = "t_31:{Add_out_firstrow:PRIVATE:INT64}"]
27 -> 28 [label = "t_32:{group_id_count:PRIVATE:INT64}"]
27 -> 28 [label = "t_33:{plain_int_0_count_distinct:PRIVATE:INT64}"]
27 -> 28 [label = "t_34:{plain_int_0_sum:PRIVATE:INT64}"]
27 -> 28 [label = "t_35:{plain_int_0_max:PRIVATE:INT64}"]
27 -> 28 [label = "t_36:{plain_int_0_min:PRIVATE:INT64}"]
27 -> 28 [label = "t_37:{plain_int_0_avg:PRIVATE:FLOAT64}"]
3 -> 8 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_9:{plain_int_0:PRIVATE:INT64}"]
8 -> 12 [label = "t_10:{plain_int_0:PRIVATE:INT64}"]
9 -> 11 [label = "t_11:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select count(*) from (select ta.groupby_string_0 from alice.tbl_0 as ta union select tb.groupby_string_0 from bob.tbl_0 as tb union select tc.groupby_string_0 from carol.tbl_0 as tc) as uu`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select any_value(1) as expr_365,any_value(ta.groupby_string_0) as expr_361 from alice.tbl_0 as ta group by ta.groupby_string_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select any_value(1) as expr_365,any_value(tb.groupby_string_0) as expr_361 from bob.tbl_0 as tb group by tb.groupby_string_0;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="runsql:{in:[],out:[Out:{t_4,t_5,},],attr:[sql:select any_value(1) as expr_365,any_value(tc.groupby_string_0) as expr_361 from carol.tbl_0 as tc group by tc.groupby_string_0;,table_refs:[carol.tbl_0],],party:[carol,]}"]
3 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_6,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="make_share:{in:[In:{t_2,},],out:[Out:{t_7,},],attr:[],party:[alice,bob,carol,]}"]
5 [label="make_share:{in:[In:{t_4,},],out:[Out:{t_8,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="concat:{in:[In:{t_6,t_7,t_8,},],out:[Out:{t_9,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_3,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_share:{in:[In:{t_5,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="concat:{in:[In:{t_10,t_11,t_12,},],out:[Out:{t_13,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
11 [label="make_public:{in:[In:{t_13,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_private:{in:[In:{t_14,},],out:[Out:{t_15,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
13 [label="group:{in:[Key:{t_15,},],out:[GroupId:{t_16,},GroupNum:{t_17,},],attr:[],party:[alice,]}"]
14 [label="make_private:{in:[In:{t_9,},],out:[Out:{t_18,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
15 [label="firstrow:{in:[GroupId:{t_16,},GroupNum:{t_17,},In:{t_18,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
16 [label="shape:{in:[In:{t_19,},],out:[Out:{t_20,},],attr:[axis:0,],party:[alice,]}"]
17 [label="publish:{in:[In:{t_20,},],out:[Out:{t_21,},],attr:[],party:[alice,]}"]
0 -> 3 [label = "t_0:{Column#365:PRIVATE:BOOL}"]
0 -> 7 [label = "t_1:{Column#361:PRIVATE:STRING}"]
1 -> 4 [label = "t_2:{Column#365:PRIVATE:BOOL}"]
1 -> 8 [label = "t_3:{Column#361:PRIVATE:STRING}"]
10 -> 11 [label = "t_13:{Column#361:SECRET:STRING}"]
11 -> 12 [label = "t_14:{Column#361:PUBLIC:STRING}"]
12 -> 13 [label = "t_15:{Column#361:PRIVATE:STRING}"]
13 -> 15 [label = "t_16:{group_id:PRIVATE:INT64}"]
13 -> 15 [label = "t_17:{group_num:PRIVATE:INT64}"]
14 -> 15 [label = "t_18:{Column#365:PRIVATE:BOOL}"]
15 -> 16 [label = "t_19:{Column#365_firstrow:PRIVATE:BOOL}"]
16 -> 17 [label = "t_20:{Column#365_firstrow:PRIVATE:INT64}"]
2 -> 5 [label = "t_4:{Column#365:PRIVATE:BOOL}"]
2 -> 9 [label = "t_5:{Column#361:PRIVATE:STRING}"]
3 -> 6 [label = "t_6:{Column#365:SECRET:BOOL}"]
4 -> 6 [label = "t_7:{Column#365:SECRET:BOOL}"]
5 -> 6 [label = "t_8:{Column#365:SECRET:BOOL}"]
6 -> 14 [label = "t_9:{Column#365:SECRET:BOOL}"]
7 -> 10 [label = "t_10:{Column#361:SECRET:STRING}"]
8 -> 10 [label = "t_11:{Column#361:SECRET:STRING}"]
9 -> 10 [label = "t_12:{Column#361:SECRET:STRING}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select alice.encrypt_float_1 from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.plain_int_0 = bob.join_int_0 and bob.join_int_1 = carol.join_int_1;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.encrypt_float_1,alice.plain_int_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select bob.join_int_0,bob.join_int_1 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_8,},],attr:[sql:select carol.join_int_1 from carol.tbl_0 as carol;,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_7,},Right:{t_8,},],out:[LeftJoinIndex:{t_9,},RightJoinIndex:{},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_9,},],out:[Out:{t_10,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_6,},RowsIndexFilter:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
9 [label="publish:{in:[In:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{encrypt_float_1:PRIVATE:FLOAT32}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{join_int_1:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_6:{encrypt_float_1:PRIVATE:FLOAT32}"]
4 -> 6 [label = "t_7:{join_int_1:PRIVATE:INT64}"]
5 -> 6 [label = "t_8:{join_int_1:PRIVATE:INT64}"]
6 -> 7 [label = "t_9:{join_int_1:PRIVATE:INT64}"]
7 -> 8 [label = "t_10:{join_int_1:PRIVATE:INT64}"]
8 -> 9 [label = "t_11:{encrypt_float_1:PRIVATE:FLOAT32}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select count(*) as c, count(distinct bob.encrypt_int_0) as cd, sum(bob.aggregate_int_0) as sb, sum(carol.aggregate_int_0) as sc from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.join_int_0 = bob.join_int_0 and bob.join_int_0 = carol.join_int_0 group by alice.groupby_int_0 + bob.groupby_int_0, carol.groupby_int_0 + bob.groupby_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.groupby_int_0,alice.join_int_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,t_4,t_5,},],attr:[sql:select bob.aggregate_int_0,bob.encrypt_int_0,bob.groupby_int_0,bob.join_int_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_5,},],out:[LeftJoinIndex:{t_6,},RightJoinIndex:{t_7,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,t_4,t_5,},RowsIndexFilter:{t_7,},],out:[Out:{t_9,t_10,t_11,t_12,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_13,t_14,t_15,},],attr:[sql:select carol.aggregate_int_0,carol.groupby_int_0,carol.join_int_0 from carol.tbl_0 as carol;,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_12,},Right:{t_15,},],out:[LeftJoinIndex:{t_16,},RightJoinIndex:{t_17,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_16,},],out:[Out:{t_18,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_8,},RowsIndexFilter:{t_18,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_9,t_10,t_11,},RowsIndexFilter:{t_16,},],out:[Out:{t_20,t_21,t_22,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_13,t_14,},RowsIndexFilter:{t_17,},],out:[Out:{t_23,t_24,},],attr:[],party:[carol,]}"]
11 [label="make_share:{in:[In:{t_19,},],out:[Out:{t_25,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_22,},],out:[Out:{t_26,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="Add:{in:[Left:{t_25,},Right:{t_26,},],out:[Out:{t_27,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_24,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="Add:{in:[Left:{t_28,},Right:{t_26,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_share:{in:[In:{t_20,},],out:[Out:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="make_share:{in:[In:{t_21,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="make_share:{in:[In:{t_23,},],out:[Out:{t_32,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="shuffle:{in:[In:{t_27,t_29,t_25,t_30,t_31,t_26,t_32,t_28,},],out:[Out:{t_33,t_34,t_35,t_36,t_37,t_38,t_39,t_40,},],attr:[],party:[alice,bob,carol,]}"]
20 [label="make_private:{in:[In:{t_33,},],out:[Out:{t_41,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
21 [label="make_private:{in:[In:{t_34,},],out:[Out:{t_42,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
22 [label="make_share:{in:[In:{t_41,},],out:[Out:{t_43,},],attr:[],party:[alice,bob,carol,]}"]
23 [label="make_share:{in:[In:{t_42,},],out:[Out:{t_44,},],attr:[],party:[alice,bob,carol,]}"]
24 [label="sort:{in:[In:{t_43,t_44,t_35,t_36,t_37,t_38,t_39,t_40,},Key:{t_43,t_44,},],out:[Out:{t_45,t_46,t_47,t_48,t_49,t_50,t_51,t_52,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
25 [label="group_mark:{in:[Key:{t_45,t_46,},],out:[Group:{t_53,},],attr:[],party:[alice,bob,carol,]}"]
26 [label="count:{in:[Group:{t_53,},In:{t_53,},],out:[Out:{t_54,},],attr:[],party:[alice,bob,carol,]}"]
27 [label="sort:{in:[In:{t_49,},Key:{t_45,t_46,t_49,},],out:[Out:{t_55,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
28 [label="group_mark:{in:[Key:{t_55,},],out:[Group:{t_56,},],attr:[],party:[alice,bob,carol,]}"]
29 [label="LogicalOr:{in:[Left:{t_53,},Right:{t_56,},],out:[Out:{t_57,},],attr:[],party:[alice,bob,carol,]}"]
30 [label="sum:{in:[Group:{t_53,},In:{t_57,},],out:[Out:{t_58,},],attr:[],party:[alice,bob,carol,]}"]
31 [label="sum:{in:[Group:{t_53,},In:{t_48,},],out:[Out:{t_59,},],attr:[],party:[alice,bob,carol,]}"]
32 [label="sum:{in:[Group:{t_53,},In:{t_51,},],out:[Out:{t_60,},],attr:[],party:[alice,bob,carol,]}"]
33 [label="shuffle:{in:[In:{t_54,t_58,t_59,t_60,t_53,},],out:[Out:{t_61,t_62,t_63,t_64,t_65,},],attr:[],party:[alice,bob,carol,]}"]
34 [label="make_public:{in:[In:{t_65,},],out:[Out:{t_66,},],attr:[],party:[alice,bob,carol,]}"]
35 [label="filter:{in:[Filter:{t_66,},In:{t_61,t_62,t_63,t_64,},],out:[Out:{t_67,t_68,t_69,t_70,},],attr:[],party:[alice,bob,carol,]}"]
36 [label="make_constant:{in:[],out:[Out:{t_71,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
37 [label="broadcast:{in:[In:{t_71,},ShapeRefTensor:{t_67,},],out:[Out:{t_72,},],attr:[],party:[alice,bob,carol,]}"]
38 [label="make_private:{in:[In:{t_67,},],out:[Out:{t_73,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
39 [label="make_private:{in:[In:{t_72,},],out:[Out:{t_74,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
40 [label="GreaterEqual:{in:[Left:{t_73,},Right:{t_74,},],out:[Out:{t_75,},],attr:[],party:[alice,]}"]
41 [label="make_public:{in:[In:{t_75,},],out:[Out:{t_76,},],attr:[],party:[alice,bob,carol,]}"]
42 [label="apply_filter:{in:[Filter:{t_76,},In:{t_67,t_68,t_69,t_70,},],out:[Out:{t_77,t_78,t_79,t_80,},],attr:[],party:[alice,bob,carol,]}"]
43 [label="make_private:{in:[In:{t_77,},],out:[Out:{t_81,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
44 [label="make_private:{in:[In:{t_78,},],out:[Out:{t_83,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
45 [label="make_private:{in:[In:{t_79,},],out:[Out:{t_85,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
46 [label="make_private:{in:[In:{t_80,},],out:[Out:{t_87,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
47 [label="publish:{in:[In:{t_81,t_83,t_85,t_87,},],out:[Out:{t_82,t_84,t_86,t_88,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{groupby_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{aggregate_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{encrypt_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{groupby_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
10 -> 14 [label = "t_24:{groupby_int_0:PRIVATE:INT64}"]
10 -> 18 [label = "t_23:{aggregate_int_0:PRIVATE:INT64}"]
11 -> 13 [label = "t_25:{groupby_int_0:SECRET:INT64}"]
11 -> 19 [label = "t_25:{groupby_int_0:SECRET:INT64}"]
12 -> 13 [label = "t_26:{groupby_int_0:SECRET:INT64}"]
12 -> 15 [label = "t_26:{groupby_int_0:SECRET:INT64}"]
12 -> 19 [label = "t_26:{groupby_int_0:SECRET:INT64}"]
13 -> 19 [label = "t_27:{Add_out:SECRET:INT64}"]
14 -> 15 [label = "t_28:{groupby_int_0:SECRET:INT64}"]
14 -> 19 [label = "t_28:{groupby_int_0:SECRET:INT64}"]
15 -> 19 [label = "t_29:{Add_out:SECRET:INT64}"]
16 -> 19 [label = "t_30:{aggregate_int_0:SECRET:INT64}"]
17 -> 19 [label = "t_31:{encrypt_int_0:SECRET:INT64}"]
18 -> 19 [label = "t_32:{aggregate_int_0:SECRET:INT64}"]
19 -> 20 [label = "t_33:{Add_out:SECRET:INT64}"]
19 -> 21 [label = "t_34:{Add_out:SECRET:INT64}"]
19 -> 24 [label = "t_35:{groupby_int_0:SECRET:INT64}"]
19 -> 24 [label = "t_36:{aggregate_int_0:SECRET:INT64}"]
19 -> 24 [label = "t_37:{encrypt_int_0:SECRET:INT64}"]
19 -> 24 [label = "t_38:{groupby_int_0:SECRET:INT64}"]
19 -> 24 [label = "t_39:{aggregate_int_0:SECRET:INT64}"]
19 -> 24 [label = "t_40:{groupby_int_0:SECRET:INT64}"]
2 -> 3 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
20 -> 22 [label = "t_41:{Add_out:PRIVATE:INT64}"]
21 -> 23 [label = "t_42:{Add_out:PRIVATE:INT64}"]
22 -> 24 [label = "t_43:{Add_out:SECRET:INT64}"]
22 -> 24 [label = "t_43:{Add_out:SECRET:INT64}"]
23 -> 24 [label = "t_44:{Add_out:SECRET:INT64}"]
23 -> 24 [label = "t_44:{Add_out:SECRET:INT64}"]
24 -> 25 [label = "t_45:{Add_out:SECRET:INT64}"]
24 -> 25 [label = "t_46:{Add_out:SECRET:INT64}"]
24 -> 27 [label = "t_45:{Add_out:SECRET:INT64}"]
24 -> 27 [label = "t_46:{Add_out:SECRET:INT64}"]
24 -> 27 [label = "t_49:{encrypt_int_0:SECRET:INT64}"]
24 -> 27 [label = "t_49:{encrypt_int_0:SECRET:INT64}"]
24 -> 31 [label = "t_48:{aggregate_int_0:SECRET:INT64}"]
24 -> 32 [label = "t_51:{aggregate_int_0:SECRET:INT64}"]
25 -> 26 [label = "t_53:{group_mark:SECRET:BOOL}"]
25 -> 26 [label = "t_53:{group_mark:SECRET:BOOL}"]
25 -> 29 [label = "t_53:{group_mark:SECRET:BOOL}"]
25 -> 30 [label = "t_53:{group_mark:SECRET:BOOL}"]
25 -> 31 [label = "t_53:{group_mark:SECRET:BOOL}"]
25 -> 32 [label = "t_53:{group_mark:SECRET:BOOL}"]
25 -> 33 [label = "t_53:{group_mark:SECRET:BOOL}"]
26 -> 33 [label = "t_54:{group_mark:SECRET:INT64}"]
27 -> 28 [label = "t_55:{encrypt_int_0:SECRET:INT64}"]
28 -> 29 [label = "t_56:{group_mark:SECRET:BOOL}"]
29 -> 30 [label = "t_57:{LogicalOr_out:SECRET:BOOL}"]
3 -> 8 [label = "t_8:{groupby_int_0:PRIVATE:INT64}"]
30 -> 33 [label = "t_58:{LogicalOr_out:SECRET:INT64}"]
31 -> 33 [label = "t_59:{aggregate_int_0:SECRET:INT64}"]
32 -> 33 [label = "t_60:{aggregate_int_0:SECRET:INT64}"]
33 -> 34 [label = "t_65:{group_mark:SECRET:BOOL}"]
33 -> 35 [label = "t_61:{group_mark:SECRET:INT64}"]
33 -> 35 [label = "t_62:{LogicalOr_out:SECRET:INT64}"]
33 -> 35 [label = "t_63:{aggregate_int_0:SECRET:INT64}"]
33 -> 35 [label = "t_64:{aggregate_int_0:SECRET:INT64}"]
34 -> 35 [label = "t_66:{group_mark:PUBLIC:BOOL}"]
35 -> 37 [label = "t_67:{group_mark:SECRET:INT64}"]
35 -> 38 [label = "t_67:{group_mark:SECRET:INT64}"]
35 -> 42 [label = "t_67:{group_mark:SECRET:INT64}"]
35 -> 42 [label = "t_68:{LogicalOr_out:SECRET:INT64}"]
35 -> 42 [label = "t_69:{aggregate_int_0:SECRET:INT64}"]
35 -> 42 [label = "t_70:{aggregate_int_0:SECRET:INT64}"]
36 -> 37 [label = "t_71:{constant_data:PUBLIC:INT64}"]
37 -> 39 [label = "t_72:{constant_data:PUBLIC:INT64}"]
38 -> 40 [label = "t_73:{group_mark:PRIVATE:INT64}"]
39 -> 40 [label = "t_74:{constant_data:PRIVATE:INT64}"]
4 -> 6 [label = "t_12:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_10:{encrypt_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_11:{groupby_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_9:{aggregate_int_0:PRIVATE:INT64}"]
40 -> 41 [label = "t_75:{GreaterEqual_out:PRIVATE:BOOL}"]
41 -> 42 [label = "t_76:{GreaterEqual_out:PUBLIC:BOOL}"]
42 -> 43 [label = "t_77:{group_mark:SECRET:INT64}"]
42 -> 44 [label = "t_78:{LogicalOr_out:SECRET:INT64}"]
42 -> 45 [label = "t_79:{aggregate_int_0:SECRET:INT64}"]
42 -> 46 [label = "t_80:{aggregate_int_0:SECRET:INT64}"]
43 -> 47 [label = "t_81:{group_mark:PRIVATE:INT64}"]
44 -> 47 [label = "t_83:{LogicalOr_out:PRIVATE:INT64}"]
45 -> 47 [label = "t_85:{aggregate_int_0:PRIVATE:INT64}"]
46 -> 47 [label = "t_87:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_13:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_14:{groupby_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_15:{join_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_17:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_18:{join_int_0:PRIVATE:INT64}"]
8 -> 11 [label = "t_19:{groupby_int_0:PRIVATE:INT64}"]
9 -> 12 [label = "t_22:{groupby_int_0:PRIVATE:INT64}"]
9 -> 16 [label = "t_20:{aggregate_int_0:PRIVATE:INT64}"]
9 -> 17 [label = "t_21:{encrypt_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: true}},
	{`select plain_string_0 in (select plain_int_0 from alice.tbl_1) as da from alice.tbl_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_string_0 in (select tbl_1.plain_int_0 from alice.tbl_1) as da from alice.tbl_0;,table_refs:[alice.tbl_0 alice.tbl_1],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{Column#241:PRIVATE:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select plain_string_0 from alice.tbl_0 where plain_string_0 in (select plain_int_0 from alice.tbl_1)`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_string_0 from alice.tbl_0 where tbl_0.plain_string_0 in (select tbl_1.plain_int_0 from alice.tbl_1);,table_refs:[alice.tbl_0 alice.tbl_1],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{plain_string_0:PRIVATE:STRING}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select count(*) as c, count(distinct bob.encrypt_int_0) as cd, sum(bob.aggregate_int_0) as sb, sum(carol.aggregate_int_0) as sc from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.join_int_0 = bob.join_int_0 and bob.join_int_0 = carol.join_int_0 group by alice.groupby_int_0, bob.groupby_int_0, carol.groupby_int_0, carol.groupby_string_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.groupby_int_0,alice.join_int_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,t_4,t_5,},],attr:[sql:select bob.aggregate_int_0,bob.encrypt_int_0,bob.groupby_int_0,bob.join_int_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_5,},],out:[LeftJoinIndex:{t_6,},RightJoinIndex:{t_7,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,t_4,t_5,},RowsIndexFilter:{t_7,},],out:[Out:{t_9,t_10,t_11,t_12,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_13,t_14,t_15,t_16,},],attr:[sql:select carol.aggregate_int_0,carol.groupby_int_0,carol.groupby_string_0,carol.join_int_0 from carol.tbl_0 as carol;,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_12,},Right:{t_16,},],out:[LeftJoinIndex:{t_17,},RightJoinIndex:{t_18,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_17,},],out:[Out:{t_19,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_8,},RowsIndexFilter:{t_19,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_9,t_10,t_11,},RowsIndexFilter:{t_17,},],out:[Out:{t_21,t_22,t_23,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_13,t_14,t_15,},RowsIndexFilter:{t_18,},],out:[Out:{t_24,t_25,t_26,},],attr:[],party:[carol,]}"]
11 [label="make_share:{in:[In:{t_20,},],out:[Out:{t_27,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_23,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_share:{in:[In:{t_25,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_26,},],out:[Out:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="make_share:{in:[In:{t_21,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_share:{in:[In:{t_22,},],out:[Out:{t_32,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="make_share:{in:[In:{t_24,},],out:[Out:{t_33,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="sort:{in:[In:{t_27,t_28,t_29,t_30,t_27,t_31,t_32,t_28,t_33,t_29,t_30,},Key:{t_27,t_28,t_29,t_30,},],out:[Out:{t_34,t_35,t_36,t_37,t_38,t_39,t_40,t_41,t_42,t_43,t_44,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
19 [label="group_mark:{in:[Key:{t_34,t_35,t_36,t_37,},],out:[Group:{t_45,},],attr:[],party:[alice,bob,carol,]}"]
20 [label="count:{in:[Group:{t_45,},In:{t_45,},],out:[Out:{t_46,},],attr:[],party:[alice,bob,carol,]}"]
21 [label="sort:{in:[In:{t_40,},Key:{t_34,t_35,t_36,t_37,t_40,},],out:[Out:{t_47,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
22 [label="group_mark:{in:[Key:{t_47,},],out:[Group:{t_48,},],attr:[],party:[alice,bob,carol,]}"]
23 [label="LogicalOr:{in:[Left:{t_45,},Right:{t_48,},],out:[Out:{t_49,},],attr:[],party:[alice,bob,carol,]}"]
24 [label="sum:{in:[Group:{t_45,},In:{t_49,},],out:[Out:{t_50,},],attr:[],party:[alice,bob,carol,]}"]
25 [label="sum:{in:[Group:{t_45,},In:{t_39,},],out:[Out:{t_51,},],attr:[],party:[alice,bob,carol,]}"]
26 [label="sum:{in:[Group:{t_45,},In:{t_42,},],out:[Out:{t_52,},],attr:[],party:[alice,bob,carol,]}"]
27 [label="shuffle:{in:[In:{t_46,t_50,t_51,t_52,t_45,},],out:[Out:{t_53,t_54,t_55,t_56,t_57,},],attr:[],party:[alice,bob,carol,]}"]
28 [label="make_public:{in:[In:{t_57,},],out:[Out:{t_58,},],attr:[],party:[alice,bob,carol,]}"]
29 [label="filter:{in:[Filter:{t_58,},In:{t_53,t_54,t_55,t_56,},],out:[Out:{t_59,t_60,t_61,t_62,},],attr:[],party:[alice,bob,carol,]}"]
30 [label="make_constant:{in:[],out:[Out:{t_63,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
31 [label="broadcast:{in:[In:{t_63,},ShapeRefTensor:{t_59,},],out:[Out:{t_64,},],attr:[],party:[alice,bob,carol,]}"]
32 [label="make_private:{in:[In:{t_59,},],out:[Out:{t_65,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
33 [label="make_private:{in:[In:{t_64,},],out:[Out:{t_66,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
34 [label="GreaterEqual:{in:[Left:{t_65,},Right:{t_66,},],out:[Out:{t_67,},],attr:[],party:[alice,]}"]
35 [label="make_public:{in:[In:{t_67,},],out:[Out:{t_68,},],attr:[],party:[alice,bob,carol,]}"]
36 [label="apply_filter:{in:[Filter:{t_68,},In:{t_59,t_60,t_61,t_62,},],out:[Out:{t_69,t_70,t_71,t_72,},],attr:[],party:[alice,bob,carol,]}"]
37 [label="make_private:{in:[In:{t_69,},],out:[Out:{t_73,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
38 [label="make_private:{in:[In:{t_70,},],out:[Out:{t_75,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
39 [label="make_private:{in:[In:{t_71,},],out:[Out:{t_77,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
40 [label="make_private:{in:[In:{t_72,},],out:[Out:{t_79,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
41 [label="publish:{in:[In:{t_73,t_75,t_77,t_79,},],out:[Out:{t_74,t_76,t_78,t_80,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{groupby_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{aggregate_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{encrypt_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{groupby_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
10 -> 13 [label = "t_25:{groupby_int_0:PRIVATE:INT64}"]
10 -> 14 [label = "t_26:{groupby_string_0:PRIVATE:STRING}"]
10 -> 17 [label = "t_24:{aggregate_int_0:PRIVATE:INT64}"]
11 -> 18 [label = "t_27:{groupby_int_0:SECRET:INT64}"]
11 -> 18 [label = "t_27:{groupby_int_0:SECRET:INT64}"]
11 -> 18 [label = "t_27:{groupby_int_0:SECRET:INT64}"]
12 -> 18 [label = "t_28:{groupby_int_0:SECRET:INT64}"]
12 -> 18 [label = "t_28:{groupby_int_0:SECRET:INT64}"]
12 -> 18 [label = "t_28:{groupby_int_0:SECRET:INT64}"]
13 -> 18 [label = "t_29:{groupby_int_0:SECRET:INT64}"]
13 -> 18 [label = "t_29:{groupby_int_0:SECRET:INT64}"]
13 -> 18 [label = "t_29:{groupby_int_0:SECRET:INT64}"]
14 -> 18 [label = "t_30:{groupby_string_0:SECRET:STRING}"]
14 -> 18 [label = "t_30:{groupby_string_0:SECRET:STRING}"]
14 -> 18 [label = "t_30:{groupby_string_0:SECRET:STRING}"]
15 -> 18 [label = "t_31:{aggregate_int_0:SECRET:INT64}"]
16 -> 18 [label = "t_32:{encrypt_int_0:SECRET:INT64}"]
17 -> 18 [label = "t_33:{aggregate_int_0:SECRET:INT64}"]
18 -> 19 [label = "t_34:{groupby_int_0:SECRET:INT64}"]
18 -> 19 [label = "t_35:{groupby_int_0:SECRET:INT64}"]
18 -> 19 [label = "t_36:{groupby_int_0:SECRET:INT64}"]
18 -> 19 [label = "t_37:{groupby_string_0:SECRET:STRING}"]
18 -> 21 [label = "t_34:{groupby_int_0:SECRET:INT64}"]
18 -> 21 [label = "t_35:{groupby_int_0:SECRET:INT64}"]
18 -> 21 [label = "t_36:{groupby_int_0:SECRET:INT64}"]
18 -> 21 [label = "t_37:{groupby_string_0:SECRET:STRING}"]
18 -> 21 [label = "t_40:{encrypt_int_0:SECRET:INT64}"]
18 -> 21 [label = "t_40:{encrypt_int_0:SECRET:INT64}"]
18 -> 25 [label = "t_39:{aggregate_int_0:SECRET:INT64}"]
18 -> 26 [label = "t_42:{aggregate_int_0:SECRET:INT64}"]
19 -> 20 [label = "t_45:{group_mark:SECRET:BOOL}"]
19 -> 20 [label = "t_45:{group_mark:SECRET:BOOL}"]
19 -> 23 [label = "t_45:{group_mark:SECRET:BOOL}"]
19 -> 24 [label = "t_45:{group_mark:SECRET:BOOL}"]
19 -> 25 [label = "t_45:{group_mark:SECRET:BOOL}"]
19 -> 26 [label = "t_45:{group_mark:SECRET:BOOL}"]
19 -> 27 [label = "t_45:{group_mark:SECRET:BOOL}"]
2 -> 3 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
20 -> 27 [label = "t_46:{group_mark:SECRET:INT64}"]
21 -> 22 [label = "t_47:{encrypt_int_0:SECRET:INT64}"]
22 -> 23 [label = "t_48:{group_mark:SECRET:BOOL}"]
23 -> 24 [label = "t_49:{LogicalOr_out:SECRET:BOOL}"]
24 -> 27 [label = "t_50:{LogicalOr_out:SECRET:INT64}"]
25 -> 27 [label = "t_51:{aggregate_int_0:SECRET:INT64}"]
26 -> 27 [label = "t_52:{aggregate_int_0:SECRET:INT64}"]
27 -> 28 [label = "t_57:{group_mark:SECRET:BOOL}"]
27 -> 29 [label = "t_53:{group_mark:SECRET:INT64}"]
27 -> 29 [label = "t_54:{LogicalOr_out:SECRET:INT64}"]
27 -> 29 [label = "t_55:{aggregate_int_0:SECRET:INT64}"]
27 -> 29 [label = "t_56:{aggregate_int_0:SECRET:INT64}"]
28 -> 29 [label = "t_58:{group_mark:PUBLIC:BOOL}"]
29 -> 31 [label = "t_59:{group_mark:SECRET:INT64}"]
29 -> 32 [label = "t_59:{group_mark:SECRET:INT64}"]
29 -> 36 [label = "t_59:{group_mark:SECRET:INT64}"]
29 -> 36 [label = "t_60:{LogicalOr_out:SECRET:INT64}"]
29 -> 36 [label = "t_61:{aggregate_int_0:SECRET:INT64}"]
29 -> 36 [label = "t_62:{aggregate_int_0:SECRET:INT64}"]
3 -> 8 [label = "t_8:{groupby_int_0:PRIVATE:INT64}"]
30 -> 31 [label = "t_63:{constant_data:PUBLIC:INT64}"]
31 -> 33 [label = "t_64:{constant_data:PUBLIC:INT64}"]
32 -> 34 [label = "t_65:{group_mark:PRIVATE:INT64}"]
33 -> 34 [label = "t_66:{constant_data:PRIVATE:INT64}"]
34 -> 35 [label = "t_67:{GreaterEqual_out:PRIVATE:BOOL}"]
35 -> 36 [label = "t_68:{GreaterEqual_out:PUBLIC:BOOL}"]
36 -> 37 [label = "t_69:{group_mark:SECRET:INT64}"]
36 -> 38 [label = "t_70:{LogicalOr_out:SECRET:INT64}"]
36 -> 39 [label = "t_71:{aggregate_int_0:SECRET:INT64}"]
36 -> 40 [label = "t_72:{aggregate_int_0:SECRET:INT64}"]
37 -> 41 [label = "t_73:{group_mark:PRIVATE:INT64}"]
38 -> 41 [label = "t_75:{LogicalOr_out:PRIVATE:INT64}"]
39 -> 41 [label = "t_77:{aggregate_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_12:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_10:{encrypt_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_11:{groupby_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_9:{aggregate_int_0:PRIVATE:INT64}"]
40 -> 41 [label = "t_79:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_13:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_14:{groupby_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_15:{groupby_string_0:PRIVATE:STRING}"]
5 -> 6 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_18:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_17:{join_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_17:{join_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_19:{join_int_0:PRIVATE:INT64}"]
8 -> 11 [label = "t_20:{groupby_int_0:PRIVATE:INT64}"]
9 -> 12 [label = "t_23:{groupby_int_0:PRIVATE:INT64}"]
9 -> 15 [label = "t_21:{aggregate_int_0:PRIVATE:INT64}"]
9 -> 16 [label = "t_22:{encrypt_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select count(*) as c, count(distinct bob.encrypt_int_0) as cd, sum(bob.aggregate_int_0) as sb, sum(carol.aggregate_int_0) as sc from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.join_int_0 = bob.join_int_0 and bob.join_int_0 = carol.join_int_0 group by alice.groupby_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.groupby_int_0,alice.join_int_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,t_4,},],attr:[sql:select bob.aggregate_int_0,bob.encrypt_int_0,bob.join_int_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_4,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{t_6,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,t_4,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,t_9,t_10,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_11,t_12,},],attr:[sql:select carol.aggregate_int_0,carol.join_int_0 from carol.tbl_0 as carol;,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_10,},Right:{t_12,},],out:[LeftJoinIndex:{t_13,},RightJoinIndex:{t_14,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_13,},],out:[Out:{t_15,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_7,},RowsIndexFilter:{t_15,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_8,t_9,},RowsIndexFilter:{t_13,},],out:[Out:{t_17,t_18,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_11,},RowsIndexFilter:{t_14,},],out:[Out:{t_19,},],attr:[],party:[carol,]}"]
11 [label="make_share:{in:[In:{t_16,},],out:[Out:{t_20,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_17,},],out:[Out:{t_21,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_share:{in:[In:{t_18,},],out:[Out:{t_22,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_19,},],out:[Out:{t_23,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="sort:{in:[In:{t_20,t_20,t_21,t_22,t_23,},Key:{t_20,},],out:[Out:{t_24,t_25,t_26,t_27,t_28,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
16 [label="group_mark:{in:[Key:{t_24,},],out:[Group:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="count:{in:[Group:{t_29,},In:{t_29,},],out:[Out:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="sort:{in:[In:{t_27,},Key:{t_24,t_27,},],out:[Out:{t_31,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
19 [label="group_mark:{in:[Key:{t_31,},],out:[Group:{t_32,},],attr:[],party:[alice,bob,carol,]}"]
20 [label="LogicalOr:{in:[Left:{t_29,},Right:{t_32,},],out:[Out:{t_33,},],attr:[],party:[alice,bob,carol,]}"]
21 [label="sum:{in:[Group:{t_29,},In:{t_33,},],out:[Out:{t_34,},],attr:[],party:[alice,bob,carol,]}"]
22 [label="sum:{in:[Group:{t_29,},In:{t_26,},],out:[Out:{t_35,},],attr:[],party:[alice,bob,carol,]}"]
23 [label="sum:{in:[Group:{t_29,},In:{t_28,},],out:[Out:{t_36,},],attr:[],party:[alice,bob,carol,]}"]
24 [label="shuffle:{in:[In:{t_30,t_34,t_35,t_36,t_29,},],out:[Out:{t_37,t_38,t_39,t_40,t_41,},],attr:[],party:[alice,bob,carol,]}"]
25 [label="make_public:{in:[In:{t_41,},],out:[Out:{t_42,},],attr:[],party:[alice,bob,carol,]}"]
26 [label="filter:{in:[Filter:{t_42,},In:{t_37,t_38,t_39,t_40,},],out:[Out:{t_43,t_44,t_45,t_46,},],attr:[],party:[alice,bob,carol,]}"]
27 [label="make_constant:{in:[],out:[Out:{t_47,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
28 [label="broadcast:{in:[In:{t_47,},ShapeRefTensor:{t_43,},],out:[Out:{t_48,},],attr:[],party:[alice,bob,carol,]}"]
29 [label="make_private:{in:[In:{t_43,},],out:[Out:{t_49,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
30 [label="make_private:{in:[In:{t_48,},],out:[Out:{t_50,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
31 [label="GreaterEqual:{in:[Left:{t_49,},Right:{t_50,},],out:[Out:{t_51,},],attr:[],party:[alice,]}"]
32 [label="make_public:{in:[In:{t_51,},],out:[Out:{t_52,},],attr:[],party:[alice,bob,carol,]}"]
33 [label="apply_filter:{in:[Filter:{t_52,},In:{t_43,t_44,t_45,t_46,},],out:[Out:{t_53,t_54,t_55,t_56,},],attr:[],party:[alice,bob,carol,]}"]
34 [label="make_private:{in:[In:{t_53,},],out:[Out:{t_57,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
35 [label="make_private:{in:[In:{t_54,},],out:[Out:{t_59,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
36 [label="make_private:{in:[In:{t_55,},],out:[Out:{t_61,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
37 [label="make_private:{in:[In:{t_56,},],out:[Out:{t_63,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
38 [label="publish:{in:[In:{t_57,t_59,t_61,t_63,},],out:[Out:{t_58,t_60,t_62,t_64,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{groupby_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{aggregate_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{encrypt_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
10 -> 14 [label = "t_19:{aggregate_int_0:PRIVATE:INT64}"]
11 -> 15 [label = "t_20:{groupby_int_0:SECRET:INT64}"]
11 -> 15 [label = "t_20:{groupby_int_0:SECRET:INT64}"]
11 -> 15 [label = "t_20:{groupby_int_0:SECRET:INT64}"]
12 -> 15 [label = "t_21:{aggregate_int_0:SECRET:INT64}"]
13 -> 15 [label = "t_22:{encrypt_int_0:SECRET:INT64}"]
14 -> 15 [label = "t_23:{aggregate_int_0:SECRET:INT64}"]
15 -> 16 [label = "t_24:{groupby_int_0:SECRET:INT64}"]
15 -> 18 [label = "t_24:{groupby_int_0:SECRET:INT64}"]
15 -> 18 [label = "t_27:{encrypt_int_0:SECRET:INT64}"]
15 -> 18 [label = "t_27:{encrypt_int_0:SECRET:INT64}"]
15 -> 22 [label = "t_26:{aggregate_int_0:SECRET:INT64}"]
15 -> 23 [label = "t_28:{aggregate_int_0:SECRET:INT64}"]
16 -> 17 [label = "t_29:{group_mark:SECRET:BOOL}"]
16 -> 17 [label = "t_29:{group_mark:SECRET:BOOL}"]
16 -> 20 [label = "t_29:{group_mark:SECRET:BOOL}"]
16 -> 21 [label = "t_29:{group_mark:SECRET:BOOL}"]
16 -> 22 [label = "t_29:{group_mark:SECRET:BOOL}"]
16 -> 23 [label = "t_29:{group_mark:SECRET:BOOL}"]
16 -> 24 [label = "t_29:{group_mark:SECRET:BOOL}"]
17 -> 24 [label = "t_30:{group_mark:SECRET:INT64}"]
18 -> 19 [label = "t_31:{encrypt_int_0:SECRET:INT64}"]
19 -> 20 [label = "t_32:{group_mark:SECRET:BOOL}"]
2 -> 3 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
20 -> 21 [label = "t_33:{LogicalOr_out:SECRET:BOOL}"]
21 -> 24 [label = "t_34:{LogicalOr_out:SECRET:INT64}"]
22 -> 24 [label = "t_35:{aggregate_int_0:SECRET:INT64}"]
23 -> 24 [label = "t_36:{aggregate_int_0:SECRET:INT64}"]
24 -> 25 [label = "t_41:{group_mark:SECRET:BOOL}"]
24 -> 26 [label = "t_37:{group_mark:SECRET:INT64}"]
24 -> 26 [label = "t_38:{LogicalOr_out:SECRET:INT64}"]
24 -> 26 [label = "t_39:{aggregate_int_0:SECRET:INT64}"]
24 -> 26 [label = "t_40:{aggregate_int_0:SECRET:INT64}"]
25 -> 26 [label = "t_42:{group_mark:PUBLIC:BOOL}"]
26 -> 28 [label = "t_43:{group_mark:SECRET:INT64}"]
26 -> 29 [label = "t_43:{group_mark:SECRET:INT64}"]
26 -> 33 [label = "t_43:{group_mark:SECRET:INT64}"]
26 -> 33 [label = "t_44:{LogicalOr_out:SECRET:INT64}"]
26 -> 33 [label = "t_45:{aggregate_int_0:SECRET:INT64}"]
26 -> 33 [label = "t_46:{aggregate_int_0:SECRET:INT64}"]
27 -> 28 [label = "t_47:{constant_data:PUBLIC:INT64}"]
28 -> 30 [label = "t_48:{constant_data:PUBLIC:INT64}"]
29 -> 31 [label = "t_49:{group_mark:PRIVATE:INT64}"]
3 -> 8 [label = "t_7:{groupby_int_0:PRIVATE:INT64}"]
30 -> 31 [label = "t_50:{constant_data:PRIVATE:INT64}"]
31 -> 32 [label = "t_51:{GreaterEqual_out:PRIVATE:BOOL}"]
32 -> 33 [label = "t_52:{GreaterEqual_out:PUBLIC:BOOL}"]
33 -> 34 [label = "t_53:{group_mark:SECRET:INT64}"]
33 -> 35 [label = "t_54:{LogicalOr_out:SECRET:INT64}"]
33 -> 36 [label = "t_55:{aggregate_int_0:SECRET:INT64}"]
33 -> 37 [label = "t_56:{aggregate_int_0:SECRET:INT64}"]
34 -> 38 [label = "t_57:{group_mark:PRIVATE:INT64}"]
35 -> 38 [label = "t_59:{LogicalOr_out:PRIVATE:INT64}"]
36 -> 38 [label = "t_61:{aggregate_int_0:PRIVATE:INT64}"]
37 -> 38 [label = "t_63:{aggregate_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_10:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_8:{aggregate_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_9:{encrypt_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_11:{aggregate_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_12:{join_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_14:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_15:{join_int_0:PRIVATE:INT64}"]
8 -> 11 [label = "t_16:{groupby_int_0:PRIVATE:INT64}"]
9 -> 12 [label = "t_17:{aggregate_int_0:PRIVATE:INT64}"]
9 -> 13 [label = "t_18:{encrypt_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select (alice.join_int_0 + bob.compare_int_0 + carol.compare_int_0) <> 0 as reduce_res from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.join_int_0 = bob.join_int_0 and bob.join_int_0 = carol.join_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select alice.join_int_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,t_2,},],attr:[sql:select bob.compare_int_0,bob.join_int_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_8,t_9,},],attr:[sql:select carol.compare_int_0,carol.join_int_0 from carol.tbl_0 as carol;,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_7,},Right:{t_9,},],out:[LeftJoinIndex:{t_10,},RightJoinIndex:{t_11,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_10,},],out:[Out:{t_12,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_5,},RowsIndexFilter:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_6,},RowsIndexFilter:{t_10,},],out:[Out:{t_14,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_8,},RowsIndexFilter:{t_11,},],out:[Out:{t_15,},],attr:[],party:[carol,]}"]
11 [label="copy:{in:[In:{t_13,},],out:[Out:{t_16,},],attr:[input_party_codes:alice,output_party_codes:bob,],party:[alice,bob,]}"]
12 [label="Add:{in:[Left:{t_16,},Right:{t_14,},],out:[Out:{t_17,},],attr:[],party:[bob,]}"]
13 [label="make_share:{in:[In:{t_17,},],out:[Out:{t_18,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_15,},],out:[Out:{t_19,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="Add:{in:[Left:{t_18,},Right:{t_19,},],out:[Out:{t_20,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_constant:{in:[],out:[Out:{t_21,},],attr:[scalar:0,],party:[alice,bob,carol,]}"]
17 [label="broadcast:{in:[In:{t_21,},ShapeRefTensor:{t_20,},],out:[Out:{t_22,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="NotEqual:{in:[Left:{t_20,},Right:{t_22,},],out:[Out:{t_23,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="make_private:{in:[In:{t_23,},],out:[Out:{t_24,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
20 [label="publish:{in:[In:{t_24,},],out:[Out:{t_25,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
10 -> 14 [label = "t_15:{compare_int_0:PRIVATE:INT64}"]
11 -> 12 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
12 -> 13 [label = "t_17:{Add_out:PRIVATE:INT64}"]
13 -> 15 [label = "t_18:{Add_out:SECRET:INT64}"]
14 -> 15 [label = "t_19:{compare_int_0:SECRET:INT64}"]
15 -> 17 [label = "t_20:{Add_out:SECRET:INT64}"]
15 -> 18 [label = "t_20:{Add_out:SECRET:INT64}"]
16 -> 17 [label = "t_21:{constant_data:PUBLIC:INT64}"]
17 -> 18 [label = "t_22:{constant_data:PUBLIC:INT64}"]
18 -> 19 [label = "t_23:{NotEqual_out:SECRET:BOOL}"]
19 -> 20 [label = "t_24:{NotEqual_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_8:{compare_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_9:{join_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_11:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_10:{join_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_10:{join_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_12:{join_int_0:PRIVATE:INT64}"]
8 -> 11 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
9 -> 12 [label = "t_14:{compare_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select alice.plain_int_0 + bob.join_int_0 + carol.join_int_0 as add_res, alice.plain_int_0 - bob.join_int_0 - carol.join_int_0 as minus_res, alice.plain_int_0 * bob.join_int_0 * carol.join_int_0 as multi_res, alice.plain_int_0 / bob.join_int_0 / carol.join_int_0 as div_res from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.join_int_0 = bob.join_int_0 and bob.join_int_0 = carol.join_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.join_int_0,alice.plain_int_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select bob.join_int_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{t_4,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_7,},],attr:[sql:select carol.join_int_0 from carol.tbl_0 as carol;,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_6,},Right:{t_7,},],out:[LeftJoinIndex:{t_8,},RightJoinIndex:{t_9,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_8,},],out:[Out:{t_10,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_5,},RowsIndexFilter:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_6,},RowsIndexFilter:{t_8,},],out:[Out:{t_12,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_7,},RowsIndexFilter:{t_9,},],out:[Out:{t_13,},],attr:[],party:[carol,]}"]
11 [label="copy:{in:[In:{t_12,},],out:[Out:{t_14,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
12 [label="Add:{in:[Left:{t_11,},Right:{t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
13 [label="copy:{in:[In:{t_13,},],out:[Out:{t_16,},],attr:[input_party_codes:carol,output_party_codes:alice,],party:[carol,alice,]}"]
14 [label="Add:{in:[Left:{t_15,},Right:{t_16,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
15 [label="Minus:{in:[Left:{t_11,},Right:{t_14,},],out:[Out:{t_18,},],attr:[],party:[alice,]}"]
16 [label="Minus:{in:[Left:{t_18,},Right:{t_16,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
17 [label="Mul:{in:[Left:{t_11,},Right:{t_14,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
18 [label="Mul:{in:[Left:{t_20,},Right:{t_16,},],out:[Out:{t_21,},],attr:[],party:[alice,]}"]
19 [label="cast:{in:[In:{t_11,},],out:[Out:{t_22,},],attr:[],party:[alice,]}"]
20 [label="Div:{in:[Left:{t_22,},Right:{t_14,},],out:[Out:{t_23,},],attr:[],party:[alice,]}"]
21 [label="Div:{in:[Left:{t_23,},Right:{t_16,},],out:[Out:{t_24,},],attr:[],party:[alice,]}"]
22 [label="publish:{in:[In:{t_17,t_19,t_21,t_24,},],out:[Out:{t_25,t_26,t_27,t_28,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
10 -> 13 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
11 -> 12 [label = "t_14:{join_int_0:PRIVATE:INT64}"]
11 -> 15 [label = "t_14:{join_int_0:PRIVATE:INT64}"]
11 -> 17 [label = "t_14:{join_int_0:PRIVATE:INT64}"]
11 -> 20 [label = "t_14:{join_int_0:PRIVATE:INT64}"]
12 -> 14 [label = "t_15:{Add_out:PRIVATE:INT64}"]
13 -> 14 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
13 -> 16 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
13 -> 18 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
13 -> 21 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
14 -> 22 [label = "t_17:{Add_out:PRIVATE:INT64}"]
15 -> 16 [label = "t_18:{Minus_out:PRIVATE:INT64}"]
16 -> 22 [label = "t_19:{Minus_out:PRIVATE:INT64}"]
17 -> 18 [label = "t_20:{Mul_out:PRIVATE:INT64}"]
18 -> 22 [label = "t_21:{Mul_out:PRIVATE:INT64}"]
19 -> 20 [label = "t_22:{plain_int_0:PRIVATE:FLOAT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
20 -> 21 [label = "t_23:{Div_out:PRIVATE:FLOAT64}"]
21 -> 22 [label = "t_24:{Div_out:PRIVATE:FLOAT64}"]
3 -> 8 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_9:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_8:{join_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_8:{join_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_10:{join_int_0:PRIVATE:INT64}"]
8 -> 12 [label = "t_11:{plain_int_0:PRIVATE:INT64}"]
8 -> 15 [label = "t_11:{plain_int_0:PRIVATE:INT64}"]
8 -> 17 [label = "t_11:{plain_int_0:PRIVATE:INT64}"]
8 -> 19 [label = "t_11:{plain_int_0:PRIVATE:INT64}"]
9 -> 11 [label = "t_12:{join_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select concat(plain_string_0, plain_string_1) as tt from alice.tbl_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select concat(tbl_0.plain_string_0, tbl_0.plain_string_1) as tt from alice.tbl_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{Column#121:PRIVATE:STRING}"]
}`, `
pipeline 0 {
Batched: false
node: [runsql_0 publish_1]
Inputs: []
Outputs: []
}
`, testConf{groupThreshold: 0, batched: true, revealGroupCount: false}},
	{`select count(*) as c from alice.tbl_1 join alice.tbl_2 on tbl_1.plain_int_0 = tbl_2.plain_int_0 group by tbl_1.plain_float_0 having count(*) > 3`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select count(1) as c from alice.tbl_1 join alice.tbl_2 on tbl_1.plain_int_0=tbl_2.plain_int_0 group by tbl_1.plain_float_0 having (count(1)>3) and (count(1)>=4);,table_refs:[alice.tbl_1 alice.tbl_2],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{Column#242:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select tbl_1.plain_float_0 from alice.tbl_1 join alice.tbl_2 on tbl_1.plain_int_0 = tbl_2.plain_int_0 group by tbl_1.plain_float_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(tbl_1.plain_float_0) as expr_94 from alice.tbl_1 join alice.tbl_2 on tbl_1.plain_int_0=tbl_2.plain_int_0 group by tbl_1.plain_float_0 having count(1)>=4;,table_refs:[alice.tbl_1 alice.tbl_2],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{plain_float_0:PRIVATE:FLOAT32}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select plain_int_0 from alice.tbl_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_int_0 from alice.tbl_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select count(*) as c, sum(plain_int_0) as b, max(plain_int_0) as a, min(plain_int_0) as d from alice.tbl_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,t_3,},],attr:[sql:select count(1) as c,sum(tbl_0.plain_int_0) as b,max(tbl_0.plain_int_0) as a,min(tbl_0.plain_int_0) as d from alice.tbl_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,t_1,t_2,t_3,},],out:[Out:{t_4,t_5,t_6,t_7,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{Column#121:PRIVATE:INT64}"]
0 -> 1 [label = "t_1:{Column#122:PRIVATE:INT64}"]
0 -> 1 [label = "t_2:{Column#123:PRIVATE:INT64}"]
0 -> 1 [label = "t_3:{Column#124:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select plain_int_0 from alice.tbl_0 into outfile '/tmp/output.txt' fields terminated BY ','`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_int_0 from alice.tbl_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="dump_file:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[field_deliminator:,,file_path:/tmp/output.txt,line_terminator:
,quoting_style:0,],party:[alice,]}"]
0 -> 1 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select plain_int_0 from alice.tbl_0 into outfile party_code 'alice' '/tmp/output.txt' columns terminated BY '|' optionally enclosed BY '"' lines terminated BY 'end of line';`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_int_0 from alice.tbl_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="dump_file:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[field_deliminator:|,file_path:/tmp/output.txt,line_terminator:end of line,quoting_style:1,],party:[alice,]}"]
0 -> 1 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select plain_int_0 from alice.tbl_0 into outfile party_code 'alice' '/tmp/output_alice.txt' party_code 'bob' '/tmp/output_bob.txt' party_code 'carol' '/tmp/output_carol.txt';`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_int_0 from alice.tbl_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="dump_file:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[field_deliminator:	,file_path:/tmp/output_alice.txt,line_terminator:
,quoting_style:0,],party:[alice,]}"]
2 [label="copy:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[input_party_codes:alice,output_party_codes:bob,],party:[alice,bob,]}"]
3 [label="dump_file:{in:[In:{t_2,},],out:[Out:{t_3,},],attr:[field_deliminator:	,file_path:/tmp/output_bob.txt,line_terminator:
,quoting_style:0,],party:[bob,]}"]
4 [label="copy:{in:[In:{t_0,},],out:[Out:{t_4,},],attr:[input_party_codes:alice,output_party_codes:carol,],party:[alice,carol,]}"]
5 [label="dump_file:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[field_deliminator:	,file_path:/tmp/output_carol.txt,line_terminator:
,quoting_style:0,],party:[carol,]}"]
0 -> 1 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 4 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select plain_int_0 from alice.tbl_0 into outfile party_code 'bob' '/tmp/output_bob.txt' party_code 'carol' '/tmp/output_carol.txt' fields terminated BY ',';`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_int_0 from alice.tbl_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="copy:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[input_party_codes:alice,output_party_codes:bob,],party:[alice,bob,]}"]
2 [label="dump_file:{in:[In:{t_1,},],out:[Out:{t_2,},],attr:[field_deliminator:,,file_path:/tmp/output_bob.txt,line_terminator:
,quoting_style:0,],party:[bob,]}"]
3 [label="copy:{in:[In:{t_0,},],out:[Out:{t_3,},],attr:[input_party_codes:alice,output_party_codes:carol,],party:[alice,carol,]}"]
4 [label="dump_file:{in:[In:{t_3,},],out:[Out:{t_4,},],attr:[field_deliminator:,,file_path:/tmp/output_carol.txt,line_terminator:
,quoting_style:0,],party:[carol,]}"]
0 -> 1 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select plain_int_0 from bob.tbl_0 into outfile party_code 'alice' '/tmp/output_alice.txt' party_code 'carol' '/tmp/output_carol.txt' fields terminated BY ',';`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_int_0 from bob.tbl_0;,table_refs:[bob.tbl_0],],party:[bob,]}"]
1 [label="copy:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
2 [label="dump_file:{in:[In:{t_1,},],out:[Out:{t_2,},],attr:[field_deliminator:,,file_path:/tmp/output_alice.txt,line_terminator:
,quoting_style:0,],party:[alice,]}"]
3 [label="copy:{in:[In:{t_0,},],out:[Out:{t_3,},],attr:[input_party_codes:bob,output_party_codes:carol,],party:[bob,carol,]}"]
4 [label="dump_file:{in:[In:{t_3,},],out:[Out:{t_4,},],attr:[field_deliminator:,,file_path:/tmp/output_carol.txt,line_terminator:
,quoting_style:0,],party:[carol,]}"]
0 -> 1 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select plain_int_0 from bob.tbl_0 into outfile party_code 'carol' '/tmp/output_carol.txt' fields terminated BY ',';`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select tbl_0.plain_int_0 from bob.tbl_0;,table_refs:[bob.tbl_0],],party:[bob,]}"]
1 [label="copy:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[input_party_codes:bob,output_party_codes:carol,],party:[bob,carol,]}"]
2 [label="dump_file:{in:[In:{t_1,},],out:[Out:{t_2,},],attr:[field_deliminator:,,file_path:/tmp/output_carol.txt,line_terminator:
,quoting_style:0,],party:[carol,]}"]
0 -> 1 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.join_int_0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0 into outfile party_code 'alice' '/tmp/output_alice.txt' party_code 'bob' '/tmp/output_bob.txt' fields terminated BY ','`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.join_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="dump_file:{in:[In:{t_3,},],out:[Out:{t_4,},],attr:[field_deliminator:,,file_path:/tmp/output_alice.txt,line_terminator:
,quoting_style:0,],party:[alice,]}"]
5 [label="copy:{in:[In:{t_3,},],out:[Out:{t_5,},],attr:[input_party_codes:alice,output_party_codes:bob,],party:[alice,bob,]}"]
6 [label="dump_file:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[field_deliminator:,,file_path:/tmp/output_bob.txt,line_terminator:
,quoting_style:0,],party:[bob,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select (ta.compare_int_0 + tb.compare_int_0) > 0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0 into outfile party_code 'alice' '/tmp/output.txt' fields terminated BY ','`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.compare_int_0,ta.join_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.compare_int_0,tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_9,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="Add:{in:[Left:{t_8,},Right:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_11,},],attr:[scalar:0,],party:[alice,bob,carol,]}"]
9 [label="broadcast:{in:[In:{t_11,},ShapeRefTensor:{t_10,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="Greater:{in:[Left:{t_10,},Right:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_private:{in:[In:{t_13,},],out:[Out:{t_14,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
12 [label="dump_file:{in:[In:{t_14,},],out:[Out:{t_15,},],attr:[field_deliminator:,,file_path:/tmp/output.txt,line_terminator:
,quoting_style:0,],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{compare_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_13:{Greater_out:SECRET:BOOL}"]
11 -> 12 [label = "t_14:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_8:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_9:{compare_int_0:SECRET:INT64}"]
7 -> 10 [label = "t_10:{Add_out:SECRET:INT64}"]
7 -> 9 [label = "t_10:{Add_out:SECRET:INT64}"]
8 -> 9 [label = "t_11:{constant_data:PUBLIC:INT64}"]
9 -> 10 [label = "t_12:{constant_data:PUBLIC:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select (ta.compare_int_0 + tb.compare_int_0) > 0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0 into outfile party_code 'alice' '/tmp/output_alice.txt' party_code 'bob' '/tmp/output_bob.txt' fields terminated BY ','`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.compare_int_0,ta.join_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.compare_int_0,tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_9,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="Add:{in:[Left:{t_8,},Right:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_11,},],attr:[scalar:0,],party:[alice,bob,carol,]}"]
9 [label="broadcast:{in:[In:{t_11,},ShapeRefTensor:{t_10,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="Greater:{in:[Left:{t_10,},Right:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_private:{in:[In:{t_13,},],out:[Out:{t_14,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
12 [label="dump_file:{in:[In:{t_14,},],out:[Out:{t_15,},],attr:[field_deliminator:,,file_path:/tmp/output_alice.txt,line_terminator:
,quoting_style:0,],party:[alice,]}"]
13 [label="make_private:{in:[In:{t_13,},],out:[Out:{t_16,},],attr:[reveal_to:bob,],party:[alice,bob,carol,]}"]
14 [label="dump_file:{in:[In:{t_16,},],out:[Out:{t_17,},],attr:[field_deliminator:,,file_path:/tmp/output_bob.txt,line_terminator:
,quoting_style:0,],party:[bob,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{compare_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_13:{Greater_out:SECRET:BOOL}"]
10 -> 13 [label = "t_13:{Greater_out:SECRET:BOOL}"]
11 -> 12 [label = "t_14:{Greater_out:PRIVATE:BOOL}"]
13 -> 14 [label = "t_16:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_8:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_9:{compare_int_0:SECRET:INT64}"]
7 -> 10 [label = "t_10:{Add_out:SECRET:INT64}"]
7 -> 9 [label = "t_10:{Add_out:SECRET:INT64}"]
8 -> 9 [label = "t_11:{constant_data:PUBLIC:INT64}"]
9 -> 10 [label = "t_12:{constant_data:PUBLIC:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`insert into testdb.test_table (ci, cl) select a.plain_int_0, b.plain_string_0 from alice.tbl_0 a join bob.tbl_0  b on a.join_int_0=b.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select a.join_int_0,a.plain_int_0 from alice.tbl_0 as a;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select b.join_int_0,b.plain_string_0 from bob.tbl_0 as b;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_7,},],out:[Out:{t_9,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="insert_table:{in:[In:{t_6,t_9,},],out:[Out:{t_8,t_10,},],attr:[column_names:[ci cl],table_name:testdb.test_table,],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{plain_string_0:PRIVATE:STRING}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_7:{plain_string_0:PRIVATE:STRING}"]
5 -> 6 [label = "t_9:{plain_string_0:PRIVATE:STRING}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`insert into test_table (ci, cl) select a.plain_int_0, b.plain_string_0 from alice.tbl_0 a join bob.tbl_0  b on a.join_int_0=b.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select a.join_int_0,a.plain_int_0 from alice.tbl_0 as a;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select b.join_int_0,b.plain_string_0 from bob.tbl_0 as b;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_7,},],out:[Out:{t_9,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="insert_table:{in:[In:{t_6,t_9,},],out:[Out:{t_8,t_10,},],attr:[column_names:[ci cl],table_name:test_table,],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{plain_string_0:PRIVATE:STRING}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_7:{plain_string_0:PRIVATE:STRING}"]
5 -> 6 [label = "t_9:{plain_string_0:PRIVATE:STRING}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.plain_int_0, count(*) as c, sum(ta.plain_int_0) as b, max(ta.plain_int_0) as a, min(ta.plain_int_0) as d from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0 group by ta.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="group:{in:[Key:{t_3,},],out:[GroupId:{t_4,},GroupNum:{t_5,},],attr:[],party:[alice,]}"]
5 [label="count:{in:[GroupId:{t_4,},GroupNum:{t_5,},In:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
6 [label="sum:{in:[GroupId:{t_4,},GroupNum:{t_5,},In:{t_3,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
7 [label="max:{in:[GroupId:{t_4,},GroupNum:{t_5,},In:{t_3,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="min:{in:[GroupId:{t_4,},GroupNum:{t_5,},In:{t_3,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
9 [label="firstrow:{in:[GroupId:{t_4,},GroupNum:{t_5,},In:{t_3,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
10 [label="make_constant:{in:[],out:[Out:{t_11,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
11 [label="broadcast:{in:[In:{t_11,},ShapeRefTensor:{t_6,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
12 [label="GreaterEqual:{in:[Left:{t_6,},Right:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
13 [label="apply_filter:{in:[Filter:{t_13,},In:{t_10,t_6,t_7,t_8,t_9,},],out:[Out:{t_14,t_15,t_16,t_17,t_18,},],attr:[],party:[alice,]}"]
14 [label="publish:{in:[In:{t_14,t_15,t_16,t_17,t_18,},],out:[Out:{t_19,t_20,t_21,t_22,t_23,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_11:{constant_data:PUBLIC:INT64}"]
11 -> 12 [label = "t_12:{constant_data:PRIVATE:INT64}"]
12 -> 13 [label = "t_13:{GreaterEqual_out:PRIVATE:BOOL}"]
13 -> 14 [label = "t_14:{plain_int_0_firstrow:PRIVATE:INT64}"]
13 -> 14 [label = "t_15:{group_id_count:PRIVATE:INT64}"]
13 -> 14 [label = "t_16:{plain_int_0_sum:PRIVATE:INT64}"]
13 -> 14 [label = "t_17:{plain_int_0_max:PRIVATE:INT64}"]
13 -> 14 [label = "t_18:{plain_int_0_min:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_4:{group_id:PRIVATE:INT64}"]
4 -> 5 [label = "t_4:{group_id:PRIVATE:INT64}"]
4 -> 5 [label = "t_5:{group_num:PRIVATE:INT64}"]
4 -> 6 [label = "t_4:{group_id:PRIVATE:INT64}"]
4 -> 6 [label = "t_5:{group_num:PRIVATE:INT64}"]
4 -> 7 [label = "t_4:{group_id:PRIVATE:INT64}"]
4 -> 7 [label = "t_5:{group_num:PRIVATE:INT64}"]
4 -> 8 [label = "t_4:{group_id:PRIVATE:INT64}"]
4 -> 8 [label = "t_5:{group_num:PRIVATE:INT64}"]
4 -> 9 [label = "t_4:{group_id:PRIVATE:INT64}"]
4 -> 9 [label = "t_5:{group_num:PRIVATE:INT64}"]
5 -> 11 [label = "t_6:{group_id_count:PRIVATE:INT64}"]
5 -> 12 [label = "t_6:{group_id_count:PRIVATE:INT64}"]
5 -> 13 [label = "t_6:{group_id_count:PRIVATE:INT64}"]
6 -> 13 [label = "t_7:{plain_int_0_sum:PRIVATE:INT64}"]
7 -> 13 [label = "t_8:{plain_int_0_max:PRIVATE:INT64}"]
8 -> 13 [label = "t_9:{plain_int_0_min:PRIVATE:INT64}"]
9 -> 13 [label = "t_10:{plain_int_0_firstrow:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.groupby_int_0, count(distinct(ta.compare_int_0)), sum(ta.compare_int_0) as b, max(ta.compare_int_0) as a, min(ta.compare_int_0) as d from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0 group by ta.groupby_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select ta.compare_int_0,ta.groupby_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="bucket:{in:[In:{t_2,t_0,t_1,},Key:{t_2,},],out:[Out:{t_6,t_4,t_5,},],attr:[input_party_codes:[alice bob],],party:[alice,]}"]
3 [label="bucket:{in:[In:{t_3,},Key:{t_3,},],out:[Out:{t_7,},],attr:[input_party_codes:[alice bob],],party:[bob,]}"]
4 [label="join:{in:[Left:{t_6,},Right:{t_7,},],out:[LeftJoinIndex:{t_8,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
5 [label="filter_by_index:{in:[Data:{t_4,t_5,},RowsIndexFilter:{t_8,},],out:[Out:{t_9,t_10,},],attr:[],party:[alice,]}"]
6 [label="group:{in:[Key:{t_10,},],out:[GroupId:{t_11,},GroupNum:{t_12,},],attr:[],party:[alice,]}"]
7 [label="count_distinct:{in:[GroupId:{t_11,},GroupNum:{t_12,},In:{t_9,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
8 [label="sum:{in:[GroupId:{t_11,},GroupNum:{t_12,},In:{t_9,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
9 [label="max:{in:[GroupId:{t_11,},GroupNum:{t_12,},In:{t_9,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
10 [label="min:{in:[GroupId:{t_11,},GroupNum:{t_12,},In:{t_9,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
11 [label="firstrow:{in:[GroupId:{t_11,},GroupNum:{t_12,},In:{t_10,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
12 [label="count:{in:[GroupId:{t_11,},GroupNum:{t_12,},In:{t_11,},],out:[Out:{t_18,},],attr:[],party:[alice,]}"]
13 [label="make_constant:{in:[],out:[Out:{t_19,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
14 [label="broadcast:{in:[In:{t_19,},ShapeRefTensor:{t_18,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
15 [label="GreaterEqual:{in:[Left:{t_18,},Right:{t_20,},],out:[Out:{t_21,},],attr:[],party:[alice,]}"]
16 [label="apply_filter:{in:[Filter:{t_21,},In:{t_17,t_13,t_14,t_15,t_16,t_18,},],out:[Out:{t_22,t_23,t_24,t_25,t_26,t_27,},],attr:[],party:[alice,]}"]
17 [label="publish:{in:[In:{t_22,t_23,t_24,t_25,t_26,},],out:[Out:{t_28,t_29,t_30,t_31,t_32,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 2 [label = "t_1:{groupby_int_0:PRIVATE:INT64}"]
0 -> 2 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
0 -> 2 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
10 -> 16 [label = "t_16:{compare_int_0_min:PRIVATE:INT64}"]
11 -> 16 [label = "t_17:{groupby_int_0_firstrow:PRIVATE:INT64}"]
12 -> 14 [label = "t_18:{group_id_count:PRIVATE:INT64}"]
12 -> 15 [label = "t_18:{group_id_count:PRIVATE:INT64}"]
12 -> 16 [label = "t_18:{group_id_count:PRIVATE:INT64}"]
13 -> 14 [label = "t_19:{constant_data:PUBLIC:INT64}"]
14 -> 15 [label = "t_20:{constant_data:PRIVATE:INT64}"]
15 -> 16 [label = "t_21:{GreaterEqual_out:PRIVATE:BOOL}"]
16 -> 17 [label = "t_22:{groupby_int_0_firstrow:PRIVATE:INT64}"]
16 -> 17 [label = "t_23:{compare_int_0_count_distinct:PRIVATE:INT64}"]
16 -> 17 [label = "t_24:{compare_int_0_sum:PRIVATE:INT64}"]
16 -> 17 [label = "t_25:{compare_int_0_max:PRIVATE:INT64}"]
16 -> 17 [label = "t_26:{compare_int_0_min:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
2 -> 5 [label = "t_4:{compare_int_0:PRIVATE:INT64}"]
2 -> 5 [label = "t_5:{groupby_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_9:{compare_int_0:PRIVATE:INT64}"]
5 -> 11 [label = "t_10:{groupby_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_10:{groupby_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_9:{compare_int_0:PRIVATE:INT64}"]
5 -> 8 [label = "t_9:{compare_int_0:PRIVATE:INT64}"]
5 -> 9 [label = "t_9:{compare_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_11:{group_id:PRIVATE:INT64}"]
6 -> 10 [label = "t_12:{group_num:PRIVATE:INT64}"]
6 -> 11 [label = "t_11:{group_id:PRIVATE:INT64}"]
6 -> 11 [label = "t_12:{group_num:PRIVATE:INT64}"]
6 -> 12 [label = "t_11:{group_id:PRIVATE:INT64}"]
6 -> 12 [label = "t_11:{group_id:PRIVATE:INT64}"]
6 -> 12 [label = "t_12:{group_num:PRIVATE:INT64}"]
6 -> 7 [label = "t_11:{group_id:PRIVATE:INT64}"]
6 -> 7 [label = "t_12:{group_num:PRIVATE:INT64}"]
6 -> 8 [label = "t_11:{group_id:PRIVATE:INT64}"]
6 -> 8 [label = "t_12:{group_num:PRIVATE:INT64}"]
6 -> 9 [label = "t_11:{group_id:PRIVATE:INT64}"]
6 -> 9 [label = "t_12:{group_num:PRIVATE:INT64}"]
7 -> 16 [label = "t_13:{compare_int_0_count_distinct:PRIVATE:INT64}"]
8 -> 16 [label = "t_14:{compare_int_0_sum:PRIVATE:INT64}"]
9 -> 16 [label = "t_15:{compare_int_0_max:PRIVATE:INT64}"]
}`, `
pipeline 0 {
Batched: false
node: [runsql_0 runsql_1 bucket_2 bucket_3 join_4]
Inputs: []
Outputs: [t_4 t_5 t_8]
}
pipeline 1 {
Batched: true
node: [filter_by_index_5]
Inputs: [t_4 t_5 t_8]
Outputs: [t_10 t_9]
}
pipeline 2 {
Batched: false
node: [group_6 count_distinct_7 sum_8 max_9 min_10 firstrow_11 count_12 make_constant_13]
Inputs: [t_10 t_9]
Outputs: [t_13 t_14 t_15 t_16 t_17 t_18 t_19]
}
pipeline 3 {
Batched: false
node: [broadcast_14 GreaterEqual_15 apply_filter_16]
Inputs: [t_13 t_14 t_15 t_16 t_17 t_18 t_19]
Outputs: [t_22 t_23 t_24 t_25 t_26]
}
pipeline 4 {
Batched: false
node: [publish_17]
Inputs: [t_22 t_23 t_24 t_25 t_26]
Outputs: []
}
`, testConf{groupThreshold: 0, batched: true, revealGroupCount: false}},
	{`select count(distinct(ta.compare_int_0)), sum(ta.compare_int_0) as b, max(ta.compare_int_0) as a, min(ta.compare_int_0) as d from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.compare_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="unique:{in:[Key:{t_4,},],out:[UniqueKey:{t_5,},],attr:[],party:[alice,]}"]
5 [label="reduce_count:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
6 [label="reduce_sum:{in:[In:{t_4,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
7 [label="reduce_max:{in:[In:{t_4,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="reduce_min:{in:[In:{t_4,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
9 [label="publish:{in:[In:{t_6,t_7,t_8,t_9,},],out:[Out:{t_10,t_11,t_12,t_13,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{compare_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{compare_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_4:{compare_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_4:{compare_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_5:{compare_int_0:PRIVATE:INT64}"]
5 -> 9 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_7:{compare_int_0:PRIVATE:INT64}"]
7 -> 9 [label = "t_8:{compare_int_0:PRIVATE:INT64}"]
8 -> 9 [label = "t_9:{compare_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.plain_int_0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="publish:{in:[In:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.plain_int_0 from alice.tbl_0 as ta left join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:1,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="publish:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.plain_int_0 from alice.tbl_0 as ta left join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0 left join carol.tbl_0 as tc on tb.join_int_1 = tc.join_int_1`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.join_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.join_int_0,tb.join_int_1 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:1,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_8,},],attr:[sql:select tc.join_int_1 from carol.tbl_0 as tc;,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_7,},Right:{t_8,},],out:[LeftJoinIndex:{t_9,},RightJoinIndex:{},],attr:[input_party_codes:[bob carol],join_type:1,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_9,},],out:[Out:{t_10,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_6,},RowsIndexFilter:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
9 [label="publish:{in:[In:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{join_int_1:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{join_int_1:PRIVATE:INT64}"]
5 -> 6 [label = "t_8:{join_int_1:PRIVATE:INT64}"]
6 -> 7 [label = "t_9:{join_int_1:PRIVATE:INT64}"]
7 -> 8 [label = "t_10:{join_int_1:PRIVATE:INT64}"]
8 -> 9 [label = "t_11:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select max(ta.aggregate_float_0 + ta.aggregate_float_0) from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.aggregate_float_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_2,},],out:[LeftJoinIndex:{t_3,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="Add:{in:[Left:{t_4,},Right:{t_4,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
5 [label="reduce_max:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
6 [label="publish:{in:[In:{t_6,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{aggregate_float_0:PRIVATE:FLOAT32}"]
1 -> 2 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_4:{aggregate_float_0:PRIVATE:FLOAT32}"]
3 -> 4 [label = "t_4:{aggregate_float_0:PRIVATE:FLOAT32}"]
4 -> 5 [label = "t_5:{Add_out:PRIVATE:FLOAT64}"]
5 -> 6 [label = "t_6:{Add_out:PRIVATE:FLOAT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select count(*) as c, sum(ta.plain_int_0) as b, max(ta.plain_int_0) as a, min(ta.plain_int_0) as d, avg(ta.plain_int_0) as f from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="shape:{in:[In:{t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,]}"]
5 [label="reduce_sum:{in:[In:{t_3,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
6 [label="reduce_max:{in:[In:{t_3,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
7 [label="reduce_min:{in:[In:{t_3,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
8 [label="reduce_avg:{in:[In:{t_3,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
9 [label="publish:{in:[In:{t_4,t_5,t_6,t_7,t_8,},],out:[Out:{t_9,t_10,t_11,t_12,t_13,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 7 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
5 -> 9 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
7 -> 9 [label = "t_7:{plain_int_0:PRIVATE:INT64}"]
8 -> 9 [label = "t_8:{plain_int_0:PRIVATE:FLOAT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.plain_int_0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0 where ta.plain_int_1 > tb.plain_int_1`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.plain_int_0,ta.plain_int_1 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.plain_int_0,tb.plain_int_1 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="Greater:{in:[Left:{t_7,},Right:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,]}"]
7 [label="apply_filter:{in:[Filter:{t_10,},In:{t_6,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_1:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{plain_int_1:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_7:{plain_int_1:PRIVATE:INT64}"]
3 -> 7 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_8:{plain_int_1:PRIVATE:INT64}"]
5 -> 6 [label = "t_9:{plain_int_1:PRIVATE:INT64}"]
6 -> 7 [label = "t_10:{Greater_out:PRIVATE:BOOL}"]
7 -> 8 [label = "t_11:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.plain_int_0 * tb.plain_int_0 as t1, ta.plain_int_0 + tb.plain_int_0 as t2, ta.plain_int_0 - tb.plain_int_0 as t3, ta.plain_int_0 / tb.plain_int_0 as t1 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0 where ta.plain_int_1 > tb.plain_int_1`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.plain_int_0,ta.plain_int_1 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.plain_int_0,tb.plain_int_1 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_2,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,t_3,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,t_9,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_9,},],out:[Out:{t_10,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="Greater:{in:[Left:{t_7,},Right:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
7 [label="apply_filter:{in:[Filter:{t_11,},In:{t_6,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
8 [label="copy:{in:[In:{t_11,},],out:[Out:{t_13,},],attr:[input_party_codes:alice,output_party_codes:bob,],party:[alice,bob,]}"]
9 [label="apply_filter:{in:[Filter:{t_13,},In:{t_8,},],out:[Out:{t_14,},],attr:[],party:[bob,]}"]
10 [label="copy:{in:[In:{t_14,},],out:[Out:{t_15,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
11 [label="Mul:{in:[Left:{t_12,},Right:{t_15,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
12 [label="Add:{in:[Left:{t_12,},Right:{t_15,},],out:[Out:{t_17,},],attr:[],party:[alice,]}"]
13 [label="Minus:{in:[Left:{t_12,},Right:{t_15,},],out:[Out:{t_18,},],attr:[],party:[alice,]}"]
14 [label="cast:{in:[In:{t_12,},],out:[Out:{t_19,},],attr:[],party:[alice,]}"]
15 [label="Div:{in:[Left:{t_19,},Right:{t_15,},],out:[Out:{t_20,},],attr:[],party:[alice,]}"]
16 [label="publish:{in:[In:{t_16,t_17,t_18,t_20,},],out:[Out:{t_21,t_22,t_23,t_24,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{plain_int_1:PRIVATE:INT64}"]
1 -> 2 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{plain_int_1:PRIVATE:INT64}"]
10 -> 11 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
10 -> 12 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
10 -> 13 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
10 -> 15 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
11 -> 16 [label = "t_16:{Mul_out:PRIVATE:INT64}"]
12 -> 16 [label = "t_17:{Add_out:PRIVATE:INT64}"]
13 -> 16 [label = "t_18:{Minus_out:PRIVATE:INT64}"]
14 -> 15 [label = "t_19:{plain_int_0:PRIVATE:FLOAT64}"]
15 -> 16 [label = "t_20:{Div_out:PRIVATE:FLOAT64}"]
2 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_7:{plain_int_1:PRIVATE:INT64}"]
3 -> 7 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_9:{plain_int_1:PRIVATE:INT64}"]
4 -> 9 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_10:{plain_int_1:PRIVATE:INT64}"]
6 -> 7 [label = "t_11:{Greater_out:PRIVATE:BOOL}"]
6 -> 8 [label = "t_11:{Greater_out:PRIVATE:BOOL}"]
7 -> 11 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
7 -> 12 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
7 -> 13 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
7 -> 14 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
8 -> 9 [label = "t_13:{Greater_out:PRIVATE:BOOL}"]
9 -> 10 [label = "t_14:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.plain_int_0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0 where ta.plain_int_1 > tb.plain_int_1 and ta.compare_int_0 < tb.compare_int_0 and ta.compare_int_1 <> tb.compare_int_1 and ta.compare_int_2 >= tb.compare_int_2 and ta.compare_float_0 <= tb.compare_float_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,t_3,t_4,t_5,},],attr:[sql:select ta.compare_float_0,ta.compare_int_0,ta.compare_int_1,ta.compare_int_2,ta.plain_int_0,ta.plain_int_1 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_6,t_7,t_8,t_9,t_10,t_11,},],attr:[sql:select tb.compare_float_0,tb.compare_int_0,tb.compare_int_1,tb.compare_int_2,tb.plain_int_0,tb.plain_int_1 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_4,},Right:{t_10,},],out:[LeftJoinIndex:{t_12,},RightJoinIndex:{t_13,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,t_2,t_3,t_4,t_5,},RowsIndexFilter:{t_12,},],out:[Out:{t_14,t_15,t_16,t_17,t_18,t_19,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_6,t_7,t_8,t_9,t_11,},RowsIndexFilter:{t_13,},],out:[Out:{t_20,t_21,t_22,t_23,t_24,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_24,},],out:[Out:{t_25,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="Greater:{in:[Left:{t_19,},Right:{t_25,},],out:[Out:{t_26,},],attr:[],party:[alice,]}"]
7 [label="make_share:{in:[In:{t_15,},],out:[Out:{t_27,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_21,},],out:[Out:{t_28,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="Less:{in:[Left:{t_27,},Right:{t_28,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="make_share:{in:[In:{t_16,},],out:[Out:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_share:{in:[In:{t_22,},],out:[Out:{t_31,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="NotEqual:{in:[Left:{t_30,},Right:{t_31,},],out:[Out:{t_32,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_share:{in:[In:{t_17,},],out:[Out:{t_33,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_share:{in:[In:{t_23,},],out:[Out:{t_34,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="GreaterEqual:{in:[Left:{t_33,},Right:{t_34,},],out:[Out:{t_35,},],attr:[],party:[alice,bob,carol,]}"]
16 [label="make_share:{in:[In:{t_14,},],out:[Out:{t_36,},],attr:[],party:[alice,bob,carol,]}"]
17 [label="make_share:{in:[In:{t_20,},],out:[Out:{t_37,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="LessEqual:{in:[Left:{t_36,},Right:{t_37,},],out:[Out:{t_38,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="make_private:{in:[In:{t_29,},],out:[Out:{t_39,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
20 [label="logical_and:{in:[Left:{t_26,},Right:{t_39,},],out:[Out:{t_40,},],attr:[],party:[alice,]}"]
21 [label="make_private:{in:[In:{t_32,},],out:[Out:{t_41,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
22 [label="logical_and:{in:[Left:{t_40,},Right:{t_41,},],out:[Out:{t_42,},],attr:[],party:[alice,]}"]
23 [label="make_private:{in:[In:{t_35,},],out:[Out:{t_43,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
24 [label="logical_and:{in:[Left:{t_42,},Right:{t_43,},],out:[Out:{t_44,},],attr:[],party:[alice,]}"]
25 [label="make_private:{in:[In:{t_38,},],out:[Out:{t_45,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
26 [label="logical_and:{in:[Left:{t_44,},Right:{t_45,},],out:[Out:{t_46,},],attr:[],party:[alice,]}"]
27 [label="apply_filter:{in:[Filter:{t_46,},In:{t_18,},],out:[Out:{t_47,},],attr:[],party:[alice,]}"]
28 [label="publish:{in:[In:{t_47,},],out:[Out:{t_48,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_float_0:PRIVATE:FLOAT32}"]
0 -> 3 [label = "t_1:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{compare_int_1:PRIVATE:INT64}"]
0 -> 3 [label = "t_3:{compare_int_2:PRIVATE:INT64}"]
0 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_5:{plain_int_1:PRIVATE:INT64}"]
1 -> 2 [label = "t_10:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_11:{plain_int_1:PRIVATE:INT64}"]
1 -> 4 [label = "t_6:{compare_float_0:PRIVATE:FLOAT32}"]
1 -> 4 [label = "t_7:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_8:{compare_int_1:PRIVATE:INT64}"]
1 -> 4 [label = "t_9:{compare_int_2:PRIVATE:INT64}"]
10 -> 12 [label = "t_30:{compare_int_1:SECRET:INT64}"]
11 -> 12 [label = "t_31:{compare_int_1:SECRET:INT64}"]
12 -> 21 [label = "t_32:{NotEqual_out:SECRET:BOOL}"]
13 -> 15 [label = "t_33:{compare_int_2:SECRET:INT64}"]
14 -> 15 [label = "t_34:{compare_int_2:SECRET:INT64}"]
15 -> 23 [label = "t_35:{GreaterEqual_out:SECRET:BOOL}"]
16 -> 18 [label = "t_36:{compare_float_0:SECRET:FLOAT32}"]
17 -> 18 [label = "t_37:{compare_float_0:SECRET:FLOAT32}"]
18 -> 25 [label = "t_38:{LessEqual_out:SECRET:BOOL}"]
19 -> 20 [label = "t_39:{Less_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_13:{plain_int_0:PRIVATE:INT64}"]
20 -> 22 [label = "t_40:{logical_and_out:PRIVATE:BOOL}"]
21 -> 22 [label = "t_41:{NotEqual_out:PRIVATE:BOOL}"]
22 -> 24 [label = "t_42:{logical_and_out:PRIVATE:BOOL}"]
23 -> 24 [label = "t_43:{GreaterEqual_out:PRIVATE:BOOL}"]
24 -> 26 [label = "t_44:{logical_and_out:PRIVATE:BOOL}"]
25 -> 26 [label = "t_45:{LessEqual_out:PRIVATE:BOOL}"]
26 -> 27 [label = "t_46:{logical_and_out:PRIVATE:BOOL}"]
27 -> 28 [label = "t_47:{plain_int_0:PRIVATE:INT64}"]
3 -> 10 [label = "t_16:{compare_int_1:PRIVATE:INT64}"]
3 -> 13 [label = "t_17:{compare_int_2:PRIVATE:INT64}"]
3 -> 16 [label = "t_14:{compare_float_0:PRIVATE:FLOAT32}"]
3 -> 27 [label = "t_18:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_19:{plain_int_1:PRIVATE:INT64}"]
3 -> 7 [label = "t_15:{compare_int_0:PRIVATE:INT64}"]
4 -> 11 [label = "t_22:{compare_int_1:PRIVATE:INT64}"]
4 -> 14 [label = "t_23:{compare_int_2:PRIVATE:INT64}"]
4 -> 17 [label = "t_20:{compare_float_0:PRIVATE:FLOAT32}"]
4 -> 5 [label = "t_24:{plain_int_1:PRIVATE:INT64}"]
4 -> 8 [label = "t_21:{compare_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_25:{plain_int_1:PRIVATE:INT64}"]
6 -> 20 [label = "t_26:{Greater_out:PRIVATE:BOOL}"]
7 -> 9 [label = "t_27:{compare_int_0:SECRET:INT64}"]
8 -> 9 [label = "t_28:{compare_int_0:SECRET:INT64}"]
9 -> 19 [label = "t_29:{Less_out:SECRET:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.join_int_0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.join_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="publish:{in:[In:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.join_int_0 + 1 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.join_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="make_constant:{in:[],out:[Out:{t_4,},],attr:[scalar:1,],party:[alice,bob,carol,]}"]
5 [label="broadcast:{in:[In:{t_4,},ShapeRefTensor:{t_3,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
6 [label="Add:{in:[Left:{t_3,},Right:{t_5,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
7 [label="publish:{in:[In:{t_6,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_4:{constant_data:PUBLIC:INT64}"]
5 -> 6 [label = "t_5:{constant_data:PRIVATE:INT64}"]
6 -> 7 [label = "t_6:{Add_out:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.join_int_0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.join_int_0 = tb.join_int_0 where ta.compare_int_0 > tb.compare_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.compare_int_0,ta.join_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.compare_int_0,tb.join_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_1,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,t_7,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_8,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_9,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="Greater:{in:[Left:{t_9,},Right:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_private:{in:[In:{t_11,},],out:[Out:{t_12,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
9 [label="apply_filter:{in:[Filter:{t_12,},In:{t_7,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
10 [label="publish:{in:[In:{t_13,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{compare_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_8:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_9:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_10:{compare_int_0:SECRET:INT64}"]
7 -> 8 [label = "t_11:{Greater_out:SECRET:BOOL}"]
8 -> 9 [label = "t_12:{Greater_out:PRIVATE:BOOL}"]
9 -> 10 [label = "t_13:{join_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.plain_int_0 in (1,2,3) from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="make_constant:{in:[],out:[Out:{t_4,},],attr:[scalar:1,],party:[alice,bob,carol,]}"]
5 [label="broadcast:{in:[In:{t_4,},ShapeRefTensor:{t_3,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
6 [label="Equal:{in:[Left:{t_3,},Right:{t_5,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
7 [label="make_constant:{in:[],out:[Out:{t_7,},],attr:[scalar:2,],party:[alice,bob,carol,]}"]
8 [label="broadcast:{in:[In:{t_7,},ShapeRefTensor:{t_3,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
9 [label="Equal:{in:[Left:{t_3,},Right:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
10 [label="make_constant:{in:[],out:[Out:{t_10,},],attr:[scalar:3,],party:[alice,bob,carol,]}"]
11 [label="broadcast:{in:[In:{t_10,},ShapeRefTensor:{t_3,},],out:[Out:{t_11,},],attr:[],party:[alice,]}"]
12 [label="Equal:{in:[Left:{t_3,},Right:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,]}"]
13 [label="LogicalOr:{in:[Left:{t_9,},Right:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
14 [label="LogicalOr:{in:[Left:{t_6,},Right:{t_13,},],out:[Out:{t_14,},],attr:[],party:[alice,]}"]
15 [label="publish:{in:[In:{t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_10:{constant_data:PUBLIC:INT64}"]
11 -> 12 [label = "t_11:{constant_data:PRIVATE:INT64}"]
12 -> 13 [label = "t_12:{Equal_out:PRIVATE:BOOL}"]
13 -> 14 [label = "t_13:{LogicalOr_out:PRIVATE:BOOL}"]
14 -> 15 [label = "t_14:{LogicalOr_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
3 -> 11 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 12 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 9 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_4:{constant_data:PUBLIC:INT64}"]
5 -> 6 [label = "t_5:{constant_data:PRIVATE:INT64}"]
6 -> 14 [label = "t_6:{Equal_out:PRIVATE:BOOL}"]
7 -> 8 [label = "t_7:{constant_data:PUBLIC:INT64}"]
8 -> 9 [label = "t_8:{constant_data:PRIVATE:INT64}"]
9 -> 13 [label = "t_9:{Equal_out:PRIVATE:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.plain_int_0 in (select tb.plain_int_0 from bob.tbl_0 as tb) from alice.tbl_0 as ta`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="psi_in:{in:[Left:{t_0,},Right:{t_1,},],out:[Out:{t_2,},],attr:[in_type:0,input_party_codes:[alice bob],psi_algorithm:0,reveal_to:[alice],],party:[alice,bob,]}"]
3 [label="publish:{in:[In:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{psi_in_out:PRIVATE:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.compare_int_0 in (select tb.compare_int_0 from bob.tbl_0 as tb) from alice.tbl_0 as ta`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.compare_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.compare_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="psi_in:{in:[Left:{t_0,},Right:{t_1,},],out:[Out:{t_2,},],attr:[in_type:0,input_party_codes:[alice bob],psi_algorithm:0,reveal_to:[alice],],party:[alice,bob,]}"]
3 [label="publish:{in:[In:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{compare_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{psi_in_out:PRIVATE:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.compare_int_0 from alice.tbl_0 as ta where ta.compare_int_0 in (select tb.compare_int_0 from bob.tbl_0 as tb)`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.compare_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.compare_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="psi_in:{in:[Left:{t_0,},Right:{t_1,},],out:[Out:{t_2,},],attr:[in_type:0,input_party_codes:[alice bob],psi_algorithm:0,reveal_to:[alice],],party:[alice,bob,]}"]
3 [label="apply_filter:{in:[Filter:{t_2,},In:{t_0,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="publish:{in:[In:{t_3,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{compare_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{psi_in_out:PRIVATE:BOOL}"]
3 -> 4 [label = "t_3:{compare_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.compare_int_0 from alice.tbl_0 as ta where ta.compare_int_0 not in (select tb.compare_int_0 from bob.tbl_0 as tb)`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.compare_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.compare_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="psi_in:{in:[Left:{t_0,},Right:{t_1,},],out:[Out:{t_2,},],attr:[in_type:0,input_party_codes:[alice bob],psi_algorithm:0,reveal_to:[alice],],party:[alice,bob,]}"]
3 [label="not:{in:[In:{t_2,},],out:[Out:{t_3,},],attr:[],party:[alice,]}"]
4 [label="apply_filter:{in:[Filter:{t_3,},In:{t_0,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
5 [label="publish:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 4 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{compare_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{psi_in_out:PRIVATE:BOOL}"]
3 -> 4 [label = "t_3:{psi_in_out:PRIVATE:BOOL}"]
4 -> 5 [label = "t_4:{compare_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select not(ta.plain_int_0 > tb.plain_int_0) from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_0,},Right:{t_1,},],out:[LeftJoinIndex:{t_2,},RightJoinIndex:{t_3,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_2,},],out:[Out:{t_4,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_1,},RowsIndexFilter:{t_3,},],out:[Out:{t_5,},],attr:[],party:[bob,]}"]
5 [label="copy:{in:[In:{t_5,},],out:[Out:{t_6,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
6 [label="Greater:{in:[Left:{t_4,},Right:{t_6,},],out:[Out:{t_7,},],attr:[],party:[alice,]}"]
7 [label="not:{in:[In:{t_7,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_6:{plain_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{Greater_out:PRIVATE:BOOL}"]
7 -> 8 [label = "t_8:{Greater_out:PRIVATE:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select not(ta.compare_int_0 > tb.compare_int_0) from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.compare_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.compare_int_0,tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_9,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="Greater:{in:[Left:{t_8,},Right:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="not:{in:[In:{t_10,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_private:{in:[In:{t_11,},],out:[Out:{t_12,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
10 [label="publish:{in:[In:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{compare_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_8:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_9:{compare_int_0:SECRET:INT64}"]
7 -> 8 [label = "t_10:{Greater_out:SECRET:BOOL}"]
8 -> 9 [label = "t_11:{Greater_out:SECRET:BOOL}"]
9 -> 10 [label = "t_12:{Greater_out:PRIVATE:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select (ta.compare_int_0 + tb.compare_int_0 - 3) > 0 from alice.tbl_0 as ta join bob.tbl_0 as tb on ta.plain_int_0 = tb.plain_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select ta.compare_int_0,ta.plain_int_0 from alice.tbl_0 as ta;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select tb.compare_int_0,tb.plain_int_0 from bob.tbl_0 as tb;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_9,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="Add:{in:[Left:{t_8,},Right:{t_9,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_constant:{in:[],out:[Out:{t_11,},],attr:[scalar:3,],party:[alice,bob,carol,]}"]
9 [label="broadcast:{in:[In:{t_11,},ShapeRefTensor:{t_10,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="Minus:{in:[Left:{t_10,},Right:{t_12,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_constant:{in:[],out:[Out:{t_14,},],attr:[scalar:0,],party:[alice,bob,carol,]}"]
12 [label="broadcast:{in:[In:{t_14,},ShapeRefTensor:{t_13,},],out:[Out:{t_15,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="Greater:{in:[Left:{t_13,},Right:{t_15,},],out:[Out:{t_16,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_private:{in:[In:{t_16,},],out:[Out:{t_17,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
15 [label="publish:{in:[In:{t_17,},],out:[Out:{t_18,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{plain_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{plain_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{compare_int_0:PRIVATE:INT64}"]
10 -> 12 [label = "t_13:{Minus_out:SECRET:INT64}"]
10 -> 13 [label = "t_13:{Minus_out:SECRET:INT64}"]
11 -> 12 [label = "t_14:{constant_data:PUBLIC:INT64}"]
12 -> 13 [label = "t_15:{constant_data:PUBLIC:INT64}"]
13 -> 14 [label = "t_16:{Greater_out:SECRET:BOOL}"]
14 -> 15 [label = "t_17:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{compare_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_8:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_9:{compare_int_0:SECRET:INT64}"]
7 -> 10 [label = "t_10:{Add_out:SECRET:INT64}"]
7 -> 9 [label = "t_10:{Add_out:SECRET:INT64}"]
8 -> 9 [label = "t_11:{constant_data:PUBLIC:INT64}"]
9 -> 10 [label = "t_12:{constant_data:PUBLIC:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select distinct groupby_int_0 from (select ta.groupby_int_0 from alice.tbl_0 as ta union all select tb.groupby_int_0 from bob.tbl_0 as tb) as tt`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(ta.groupby_int_0) as expr_242 from alice.tbl_0 as ta group by ta.groupby_int_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select any_value(tb.groupby_int_0) as expr_242 from bob.tbl_0 as tb group by tb.groupby_int_0;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_private:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
6 [label="group:{in:[Key:{t_5,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
7 [label="firstrow:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_5,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#242:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#242:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{Column#242:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#242:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#242:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#242:PRIVATE:INT64}"]
5 -> 7 [label = "t_5:{Column#242:PRIVATE:INT64}"]
6 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{group_num:PRIVATE:INT64}"]
7 -> 8 [label = "t_8:{Column#242_firstrow:PRIVATE:INT64}"]
}`, `
pipeline 0 {
Batched: false
node: [runsql_0 runsql_1]
Inputs: []
Outputs: [t_0 t_1]
}
pipeline 1 {
Batched: false
node: [make_share_2 make_share_3]
Inputs: [t_0 t_1]
Outputs: [t_2 t_3]
}
pipeline 2 {
Batched: false
node: [concat_4]
Inputs: [t_2 t_3]
Outputs: [t_4]
}
pipeline 3 {
Batched: false
node: [make_private_5]
Inputs: [t_4]
Outputs: [t_5]
}
pipeline 4 {
Batched: false
node: [group_6 firstrow_7 publish_8]
Inputs: [t_5]
Outputs: []
}
`, testConf{groupThreshold: 0, batched: true, revealGroupCount: false}},
	{`select ta.groupby_int_0 from alice.tbl_0 as ta union select tb.groupby_int_0 from bob.tbl_0 as tb`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(ta.groupby_int_0) as expr_242 from alice.tbl_0 as ta group by ta.groupby_int_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,},],attr:[sql:select any_value(tb.groupby_int_0) as expr_242 from bob.tbl_0 as tb group by tb.groupby_int_0;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_2,},],attr:[],party:[alice,bob,carol,]}"]
3 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_3,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="concat:{in:[In:{t_2,t_3,},],out:[Out:{t_4,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
5 [label="make_private:{in:[In:{t_4,},],out:[Out:{t_5,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
6 [label="group:{in:[Key:{t_5,},],out:[GroupId:{t_6,},GroupNum:{t_7,},],attr:[],party:[alice,]}"]
7 [label="firstrow:{in:[GroupId:{t_6,},GroupNum:{t_7,},In:{t_5,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
8 [label="publish:{in:[In:{t_8,},],out:[Out:{t_9,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{Column#242:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{Column#242:PRIVATE:INT64}"]
2 -> 4 [label = "t_2:{Column#242:SECRET:INT64}"]
3 -> 4 [label = "t_3:{Column#242:SECRET:INT64}"]
4 -> 5 [label = "t_4:{Column#242:SECRET:INT64}"]
5 -> 6 [label = "t_5:{Column#242:PRIVATE:INT64}"]
5 -> 7 [label = "t_5:{Column#242:PRIVATE:INT64}"]
6 -> 7 [label = "t_6:{group_id:PRIVATE:INT64}"]
6 -> 7 [label = "t_7:{group_num:PRIVATE:INT64}"]
7 -> 8 [label = "t_8:{Column#242_firstrow:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select plain_float_0 from (select plain_float_0 from alice.tbl_1 union all select plain_float_0 from alice.tbl_2) as tt group by plain_float_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select any_value(tt.expr_243) as plain_float_0 from ((select any_value(tbl_1.plain_float_0) as expr_243,count(1) as expr_244 from alice.tbl_1 group by tbl_1.plain_float_0) union all (select any_value(tbl_2.plain_float_0) as expr_243,count(1) as expr_244 from alice.tbl_2 group by tbl_2.plain_float_0)) as tt group by tt.expr_243 having count(tt.expr_244)>=4;,table_refs:[alice.tbl_1 alice.tbl_2],],party:[alice,]}"]
1 [label="publish:{in:[In:{t_0,},],out:[Out:{t_1,},],attr:[],party:[alice,]}"]
0 -> 1 [label = "t_0:{Column#241:PRIVATE:FLOAT32}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select count(*), max(aggregate_int_0) from (select aggregate_int_0, groupby_int_0 from alice.tbl_0 union all select aggregate_int_0, groupby_int_0 from bob.tbl_1 union all select aggregate_int_0, groupby_int_0 from carol.tbl_2) as u`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select count(1) as expr_365,max(tbl_0.aggregate_int_0) as expr_366 from alice.tbl_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select count(1) as expr_365,max(tbl_1.aggregate_int_0) as expr_366 from bob.tbl_1;,table_refs:[bob.tbl_1],],party:[bob,]}"]
2 [label="runsql:{in:[],out:[Out:{t_4,t_5,},],attr:[sql:select count(1) as expr_365,max(tbl_2.aggregate_int_0) as expr_366 from carol.tbl_2;,table_refs:[carol.tbl_2],],party:[carol,]}"]
3 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_6,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="make_share:{in:[In:{t_2,},],out:[Out:{t_7,},],attr:[],party:[alice,bob,carol,]}"]
5 [label="make_share:{in:[In:{t_4,},],out:[Out:{t_8,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="concat:{in:[In:{t_6,t_7,t_8,},],out:[Out:{t_9,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_3,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_share:{in:[In:{t_5,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="concat:{in:[In:{t_10,t_11,t_12,},],out:[Out:{t_13,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
11 [label="reduce_sum:{in:[In:{t_9,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="reduce_max:{in:[In:{t_13,},],out:[Out:{t_15,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_private:{in:[In:{t_14,},],out:[Out:{t_16,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
14 [label="make_private:{in:[In:{t_15,},],out:[Out:{t_18,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
15 [label="publish:{in:[In:{t_16,t_18,},],out:[Out:{t_17,t_19,},],attr:[],party:[alice,]}"]
0 -> 3 [label = "t_0:{Column#365:PRIVATE:INT64}"]
0 -> 7 [label = "t_1:{Column#366:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{Column#365:PRIVATE:INT64}"]
1 -> 8 [label = "t_3:{Column#366:PRIVATE:INT64}"]
10 -> 12 [label = "t_13:{Column#366:SECRET:INT64}"]
11 -> 13 [label = "t_14:{Column#365:SECRET:INT64}"]
12 -> 14 [label = "t_15:{Column#366:SECRET:INT64}"]
13 -> 15 [label = "t_16:{Column#365:PRIVATE:INT64}"]
14 -> 15 [label = "t_18:{Column#366:PRIVATE:INT64}"]
2 -> 5 [label = "t_4:{Column#365:PRIVATE:INT64}"]
2 -> 9 [label = "t_5:{Column#366:PRIVATE:INT64}"]
3 -> 6 [label = "t_6:{Column#365:SECRET:INT64}"]
4 -> 6 [label = "t_7:{Column#365:SECRET:INT64}"]
5 -> 6 [label = "t_8:{Column#365:SECRET:INT64}"]
6 -> 11 [label = "t_9:{Column#365:SECRET:INT64}"]
7 -> 10 [label = "t_10:{Column#366:SECRET:INT64}"]
8 -> 10 [label = "t_11:{Column#366:SECRET:INT64}"]
9 -> 10 [label = "t_12:{Column#366:SECRET:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select count(*), max(aggregate_int_0) from (select aggregate_int_0, groupby_int_0 from alice.tbl_0 union all select aggregate_int_0, groupby_int_0 from bob.tbl_1 union all select aggregate_int_0, groupby_int_0 from carol.tbl_2) as u group by groupby_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select count(1) as expr_365,max(tbl_0.aggregate_int_0) as expr_366,any_value(tbl_0.groupby_int_0) as expr_362 from alice.tbl_0 group by tbl_0.groupby_int_0;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,t_4,t_5,},],attr:[sql:select count(1) as expr_365,max(tbl_1.aggregate_int_0) as expr_366,any_value(tbl_1.groupby_int_0) as expr_362 from bob.tbl_1 group by tbl_1.groupby_int_0;,table_refs:[bob.tbl_1],],party:[bob,]}"]
2 [label="runsql:{in:[],out:[Out:{t_6,t_7,t_8,},],attr:[sql:select count(1) as expr_365,max(tbl_2.aggregate_int_0) as expr_366,any_value(tbl_2.groupby_int_0) as expr_362 from carol.tbl_2 group by tbl_2.groupby_int_0;,table_refs:[carol.tbl_2],],party:[carol,]}"]
3 [label="make_share:{in:[In:{t_0,},],out:[Out:{t_9,},],attr:[],party:[alice,bob,carol,]}"]
4 [label="make_share:{in:[In:{t_3,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="concat:{in:[In:{t_9,t_10,t_11,},],out:[Out:{t_12,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
7 [label="make_share:{in:[In:{t_1,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="make_share:{in:[In:{t_4,},],out:[Out:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_15,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="concat:{in:[In:{t_13,t_14,t_15,},],out:[Out:{t_16,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
11 [label="make_share:{in:[In:{t_2,},],out:[Out:{t_17,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_5,},],out:[Out:{t_18,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_share:{in:[In:{t_8,},],out:[Out:{t_19,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="concat:{in:[In:{t_17,t_18,t_19,},],out:[Out:{t_20,},],attr:[axis:0,],party:[alice,bob,carol,]}"]
15 [label="make_private:{in:[In:{t_20,},],out:[Out:{t_21,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
16 [label="group:{in:[Key:{t_21,},],out:[GroupId:{t_22,},GroupNum:{t_23,},],attr:[],party:[alice,]}"]
17 [label="make_private:{in:[In:{t_12,},],out:[Out:{t_24,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
18 [label="sum:{in:[GroupId:{t_22,},GroupNum:{t_23,},In:{t_24,},],out:[Out:{t_25,},],attr:[],party:[alice,]}"]
19 [label="make_private:{in:[In:{t_16,},],out:[Out:{t_26,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
20 [label="max:{in:[GroupId:{t_22,},GroupNum:{t_23,},In:{t_26,},],out:[Out:{t_27,},],attr:[],party:[alice,]}"]
21 [label="make_constant:{in:[],out:[Out:{t_28,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
22 [label="broadcast:{in:[In:{t_28,},ShapeRefTensor:{t_25,},],out:[Out:{t_29,},],attr:[],party:[alice,]}"]
23 [label="GreaterEqual:{in:[Left:{t_25,},Right:{t_29,},],out:[Out:{t_30,},],attr:[],party:[alice,]}"]
24 [label="apply_filter:{in:[Filter:{t_30,},In:{t_25,t_27,},],out:[Out:{t_31,t_32,},],attr:[],party:[alice,]}"]
25 [label="publish:{in:[In:{t_31,t_32,},],out:[Out:{t_33,t_34,},],attr:[],party:[alice,]}"]
0 -> 11 [label = "t_2:{Column#362:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{Column#365:PRIVATE:INT64}"]
0 -> 7 [label = "t_1:{Column#366:PRIVATE:INT64}"]
1 -> 12 [label = "t_5:{Column#362:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{Column#365:PRIVATE:INT64}"]
1 -> 8 [label = "t_4:{Column#366:PRIVATE:INT64}"]
10 -> 19 [label = "t_16:{Column#366:SECRET:INT64}"]
11 -> 14 [label = "t_17:{Column#362:SECRET:INT64}"]
12 -> 14 [label = "t_18:{Column#362:SECRET:INT64}"]
13 -> 14 [label = "t_19:{Column#362:SECRET:INT64}"]
14 -> 15 [label = "t_20:{Column#362:SECRET:INT64}"]
15 -> 16 [label = "t_21:{Column#362:PRIVATE:INT64}"]
16 -> 18 [label = "t_22:{group_id:PRIVATE:INT64}"]
16 -> 18 [label = "t_23:{group_num:PRIVATE:INT64}"]
16 -> 20 [label = "t_22:{group_id:PRIVATE:INT64}"]
16 -> 20 [label = "t_23:{group_num:PRIVATE:INT64}"]
17 -> 18 [label = "t_24:{Column#365:PRIVATE:INT64}"]
18 -> 22 [label = "t_25:{Column#365_sum:PRIVATE:INT64}"]
18 -> 23 [label = "t_25:{Column#365_sum:PRIVATE:INT64}"]
18 -> 24 [label = "t_25:{Column#365_sum:PRIVATE:INT64}"]
19 -> 20 [label = "t_26:{Column#366:PRIVATE:INT64}"]
2 -> 13 [label = "t_8:{Column#362:PRIVATE:INT64}"]
2 -> 5 [label = "t_6:{Column#365:PRIVATE:INT64}"]
2 -> 9 [label = "t_7:{Column#366:PRIVATE:INT64}"]
20 -> 24 [label = "t_27:{Column#366_max:PRIVATE:INT64}"]
21 -> 22 [label = "t_28:{constant_data:PUBLIC:INT64}"]
22 -> 23 [label = "t_29:{constant_data:PRIVATE:INT64}"]
23 -> 24 [label = "t_30:{GreaterEqual_out:PRIVATE:BOOL}"]
24 -> 25 [label = "t_31:{Column#365_sum:PRIVATE:INT64}"]
24 -> 25 [label = "t_32:{Column#366_max:PRIVATE:INT64}"]
3 -> 6 [label = "t_9:{Column#365:SECRET:INT64}"]
4 -> 6 [label = "t_10:{Column#365:SECRET:INT64}"]
5 -> 6 [label = "t_11:{Column#365:SECRET:INT64}"]
6 -> 17 [label = "t_12:{Column#365:SECRET:INT64}"]
7 -> 10 [label = "t_13:{Column#366:SECRET:INT64}"]
8 -> 10 [label = "t_14:{Column#366:SECRET:INT64}"]
9 -> 10 [label = "t_15:{Column#366:SECRET:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select alice.plain_int_0 from alice.tbl_0 as alice join bob.tbl_0 as bob on alice.join_int_0 = bob.join_int_0 where alice.compare_int_0 Div bob.compare_int_0 > bob.compare_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select alice.compare_int_0,alice.join_int_0,alice.plain_int_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,t_4,},],attr:[sql:select bob.compare_int_0,bob.join_int_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_4,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{t_6,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,t_8,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_6,},],out:[Out:{t_9,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_10,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_9,},],out:[Out:{t_11,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="IntDiv:{in:[Left:{t_10,},Right:{t_11,},],out:[Out:{t_12,},],attr:[],party:[alice,bob,carol,]}"]
8 [label="Greater:{in:[Left:{t_12,},Right:{t_11,},],out:[Out:{t_13,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="make_private:{in:[In:{t_13,},],out:[Out:{t_14,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
10 [label="apply_filter:{in:[Filter:{t_14,},In:{t_8,},],out:[Out:{t_15,},],attr:[],party:[alice,]}"]
11 [label="publish:{in:[In:{t_15,},],out:[Out:{t_16,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{compare_int_0:PRIVATE:INT64}"]
10 -> 11 [label = "t_15:{plain_int_0:PRIVATE:INT64}"]
2 -> 3 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
3 -> 10 [label = "t_8:{plain_int_0:PRIVATE:INT64}"]
3 -> 5 [label = "t_7:{compare_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_9:{compare_int_0:PRIVATE:INT64}"]
5 -> 7 [label = "t_10:{compare_int_0:SECRET:INT64}"]
6 -> 7 [label = "t_11:{compare_int_0:SECRET:INT64}"]
6 -> 8 [label = "t_11:{compare_int_0:SECRET:INT64}"]
7 -> 8 [label = "t_12:{IntDiv_out:SECRET:INT64}"]
8 -> 9 [label = "t_13:{Greater_out:SECRET:BOOL}"]
9 -> 10 [label = "t_14:{Greater_out:PRIVATE:BOOL}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select alice.groupby_string_0,bob.groupby_string_0, count(*) as cnt from alice.tbl_0 as alice join bob.tbl_0 as bob where alice.join_int_0=bob.join_int_0 group by alice.groupby_string_0, bob.groupby_string_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,},],attr:[sql:select alice.groupby_string_0,alice.join_int_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_2,t_3,},],attr:[sql:select bob.groupby_string_0,bob.join_int_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_4,},RightJoinIndex:{t_5,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,},RowsIndexFilter:{t_4,},],out:[Out:{t_6,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,},],attr:[],party:[bob,]}"]
5 [label="make_share:{in:[In:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,bob,carol,]}"]
6 [label="make_share:{in:[In:{t_7,},],out:[Out:{t_9,},],attr:[],party:[alice,bob,carol,]}"]
7 [label="sort:{in:[In:{t_8,t_9,t_8,t_9,},Key:{t_8,t_9,},],out:[Out:{t_10,t_11,t_12,t_13,},],attr:[reverse:false,],party:[alice,bob,carol,]}"]
8 [label="group_mark:{in:[Key:{t_10,t_11,},],out:[Group:{t_14,},],attr:[],party:[alice,bob,carol,]}"]
9 [label="count:{in:[Group:{t_14,},In:{t_14,},],out:[Out:{t_15,},],attr:[],party:[alice,bob,carol,]}"]
10 [label="shuffle:{in:[In:{t_15,t_12,t_13,t_14,},],out:[Out:{t_16,t_17,t_18,t_19,},],attr:[],party:[alice,bob,carol,]}"]
11 [label="make_public:{in:[In:{t_19,},],out:[Out:{t_20,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="filter:{in:[Filter:{t_20,},In:{t_16,t_17,t_18,},],out:[Out:{t_21,t_22,t_23,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="make_constant:{in:[],out:[Out:{t_24,},],attr:[scalar:4,],party:[alice,bob,carol,]}"]
14 [label="broadcast:{in:[In:{t_24,},ShapeRefTensor:{t_21,},],out:[Out:{t_25,},],attr:[],party:[alice,bob,carol,]}"]
15 [label="make_private:{in:[In:{t_21,},],out:[Out:{t_26,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
16 [label="make_private:{in:[In:{t_25,},],out:[Out:{t_27,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
17 [label="GreaterEqual:{in:[Left:{t_26,},Right:{t_27,},],out:[Out:{t_28,},],attr:[],party:[alice,]}"]
18 [label="make_public:{in:[In:{t_28,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="apply_filter:{in:[Filter:{t_29,},In:{t_22,t_23,t_21,},],out:[Out:{t_30,t_31,t_32,},],attr:[],party:[alice,bob,carol,]}"]
20 [label="make_private:{in:[In:{t_30,},],out:[Out:{t_33,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
21 [label="make_private:{in:[In:{t_31,},],out:[Out:{t_35,},],attr:[reveal_to:bob,],party:[alice,bob,carol,]}"]
22 [label="copy:{in:[In:{t_35,},],out:[Out:{t_36,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
23 [label="make_private:{in:[In:{t_32,},],out:[Out:{t_38,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
24 [label="publish:{in:[In:{t_33,t_36,t_38,},],out:[Out:{t_34,t_37,t_39,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{groupby_string_0:PRIVATE:STRING}"]
1 -> 2 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_2:{groupby_string_0:PRIVATE:STRING}"]
10 -> 11 [label = "t_19:{group_mark:SECRET:BOOL}"]
10 -> 12 [label = "t_16:{group_mark:SECRET:INT64}"]
10 -> 12 [label = "t_17:{groupby_string_0:SECRET:STRING}"]
10 -> 12 [label = "t_18:{groupby_string_0:SECRET:STRING}"]
11 -> 12 [label = "t_20:{group_mark:PUBLIC:BOOL}"]
12 -> 14 [label = "t_21:{group_mark:SECRET:INT64}"]
12 -> 15 [label = "t_21:{group_mark:SECRET:INT64}"]
12 -> 19 [label = "t_21:{group_mark:SECRET:INT64}"]
12 -> 19 [label = "t_22:{groupby_string_0:SECRET:STRING}"]
12 -> 19 [label = "t_23:{groupby_string_0:SECRET:STRING}"]
13 -> 14 [label = "t_24:{constant_data:PUBLIC:INT64}"]
14 -> 16 [label = "t_25:{constant_data:PUBLIC:INT64}"]
15 -> 17 [label = "t_26:{group_mark:PRIVATE:INT64}"]
16 -> 17 [label = "t_27:{constant_data:PRIVATE:INT64}"]
17 -> 18 [label = "t_28:{GreaterEqual_out:PRIVATE:BOOL}"]
18 -> 19 [label = "t_29:{GreaterEqual_out:PUBLIC:BOOL}"]
19 -> 20 [label = "t_30:{groupby_string_0:SECRET:STRING}"]
19 -> 21 [label = "t_31:{groupby_string_0:SECRET:STRING}"]
19 -> 23 [label = "t_32:{group_mark:SECRET:INT64}"]
2 -> 3 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
20 -> 24 [label = "t_33:{groupby_string_0:PRIVATE:STRING}"]
21 -> 22 [label = "t_35:{groupby_string_0:PRIVATE:STRING}"]
22 -> 24 [label = "t_36:{groupby_string_0:PRIVATE:STRING}"]
23 -> 24 [label = "t_38:{group_mark:PRIVATE:INT64}"]
3 -> 5 [label = "t_6:{groupby_string_0:PRIVATE:STRING}"]
4 -> 6 [label = "t_7:{groupby_string_0:PRIVATE:STRING}"]
5 -> 7 [label = "t_8:{groupby_string_0:SECRET:STRING}"]
5 -> 7 [label = "t_8:{groupby_string_0:SECRET:STRING}"]
5 -> 7 [label = "t_8:{groupby_string_0:SECRET:STRING}"]
6 -> 7 [label = "t_9:{groupby_string_0:SECRET:STRING}"]
6 -> 7 [label = "t_9:{groupby_string_0:SECRET:STRING}"]
6 -> 7 [label = "t_9:{groupby_string_0:SECRET:STRING}"]
7 -> 10 [label = "t_12:{groupby_string_0:SECRET:STRING}"]
7 -> 10 [label = "t_13:{groupby_string_0:SECRET:STRING}"]
7 -> 8 [label = "t_10:{groupby_string_0:SECRET:STRING}"]
7 -> 8 [label = "t_11:{groupby_string_0:SECRET:STRING}"]
8 -> 10 [label = "t_14:{group_mark:SECRET:BOOL}"]
8 -> 9 [label = "t_14:{group_mark:SECRET:BOOL}"]
8 -> 9 [label = "t_14:{group_mark:SECRET:BOOL}"]
9 -> 10 [label = "t_15:{group_mark:SECRET:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select case when alice.compare_int_0 > bob.compare_int_0 then alice.plain_int_0 else bob.plain_int_0 end as case_when1, case when bob.compare_int_0 > carol.compare_int_0 then 1 else 0 end as case_when2 from alice.tbl_0 as alice, bob.tbl_0 as bob, carol.tbl_0 as carol where alice.join_int_0 = bob.join_int_0 and bob.join_int_0 = carol.join_int_0;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select alice.compare_int_0,alice.join_int_0,alice.plain_int_0 from alice.tbl_0 as alice;,table_refs:[alice.tbl_0],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,t_4,t_5,},],attr:[sql:select bob.compare_int_0,bob.join_int_0,bob.plain_int_0 from bob.tbl_0 as bob;,table_refs:[bob.tbl_0],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_4,},],out:[LeftJoinIndex:{t_6,},RightJoinIndex:{t_7,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_2,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,t_9,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,t_4,t_5,},RowsIndexFilter:{t_7,},],out:[Out:{t_10,t_11,t_12,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_13,t_14,},],attr:[sql:select carol.compare_int_0,carol.join_int_0 from carol.tbl_0 as carol;,table_refs:[carol.tbl_0],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_11,},Right:{t_14,},],out:[LeftJoinIndex:{t_15,},RightJoinIndex:{t_16,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_15,},],out:[Out:{t_17,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_8,t_9,},RowsIndexFilter:{t_17,},],out:[Out:{t_18,t_19,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_10,t_12,},RowsIndexFilter:{t_15,},],out:[Out:{t_20,t_21,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_13,},RowsIndexFilter:{t_16,},],out:[Out:{t_22,},],attr:[],party:[carol,]}"]
11 [label="make_share:{in:[In:{t_18,},],out:[Out:{t_23,},],attr:[],party:[alice,bob,carol,]}"]
12 [label="make_share:{in:[In:{t_20,},],out:[Out:{t_24,},],attr:[],party:[alice,bob,carol,]}"]
13 [label="Greater:{in:[Left:{t_23,},Right:{t_24,},],out:[Out:{t_25,},],attr:[],party:[alice,bob,carol,]}"]
14 [label="make_private:{in:[In:{t_25,},],out:[Out:{t_27,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
15 [label="copy:{in:[In:{t_21,},],out:[Out:{t_28,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
16 [label="CaseWhen:{in:[Condition:{t_27,},Value:{t_19,},ValueElse:{t_28,},],out:[Out:{t_26,},],attr:[],party:[alice,]}"]
17 [label="make_share:{in:[In:{t_22,},],out:[Out:{t_29,},],attr:[],party:[alice,bob,carol,]}"]
18 [label="Greater:{in:[Left:{t_24,},Right:{t_29,},],out:[Out:{t_30,},],attr:[],party:[alice,bob,carol,]}"]
19 [label="make_constant:{in:[],out:[Out:{t_31,},],attr:[scalar:1,],party:[alice,bob,carol,]}"]
20 [label="make_constant:{in:[],out:[Out:{t_32,},],attr:[scalar:0,],party:[alice,bob,carol,]}"]
21 [label="broadcast:{in:[In:{t_31,t_32,},ShapeRefTensor:{t_30,},],out:[Out:{t_33,t_34,},],attr:[],party:[alice,bob,carol,]}"]
22 [label="make_private:{in:[In:{t_30,},],out:[Out:{t_36,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
23 [label="make_private:{in:[In:{t_33,},],out:[Out:{t_37,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
24 [label="make_private:{in:[In:{t_34,},],out:[Out:{t_38,},],attr:[reveal_to:alice,],party:[alice,bob,carol,]}"]
25 [label="CaseWhen:{in:[Condition:{t_36,},Value:{t_37,},ValueElse:{t_38,},],out:[Out:{t_35,},],attr:[],party:[alice,]}"]
26 [label="publish:{in:[In:{t_26,t_35,},],out:[Out:{t_39,t_40,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_0:{compare_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
1 -> 2 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_3:{compare_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_4:{join_int_0:PRIVATE:INT64}"]
1 -> 4 [label = "t_5:{plain_int_0:PRIVATE:INT64}"]
10 -> 17 [label = "t_22:{compare_int_0:PRIVATE:INT64}"]
11 -> 13 [label = "t_23:{compare_int_0:SECRET:INT64}"]
12 -> 13 [label = "t_24:{compare_int_0:SECRET:INT64}"]
12 -> 18 [label = "t_24:{compare_int_0:SECRET:INT64}"]
13 -> 14 [label = "t_25:{Greater_out:SECRET:BOOL}"]
14 -> 16 [label = "t_27:{Greater_out:PRIVATE:BOOL}"]
15 -> 16 [label = "t_28:{plain_int_0:PRIVATE:INT64}"]
16 -> 26 [label = "t_26:{plain_int_0:PRIVATE:INT64}"]
17 -> 18 [label = "t_29:{compare_int_0:SECRET:INT64}"]
18 -> 21 [label = "t_30:{Greater_out:SECRET:BOOL}"]
18 -> 22 [label = "t_30:{Greater_out:SECRET:BOOL}"]
19 -> 21 [label = "t_31:{constant_data:PUBLIC:INT64}"]
2 -> 3 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
20 -> 21 [label = "t_32:{constant_data:PUBLIC:INT64}"]
21 -> 23 [label = "t_33:{constant_data:PUBLIC:INT64}"]
21 -> 24 [label = "t_34:{constant_data:PUBLIC:INT64}"]
22 -> 25 [label = "t_36:{Greater_out:PRIVATE:BOOL}"]
23 -> 25 [label = "t_37:{constant_data:PRIVATE:INT64}"]
24 -> 25 [label = "t_38:{constant_data:PRIVATE:INT64}"]
25 -> 26 [label = "t_35:{constant_data:PRIVATE:INT64}"]
3 -> 8 [label = "t_8:{compare_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_9:{plain_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_11:{join_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_10:{compare_int_0:PRIVATE:INT64}"]
4 -> 9 [label = "t_12:{plain_int_0:PRIVATE:INT64}"]
5 -> 10 [label = "t_13:{compare_int_0:PRIVATE:INT64}"]
5 -> 6 [label = "t_14:{join_int_0:PRIVATE:INT64}"]
6 -> 10 [label = "t_16:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_15:{join_int_0:PRIVATE:INT64}"]
6 -> 9 [label = "t_15:{join_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_17:{join_int_0:PRIVATE:INT64}"]
8 -> 11 [label = "t_18:{compare_int_0:PRIVATE:INT64}"]
8 -> 16 [label = "t_19:{plain_int_0:PRIVATE:INT64}"]
9 -> 12 [label = "t_20:{compare_int_0:PRIVATE:INT64}"]
9 -> 15 [label = "t_21:{plain_int_0:PRIVATE:INT64}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select alice.groupby_int_0, alice.GROUPBY_int_1, bob.join_string_0, bob.JOIN_STRING_0, carol.COMPARE_float_0 > 0, carol.compare_float_1 > 0 from alice.UPPER_table as alice, bob.UPPER_table as bob, carol.UPPER_table as carol where alice.join_string_0 = bob.JOIN_string_0 and bob.join_string_1 = carol.JOIN_string_1;`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,t_1,t_2,},],attr:[sql:select alice.GROUPBY_int_0,alice.JOIN_string_0,alice.groupby_int_1 from alice.UPPER_table as alice;,table_refs:[alice.UPPER_table],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_3,t_4,},],attr:[sql:select bob.JOIN_string_0,bob.join_string_1 from bob.UPPER_table as bob;,table_refs:[bob.UPPER_table],],party:[bob,]}"]
2 [label="join:{in:[Left:{t_1,},Right:{t_3,},],out:[LeftJoinIndex:{t_5,},RightJoinIndex:{t_6,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
3 [label="filter_by_index:{in:[Data:{t_0,t_2,},RowsIndexFilter:{t_5,},],out:[Out:{t_7,t_8,},],attr:[],party:[alice,]}"]
4 [label="filter_by_index:{in:[Data:{t_3,t_4,},RowsIndexFilter:{t_6,},],out:[Out:{t_9,t_10,},],attr:[],party:[bob,]}"]
5 [label="runsql:{in:[],out:[Out:{t_11,t_12,t_13,},],attr:[sql:select carol.COMPARE_float_0,carol.compare_float_1,carol.join_string_1 from carol.UPPER_table as carol;,table_refs:[carol.UPPER_table],],party:[carol,]}"]
6 [label="join:{in:[Left:{t_10,},Right:{t_13,},],out:[LeftJoinIndex:{t_14,},RightJoinIndex:{t_15,},],attr:[input_party_codes:[bob carol],join_type:0,psi_algorithm:0,],party:[bob,carol,]}"]
7 [label="copy:{in:[In:{t_14,},],out:[Out:{t_16,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="filter_by_index:{in:[Data:{t_7,t_8,},RowsIndexFilter:{t_16,},],out:[Out:{t_17,t_18,},],attr:[],party:[alice,]}"]
9 [label="filter_by_index:{in:[Data:{t_9,},RowsIndexFilter:{t_14,},],out:[Out:{t_19,},],attr:[],party:[bob,]}"]
10 [label="filter_by_index:{in:[Data:{t_11,t_12,},RowsIndexFilter:{t_15,},],out:[Out:{t_20,t_21,},],attr:[],party:[carol,]}"]
11 [label="make_constant:{in:[],out:[Out:{t_22,},],attr:[scalar:0,],party:[alice,bob,carol,]}"]
12 [label="broadcast:{in:[In:{t_22,},ShapeRefTensor:{t_20,},],out:[Out:{t_23,},],attr:[],party:[carol,]}"]
13 [label="Greater:{in:[Left:{t_20,},Right:{t_23,},],out:[Out:{t_24,},],attr:[],party:[carol,]}"]
14 [label="make_constant:{in:[],out:[Out:{t_25,},],attr:[scalar:0,],party:[alice,bob,carol,]}"]
15 [label="broadcast:{in:[In:{t_25,},ShapeRefTensor:{t_21,},],out:[Out:{t_26,},],attr:[],party:[carol,]}"]
16 [label="Greater:{in:[Left:{t_21,},Right:{t_26,},],out:[Out:{t_27,},],attr:[],party:[carol,]}"]
17 [label="copy:{in:[In:{t_19,},],out:[Out:{t_30,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
18 [label="copy:{in:[In:{t_24,},],out:[Out:{t_33,},],attr:[input_party_codes:carol,output_party_codes:alice,],party:[carol,alice,]}"]
19 [label="copy:{in:[In:{t_27,},],out:[Out:{t_35,},],attr:[input_party_codes:carol,output_party_codes:alice,],party:[carol,alice,]}"]
20 [label="publish:{in:[In:{t_17,t_18,t_30,t_30,t_33,t_35,},],out:[Out:{t_28,t_29,t_31,t_32,t_34,t_36,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_1:{JOIN_string_0:PRIVATE:STRING}"]
0 -> 3 [label = "t_0:{GROUPBY_int_0:PRIVATE:INT64}"]
0 -> 3 [label = "t_2:{groupby_int_1:PRIVATE:INT64}"]
1 -> 2 [label = "t_3:{JOIN_string_0:PRIVATE:STRING}"]
1 -> 4 [label = "t_3:{JOIN_string_0:PRIVATE:STRING}"]
1 -> 4 [label = "t_4:{join_string_1:PRIVATE:STRING}"]
10 -> 12 [label = "t_20:{COMPARE_float_0:PRIVATE:FLOAT32}"]
10 -> 13 [label = "t_20:{COMPARE_float_0:PRIVATE:FLOAT32}"]
10 -> 15 [label = "t_21:{compare_float_1:PRIVATE:FLOAT32}"]
10 -> 16 [label = "t_21:{compare_float_1:PRIVATE:FLOAT32}"]
11 -> 12 [label = "t_22:{constant_data:PUBLIC:INT64}"]
12 -> 13 [label = "t_23:{constant_data:PRIVATE:INT64}"]
13 -> 18 [label = "t_24:{Greater_out:PRIVATE:BOOL}"]
14 -> 15 [label = "t_25:{constant_data:PUBLIC:INT64}"]
15 -> 16 [label = "t_26:{constant_data:PRIVATE:INT64}"]
16 -> 19 [label = "t_27:{Greater_out:PRIVATE:BOOL}"]
17 -> 20 [label = "t_30:{JOIN_string_0:PRIVATE:STRING}"]
17 -> 20 [label = "t_30:{JOIN_string_0:PRIVATE:STRING}"]
18 -> 20 [label = "t_33:{Greater_out:PRIVATE:BOOL}"]
19 -> 20 [label = "t_35:{Greater_out:PRIVATE:BOOL}"]
2 -> 3 [label = "t_5:{JOIN_string_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_6:{JOIN_string_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_7:{GROUPBY_int_0:PRIVATE:INT64}"]
3 -> 8 [label = "t_8:{groupby_int_1:PRIVATE:INT64}"]
4 -> 6 [label = "t_10:{join_string_1:PRIVATE:STRING}"]
4 -> 9 [label = "t_9:{JOIN_string_0:PRIVATE:STRING}"]
5 -> 10 [label = "t_11:{COMPARE_float_0:PRIVATE:FLOAT32}"]
5 -> 10 [label = "t_12:{compare_float_1:PRIVATE:FLOAT32}"]
5 -> 6 [label = "t_13:{join_string_1:PRIVATE:STRING}"]
6 -> 10 [label = "t_15:{join_string_1:PRIVATE:INT64}"]
6 -> 7 [label = "t_14:{join_string_1:PRIVATE:INT64}"]
6 -> 9 [label = "t_14:{join_string_1:PRIVATE:INT64}"]
7 -> 8 [label = "t_16:{join_string_1:PRIVATE:INT64}"]
8 -> 20 [label = "t_17:{GROUPBY_int_0:PRIVATE:INT64}"]
8 -> 20 [label = "t_18:{groupby_int_1:PRIVATE:INT64}"]
9 -> 17 [label = "t_19:{JOIN_string_0:PRIVATE:STRING}"]
}`, ``, testConf{groupThreshold: 0, batched: false, revealGroupCount: false}},
	{`select ta.join_int_0, tb.plain_int_0 from alice.tbl_1 as ta inner join bob.tbl_1 as tb on ta.join_int_0=tb.join_int_0`, `digraph G {
0 [label="runsql:{in:[],out:[Out:{t_0,},],attr:[sql:select ta.join_int_0 from alice.tbl_1 as ta;,table_refs:[alice.tbl_1],],party:[alice,]}"]
1 [label="runsql:{in:[],out:[Out:{t_1,t_2,},],attr:[sql:select tb.join_int_0,tb.plain_int_0 from bob.tbl_1 as tb;,table_refs:[bob.tbl_1],],party:[bob,]}"]
2 [label="bucket:{in:[In:{t_0,},Key:{t_0,},],out:[Out:{t_3,},],attr:[input_party_codes:[alice bob],],party:[alice,]}"]
3 [label="bucket:{in:[In:{t_1,t_2,},Key:{t_1,},],out:[Out:{t_5,t_4,},],attr:[input_party_codes:[alice bob],],party:[bob,]}"]
4 [label="join:{in:[Left:{t_3,},Right:{t_5,},],out:[LeftJoinIndex:{t_6,},RightJoinIndex:{t_7,},],attr:[input_party_codes:[alice bob],join_type:0,psi_algorithm:0,],party:[alice,bob,]}"]
5 [label="filter_by_index:{in:[Data:{t_3,},RowsIndexFilter:{t_6,},],out:[Out:{t_8,},],attr:[],party:[alice,]}"]
6 [label="filter_by_index:{in:[Data:{t_4,},RowsIndexFilter:{t_7,},],out:[Out:{t_9,},],attr:[],party:[bob,]}"]
7 [label="copy:{in:[In:{t_9,},],out:[Out:{t_11,},],attr:[input_party_codes:bob,output_party_codes:alice,],party:[bob,alice,]}"]
8 [label="publish:{in:[In:{t_8,t_11,},],out:[Out:{t_10,t_12,},],attr:[],party:[alice,]}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
0 -> 2 [label = "t_0:{join_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_1:{join_int_0:PRIVATE:INT64}"]
1 -> 3 [label = "t_2:{plain_int_0:PRIVATE:INT64}"]
2 -> 4 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
2 -> 5 [label = "t_3:{join_int_0:PRIVATE:INT64}"]
3 -> 4 [label = "t_5:{join_int_0:PRIVATE:INT64}"]
3 -> 6 [label = "t_4:{plain_int_0:PRIVATE:INT64}"]
4 -> 5 [label = "t_6:{join_int_0:PRIVATE:INT64}"]
4 -> 6 [label = "t_7:{join_int_0:PRIVATE:INT64}"]
5 -> 8 [label = "t_8:{join_int_0:PRIVATE:INT64}"]
6 -> 7 [label = "t_9:{plain_int_0:PRIVATE:INT64}"]
7 -> 8 [label = "t_11:{plain_int_0:PRIVATE:INT64}"]
}`, `
pipeline 0 {
Batched: false
node: [runsql_0 runsql_1 bucket_2 bucket_3 join_4]
Inputs: []
Outputs: [t_3 t_4 t_6 t_7]
}
pipeline 1 {
Batched: true
node: [filter_by_index_5 filter_by_index_6 copy_7]
Inputs: [t_3 t_4 t_6 t_7]
Outputs: [t_11 t_8]
}
pipeline 2 {
Batched: false
node: [publish_8]
Inputs: [t_11 t_8]
Outputs: []
}
`, testConf{groupThreshold: 0, batched: true, revealGroupCount: false}},
}
